<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>UM2N.model package &#8212; Animate, Movement, Goalie and UM2N 0.1 documentation</title>
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Animate, Movement, Goalie and UM2N 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">UM2N.model package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="um2n-model-package">
<h1>UM2N.model package<a class="headerlink" href="#um2n-model-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-UM2N.model.M2N">
<span id="um2n-model-m2n-module"></span><h2>UM2N.model.M2N module<a class="headerlink" href="#module-UM2N.model.M2N" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.M2N.M2N">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">M2N</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N.html#M2N"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N.M2N" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2N.M2N.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N.html#M2N.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N.M2N.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.M2N_T">
<span id="um2n-model-m2n-t-module"></span><h2>UM2N.model.M2N_T module<a class="headerlink" href="#module-UM2N.model.M2N_T" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.M2N_T.M2N_T">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">M2N_T</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N_T.html#M2N_T"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N_T.M2N_T" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2N_T.M2N_T.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N_T.html#M2N_T.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N_T.M2N_T.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.M2N_atten">
<span id="um2n-model-m2n-atten-module"></span><h2>UM2N.model.M2N_atten module<a class="headerlink" href="#module-UM2N.model.M2N_atten" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.M2N_atten.M2NAtten">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">M2NAtten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N_atten.html#M2NAtten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N_atten.M2NAtten" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2N_atten.M2NAtten.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N_atten.html#M2NAtten.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N_atten.M2NAtten.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.M2N_dynamic_drop">
<span id="um2n-model-m2n-dynamic-drop-module"></span><h2>UM2N.model.M2N_dynamic_drop module<a class="headerlink" href="#module-UM2N.model.M2N_dynamic_drop" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.M2N_dynamic_drop.M2N_dynamic_drop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">M2N_dynamic_drop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N_dynamic_drop.html#M2N_dynamic_drop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N_dynamic_drop.M2N_dynamic_drop" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2N_dynamic_drop.M2N_dynamic_drop.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N_dynamic_drop.html#M2N_dynamic_drop.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N_dynamic_drop.M2N_dynamic_drop.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.M2N_dynamic_no_drop">
<span id="um2n-model-m2n-dynamic-no-drop-module"></span><h2>UM2N.model.M2N_dynamic_no_drop module<a class="headerlink" href="#module-UM2N.model.M2N_dynamic_no_drop" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.M2N_dynamic_no_drop.M2N_dynamic_no_drop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">M2N_dynamic_no_drop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N_dynamic_no_drop.html#M2N_dynamic_no_drop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N_dynamic_no_drop.M2N_dynamic_no_drop" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2N_dynamic_no_drop.M2N_dynamic_no_drop.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2N_dynamic_no_drop.html#M2N_dynamic_no_drop.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2N_dynamic_no_drop.M2N_dynamic_no_drop.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.M2T">
<span id="um2n-model-m2t-module"></span><h2>UM2N.model.M2T module<a class="headerlink" href="#module-UM2N.model.M2T" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.M2T.M2T">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">M2T</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_transformer_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transformer_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transformer_embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transformer_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transformer_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_training_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_key_padding_training_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_attention_training_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_training_mask_ratio_lower_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_training_mask_ratio_upper_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_out_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coord'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_feature_dim_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2T.html#M2T"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2T.M2T" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Refinement Network (MRN) implementing transformer as feature</dt><dd><p>extrator and recurrent graph-based deformations.</p>
</dd>
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2T.M2T.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampled_queries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampled_queries_edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2T.html#M2T.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2T.M2T.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2T.M2T.get_attention_scores">
<span class="sig-name descname"><span class="pre">get_attention_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2T.html#M2T.get_attention_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2T.M2T.get_attention_scores" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2T.M2T.transformer_monitor">
<span class="sig-name descname"><span class="pre">transformer_monitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2T.html#M2T.transformer_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2T.M2T.transformer_monitor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.M2T_deformer">
<span id="um2n-model-m2t-deformer-module"></span><h2>UM2N.model.M2T_deformer module<a class="headerlink" href="#module-UM2N.model.M2T_deformer" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.M2T_deformer.M2TDeformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">M2TDeformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_feature_dim_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coord'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2T_deformer.html#M2TDeformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2T_deformer.M2TDeformer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></p>
<p>Implements a M2TDeformer.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>to_hidden (GATv2Conv): Graph Attention layer.
to_coord (nn.Sequential): Output layer for coordinates.
activation (nn.SELU): Activation function.</p>
</dd>
</dl>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2T_deformer.M2TDeformer.find_boundary">
<span class="sig-name descname"><span class="pre">find_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2T_deformer.html#M2TDeformer.find_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2T_deformer.M2TDeformer.find_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2T_deformer.M2TDeformer.fix_boundary">
<span class="sig-name descname"><span class="pre">fix_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2T_deformer.html#M2TDeformer.fix_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2T_deformer.M2TDeformer.fix_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.M2T_deformer.M2TDeformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/M2T_deformer.html#M2TDeformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.M2T_deformer.M2TDeformer.forward" title="Link to this definition">¶</a></dt>
<dd><p>Runs the forward pass of the module.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.MRN">
<span id="um2n-model-mrn-module"></span><h2>UM2N.model.MRN module<a class="headerlink" href="#module-UM2N.model.MRN" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRN.MRN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MRN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN.html#MRN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN.MRN" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Refinement Network (MRN) implementing global and local feature</dt><dd><p>extraction</p>
</dd>
</dl>
<p>and recurrent graph-based deformations.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN.MRN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN.html#MRN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN.MRN.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN.MRN.move">
<span class="sig-name descname"><span class="pre">move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN.html#MRN.move"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN.MRN.move" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Move the mesh according to the deformation learned, with given number</dt><dd><p>steps.</p>
</dd>
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.
num_step (int): Number of deformation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRN.RecurrentGATConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RecurrentGATConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN.html#RecurrentGATConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN.RecurrentGATConv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></p>
<p>Implements a Recurrent Graph Attention Network (GAT) Convolution layer.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>to_hidden (GATv2Conv): Graph Attention layer.
to_coord (nn.Sequential): Output layer for coordinates.
activation (nn.SELU): Activation function.</p>
</dd>
</dl>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN.RecurrentGATConv.find_boundary">
<span class="sig-name descname"><span class="pre">find_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN.html#RecurrentGATConv.find_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN.RecurrentGATConv.find_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN.RecurrentGATConv.fix_boundary">
<span class="sig-name descname"><span class="pre">fix_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN.html#RecurrentGATConv.fix_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN.RecurrentGATConv.fix_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN.RecurrentGATConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN.html#RecurrentGATConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN.RecurrentGATConv.forward" title="Link to this definition">¶</a></dt>
<dd><p>Runs the forward pass of the module.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.MRN_GTE">
<span id="um2n-model-mrn-gte-module"></span><h2>UM2N.model.MRN_GTE module<a class="headerlink" href="#module-UM2N.model.MRN_GTE" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MRNGlobalTransformerEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_GTE.html#MRNGlobalTransformerEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Refinement Network (MRN) implementing global and local feature</dt><dd><p>extraction and recurrent graph-based deformations.
The global feature extraction is performed by a transformer.</p>
</dd>
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_GTE.html#MRNGlobalTransformerEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder.move">
<span class="sig-name descname"><span class="pre">move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_GTE.html#MRNGlobalTransformerEncoder.move"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder.move" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Move the mesh according to the deformation learned, with given number</dt><dd><p>steps.</p>
</dd>
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.
num_step (int): Number of deformation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.MRN_LTE">
<span id="um2n-model-mrn-lte-module"></span><h2>UM2N.model.MRN_LTE module<a class="headerlink" href="#module-UM2N.model.MRN_LTE" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRN_LTE.MRNLocalTransformerEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MRNLocalTransformerEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_LTE.html#MRNLocalTransformerEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_LTE.MRNLocalTransformerEncoder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Refinement Network (MRN) implementing global and local feature</dt><dd><p>extraction and recurrent graph-based deformations.
The global feature extraction is performed by a transformer.</p>
</dd>
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_LTE.MRNLocalTransformerEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_LTE.html#MRNLocalTransformerEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_LTE.MRNLocalTransformerEncoder.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_LTE.MRNLocalTransformerEncoder.move">
<span class="sig-name descname"><span class="pre">move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_LTE.html#MRNLocalTransformerEncoder.move"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_LTE.MRNLocalTransformerEncoder.move" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Move the mesh according to the deformation learned, with given number</dt><dd><p>steps.</p>
</dd>
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.
num_step (int): Number of deformation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.MRN_atten">
<span id="um2n-model-mrn-atten-module"></span><h2>UM2N.model.MRN_atten module<a class="headerlink" href="#module-UM2N.model.MRN_atten" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRN_atten.MRNAtten">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MRNAtten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_atten.html#MRNAtten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_atten.MRNAtten" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Refinement Network (MRN) with self attention implementing global and local feature</dt><dd><p>extraction</p>
</dd>
</dl>
<p>and recurrent graph-based deformations.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_atten.MRNAtten.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_atten.html#MRNAtten.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_atten.MRNAtten.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_atten.MRNAtten.move">
<span class="sig-name descname"><span class="pre">move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_atten.html#MRNAtten.move"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_atten.MRNAtten.move" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Move the mesh according to the deformation learned, with given number</dt><dd><p>steps.</p>
</dd>
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.
num_step (int): Number of deformation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.MRN_fix">
<span id="um2n-model-mrn-fix-module"></span><h2>UM2N.model.MRN_fix module<a class="headerlink" href="#module-UM2N.model.MRN_fix" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRN_fix.MRN_fix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MRN_fix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_fix.html#MRN_fix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_fix.MRN_fix" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Refinement Network (MRN) implementing global and local feature</dt><dd><p>extraction</p>
</dd>
</dl>
<p>and recurrent graph-based deformations.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_fix.MRN_fix.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_fix.html#MRN_fix.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_fix.MRN_fix.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_fix.MRN_fix.move">
<span class="sig-name descname"><span class="pre">move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_fix.html#MRN_fix.move"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_fix.MRN_fix.move" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Move the mesh according to the deformation learned, with given number</dt><dd><p>steps.</p>
</dd>
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.
num_step (int): Number of deformation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.MRN_phi">
<span id="um2n-model-mrn-phi-module"></span><h2>UM2N.model.MRN_phi module<a class="headerlink" href="#module-UM2N.model.MRN_phi" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRN_phi.MRN_phi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MRN_phi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_phi.html#MRN_phi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_phi.MRN_phi" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Recurrent Network (MRN) implementing global and local feature</dt><dd><p>extraction</p>
</dd>
</dl>
<p>and recurrent graph-based deformations for field phi.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_phi.MRN_phi.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_phi.html#MRN_phi.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_phi.MRN_phi.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRN_phi.RecurrentGATConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RecurrentGATConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_phi.html#RecurrentGATConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_phi.RecurrentGATConv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></p>
<p>Implements a Recurrent Graph Attention Network (GAT) Convolution layer.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>to_hidden (GATv2Conv): Graph Attention layer.
to_coord (nn.Sequential): Output layer for coordinates.
activation (nn.SELU): Activation function.</p>
</dd>
</dl>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRN_phi.RecurrentGATConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRN_phi.html#RecurrentGATConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRN_phi.RecurrentGATConv.forward" title="Link to this definition">¶</a></dt>
<dd><p>Runs the forward pass of the module.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.MRT">
<span id="um2n-model-mrt-module"></span><h2>UM2N.model.MRT module<a class="headerlink" href="#module-UM2N.model.MRT" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRT.MRTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MRTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_transformer_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transformer_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transformer_embed_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transformer_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transformer_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_training_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_key_padding_training_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_attention_training_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_training_mask_ratio_lower_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_training_mask_ratio_upper_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_out_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coord'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRT.html#MRTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRT.MRTransformer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Refinement Network (MRN) implementing transformer as feature</dt><dd><p>extrator and recurrent graph-based deformations.</p>
</dd>
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRT.MRTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampled_queries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampled_queries_edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRT.html#MRTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRT.MRTransformer.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRT.MRTransformer.get_attention_scores">
<span class="sig-name descname"><span class="pre">get_attention_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRT.html#MRTransformer.get_attention_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRT.MRTransformer.get_attention_scores" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRT.MRTransformer.move">
<span class="sig-name descname"><span class="pre">move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampled_queries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampled_queries_edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRT.html#MRTransformer.move"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRT.MRTransformer.move" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Move the mesh according to the deformation learned, with given number</dt><dd><p>steps.</p>
</dd>
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.
num_step (int): Number of deformation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRT.MRTransformer.transformer_monitor">
<span class="sig-name descname"><span class="pre">transformer_monitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRT.html#MRTransformer.transformer_monitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRT.MRTransformer.transformer_monitor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.MRT_PE">
<span id="um2n-model-mrt-pe-module"></span><h2>UM2N.model.MRT_PE module<a class="headerlink" href="#module-UM2N.model.MRT_PE" title="Link to this heading">¶</a></h2>
</section>
<section id="module-UM2N.model.MRT_phi">
<span id="um2n-model-mrt-phi-module"></span><h2>UM2N.model.MRT_phi module<a class="headerlink" href="#module-UM2N.model.MRT_phi" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.MRT_phi.MRT_phi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MRT_phi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lfe_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deform_in_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRT_phi.html#MRT_phi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRT_phi.MRT_phi" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt>Mesh Refinement Network (MRN) implementing global and local feature</dt><dd><p>extraction and recurrent graph-based deformations.
The global feature extraction is performed by a transformer.</p>
</dd>
<dt>Attributes:</dt><dd><p>num_loop (int): Number of loops for the recurrent layer.
gfe_out_c (int): Output channels for global feature extractor.
lfe_out_c (int): Output channels for local feature extractor.
hidden_size (int): Size of the hidden layer.
gfe (GlobalFeatExtractor): Global feature extractor.
lfe (LocalFeatExtractor): Local feature extractor.
lin (nn.Linear): Linear layer for feature transformation.
deformer (RecurrentGATConv): GAT-based deformer block.</p>
</dd>
</dl>
<p>Initialize MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>gfe_in_c (int): Input channels for the global feature extractor.
lfe_in_c (int): Input channels for the local feature extractor.
deform_in_c (int): Input channels for the deformer block.
num_loop (int): Number of loops for the recurrent layer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.MRT_phi.MRT_phi.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/MRT_phi.html#MRT_phi.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.MRT_phi.MRT_phi.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass for MRN.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Data): Input data object containing mesh and feature info.</p>
</dd>
<dt>Returns:</dt><dd><p>coord (Tensor): Deformed coordinates.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.deformer">
<span id="um2n-model-deformer-module"></span><h2>UM2N.model.deformer module<a class="headerlink" href="#module-UM2N.model.deformer" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.deformer.RecurrentGATConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RecurrentGATConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coord'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/deformer.html#RecurrentGATConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.deformer.RecurrentGATConv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></p>
<p>Implements a Recurrent Graph Attention Network (GAT) Convolution layer.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>to_hidden (GATv2Conv): Graph Attention layer.
to_coord (nn.Sequential): Output layer for coordinates.
activation (nn.SELU): Activation function.</p>
</dd>
</dl>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.deformer.RecurrentGATConv.find_boundary">
<span class="sig-name descname"><span class="pre">find_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/deformer.html#RecurrentGATConv.find_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.deformer.RecurrentGATConv.find_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.deformer.RecurrentGATConv.fix_boundary">
<span class="sig-name descname"><span class="pre">fix_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/deformer.html#RecurrentGATConv.fix_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.deformer.RecurrentGATConv.fix_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.deformer.RecurrentGATConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/deformer.html#RecurrentGATConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.deformer.RecurrentGATConv.forward" title="Link to this definition">¶</a></dt>
<dd><p>Runs the forward pass of the module.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.extractor">
<span id="um2n-model-extractor-module"></span><h2>UM2N.model.extractor module<a class="headerlink" href="#module-UM2N.model.extractor" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.extractor.GlobalFeatExtractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GlobalFeatExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/extractor.html#GlobalFeatExtractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.extractor.GlobalFeatExtractor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Custom PyTorch layer for global feature extraction.</p>
<p>The class employs multiple convolutional layers and dropout layers.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>conv1, conv2, conv3, conv4 (torch.nn.Conv2d): Convolutional layers.
dropout (torch.nn.Dropout): Dropout layer.
final_pool (torch.nn.AdaptiveAvgPool2d): Final pooling layer.</p>
</dd>
</dl>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.extractor.GlobalFeatExtractor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/extractor.html#GlobalFeatExtractor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.extractor.GlobalFeatExtractor.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Tensor): Input data.</p>
</dd>
<dt>Returns:</dt><dd><p>Tensor: Extracted global features.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.extractor.LocalFeatExtractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LocalFeatExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/extractor.html#LocalFeatExtractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.extractor.LocalFeatExtractor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></p>
<p>Custom PyTorch geometric layer that performs feature extraction
on local graph structure.</p>
<p>The class extends the torch_geometric.nn.MessagePassing class
and employs additive aggregation as the message-passing scheme.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>lin_1 (torch.nn.Linear): First linear layer.
lin_2 (torch.nn.Linear): Second linear layer.
lin_3 (torch.nn.Linear): Third linear layer.
activate (torch.nn.SELU): Activation function.</p>
</dd>
</dl>
<p>Initialize the layer.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>num_feat (int): Number of input features per node.
out (int): Number of output features per node.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.extractor.LocalFeatExtractor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/extractor.html#LocalFeatExtractor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.extractor.LocalFeatExtractor.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input (Tensor): Node features.
edge_index (Tensor): Edge indices.</p>
</dd>
<dt>Returns:</dt><dd><p>Tensor: Updated node features.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.extractor.LocalFeatExtractor.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/extractor.html#LocalFeatExtractor.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.extractor.LocalFeatExtractor.message" title="Link to this definition">¶</a></dt>
<dd><p>Constructs messages from node <span class="math notranslate nohighlight">\(j\)</span> to node <span class="math notranslate nohighlight">\(i\)</span>
in analogy to <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span> for each edge in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code>.
This function can take any argument as input which was initially
passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code>.
Furthermore, tensors passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code> can be mapped to the
respective nodes <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> by appending <code class="xref py py-obj docutils literal notranslate"><span class="pre">_i</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_j</span></code> to the variable name, <em>.e.g.</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_j</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.gatdeformer">
<span id="um2n-model-gatdeformer-module"></span><h2>UM2N.model.gatdeformer module<a class="headerlink" href="#module-UM2N.model.gatdeformer" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.gatdeformer.DeformGAT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DeformGAT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_slope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/gatdeformer.html#DeformGAT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.gatdeformer.DeformGAT" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.gatdeformer.DeformGAT.find_boundary">
<span class="sig-name descname"><span class="pre">find_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/gatdeformer.html#DeformGAT.find_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.gatdeformer.DeformGAT.find_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.gatdeformer.DeformGAT.fix_boundary">
<span class="sig-name descname"><span class="pre">fix_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/gatdeformer.html#DeformGAT.fix_boundary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.gatdeformer.DeformGAT.fix_boundary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.gatdeformer.DeformGAT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">SparseTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/gatdeformer.html#DeformGAT.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.gatdeformer.DeformGAT.forward" title="Link to this definition">¶</a></dt>
<dd><p>Runs the forward pass of the module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.gatdeformer.DeformGAT.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/UM2N/model/gatdeformer.html#DeformGAT.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.gatdeformer.DeformGAT.message" title="Link to this definition">¶</a></dt>
<dd><p>Constructs messages from node <span class="math notranslate nohighlight">\(j\)</span> to node <span class="math notranslate nohighlight">\(i\)</span>
in analogy to <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span> for each edge in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code>.
This function can take any argument as input which was initially
passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code>.
Furthermore, tensors passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code> can be mapped to the
respective nodes <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> by appending <code class="xref py py-obj docutils literal notranslate"><span class="pre">_i</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_j</span></code> to the variable name, <em>.e.g.</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_j</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.gatdeformer.DeformGAT.reset_parameters">
<span class="sig-name descname"><span class="pre">reset_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/gatdeformer.html#DeformGAT.reset_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.gatdeformer.DeformGAT.reset_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Resets all learnable parameters of the module.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model.train_util">
<span id="um2n-model-train-util-module"></span><h2>UM2N.model.train_util module<a class="headerlink" href="#module-UM2N.model.train_util" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.train_util.TangleCounter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TangleCounter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#TangleCounter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.TangleCounter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassing</span></code></p>
<p>A PyTorch Geometric Message Passing class for counting tangles in the mesh.
This class is deprecated, do not use this option unless you know what you
are doing.</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.train_util.TangleCounter.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#TangleCounter.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.TangleCounter.forward" title="Link to this definition">¶</a></dt>
<dd><p>Runs the forward pass of the module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.train_util.TangleCounter.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_new_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_new_j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#TangleCounter.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.TangleCounter.message" title="Link to this definition">¶</a></dt>
<dd><p>Constructs messages from node <span class="math notranslate nohighlight">\(j\)</span> to node <span class="math notranslate nohighlight">\(i\)</span>
in analogy to <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span> for each edge in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code>.
This function can take any argument as input which was initially
passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code>.
Furthermore, tensors passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code> can be mapped to the
respective nodes <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> by appending <code class="xref py py-obj docutils literal notranslate"><span class="pre">_i</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_j</span></code> to the variable name, <em>.e.g.</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_j</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.count_dataset_tangle">
<span class="sig-name descname"><span class="pre">count_dataset_tangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inversion'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#count_dataset_tangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.count_dataset_tangle" title="Link to this definition">¶</a></dt>
<dd><p>Computes the average number of tangles in a dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset (Dataset): The PyTorch Geometric dataset.
model (torch.nn.Module): The PyTorch model.
device (torch.device): The device to run the computation.</p>
</dd>
<dt>Returns:</dt><dd><p>float: The average number of tangles in the dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.count_dataset_tangle_repeat_sampling">
<span class="sig-name descname"><span class="pre">count_dataset_tangle_repeat_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#count_dataset_tangle_repeat_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.count_dataset_tangle_repeat_sampling" title="Link to this definition">¶</a></dt>
<dd><p>Computes the average number of tangles in a dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset (Dataset): The PyTorch Geometric dataset.
model (torch.nn.Module): The PyTorch model.
device (torch.device): The device to run the computation.</p>
</dd>
<dt>Returns:</dt><dd><p>float: The average number of tangles in the dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_jacob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_diff_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_deform_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_chamfer_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates a model using the given data loader and loss function.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>loader (DataLoader): DataLoader object for the evaluation data.
model (torch.nn.Module): The PyTorch model to evaluate.
device (torch.device): The device to run the computation on.
loss_func (callable): Loss function (e.g., MSE, Cross-Entropy).
use_jacob (bool): Whether or not to use Jacobian loss. Defaults to.</p>
</dd>
<dt>Returns:</dt><dd><p>float: The average evaluation loss across all batches.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.evaluate_repeat">
<span class="sig-name descname"><span class="pre">evaluate_repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#evaluate_repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.evaluate_repeat" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates model performance when sampling for different number of times.
this function will evaluate:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>the average loss</p></li>
<li><p>the average number of tangles</p></li>
</ol>
</div></blockquote>
<dl class="simple">
<dt>Args:</dt><dd><p>dataset (MeshDataset): The target dataset to evaluate.
model (torch.nn.Module): The PyTorch model to evaluate.
device (torch.device): The device to run the computation on.
loss_func (callable): Loss function (e.g., MSE, Cross-Entropy).</p>
</dd>
<dt>Returns:</dt><dd><p>float: The average evaluation loss across all batches.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.evaluate_repeat_sampling">
<span class="sig-name descname"><span class="pre">evaluate_repeat_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_diff_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#evaluate_repeat_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.evaluate_repeat_sampling" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates a model using the given data loader and loss function.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>loader (DataLoader): DataLoader object for the evaluation data.
model (torch.nn.Module): The PyTorch model to evaluate.
device (torch.device): The device to run the computation on.
loss_func (callable): Loss function (e.g., MSE, Cross-Entropy).
use_jacob (bool): Whether or not to use Jacobian loss. Defaults to.</p>
</dd>
<dt>Returns:</dt><dd><p>float: The average evaluation loss across all batches.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.evaluate_unsupervised">
<span class="sig-name descname"><span class="pre">evaluate_unsupervised</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_jacob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_diff_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_convex_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_add_random_query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_difference_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_deform_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_eq_residual_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_chamfer_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#evaluate_unsupervised"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.evaluate_unsupervised" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates a model using the given data loader and loss function.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>loader (DataLoader): DataLoader object for the evaluation data.
model (torch.nn.Module): The PyTorch model to evaluate.
device (torch.device): The device to run the computation on.
loss_func (callable): Loss function (e.g., MSE, Cross-Entropy).
use_jacob (bool): Whether or not to use Jacobian loss. Defaults to.</p>
</dd>
<dt>Returns:</dt><dd><p>float: The average evaluation loss across all batches.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.get_area_loss">
<span class="sig-name descname"><span class="pre">get_area_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tar_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#get_area_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.get_area_loss" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.get_face_area">
<span class="sig-name descname"><span class="pre">get_face_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#get_face_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.get_face_area" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Calculates the area of a face. using formula:</dt><dd><p>area = 0.5 * (x1(y2 - y3) + x2(y3 - y1) + x3(y1 - y2))</p>
</dd>
<dt>Args:</dt><dd><p>coord (torch.Tensor): The coordinates.
face (torch.Tensor): The face tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.get_inversion_diff_loss">
<span class="sig-name descname"><span class="pre">get_inversion_diff_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tar_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#get_inversion_diff_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.get_inversion_diff_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the inversion difference loss for a batch of meshes.
That is the difference between the output area and the input area,
in terms of the invereted elements.
Args:</p>
<blockquote>
<div><p>out_coord (torch.Tensor): The output coordinates.
tar_coord (torch.Tensor): The target coordinates.
face (torch.Tensor): The face tensor.
batch_size (int): The batch size.
alpha (float): The loss weight.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.get_inversion_loss">
<span class="sig-name descname"><span class="pre">get_inversion_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#get_inversion_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.get_inversion_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the inversion loss for a batch of meshes.
Args:</p>
<blockquote>
<div><p>out_coord (torch.Tensor): The output coordinates.
in_coord (torch.Tensor): The input coordinates.
face (torch.Tensor): The face tensor.
batch_size (int): The batch size.
alpha (float): The loss weight.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.get_inversion_node_loss">
<span class="sig-name descname"><span class="pre">get_inversion_node_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tar_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#get_inversion_node_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.get_inversion_node_loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the loss between the ouput node and input node, for the inverted
elements. This will penalise the node which are involved in the tangled
elements.
Args:</p>
<blockquote>
<div><p>out_coord (torch.Tensor): The output coordinates.
tar_coord (torch.Tensor): The target coordinates.
face (torch.Tensor): The face tensor.
batch_size (int): The batch size.
alpha (float): The loss weight.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.get_jacob_det">
<span class="sig-name descname"><span class="pre">get_jacob_det</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#get_jacob_det"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.get_jacob_det" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.get_sample_tangle">
<span class="sig-name descname"><span class="pre">get_sample_tangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#get_sample_tangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.get_sample_tangle" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of tangled elements in a single sample.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.load_model" title="Link to this definition">¶</a></dt>
<dd><p>Loads pre-trained weights into a PyTorch model from a given file path.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (torch.nn.Module): The PyTorch model.
weight_path (str): File path to the pre-trained model weights.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.nn.Module: The model with loaded weights.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_jacob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_diff_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_deform_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_chamfer_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.train" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Trains a PyTorch model using the given data loader, optimizer,</dt><dd><p>and loss function.</p>
</dd>
<dt>Args:</dt><dd><p>loader (DataLoader): DataLoader object for the training data.
model (torch.nn.Module): The PyTorch model to train.
optimizer (Optimizer): The optimizer (e.g., Adam, SGD).
device (torch.device): The device to run the computation on.
loss_func (callable): Loss function (e.g., MSE, Cross-Entropy).
use_jacob (bool): Whether or not to use Jacobian loss.</p>
</dd>
<dt>Returns:</dt><dd><p>float: The average training loss across all batches.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="UM2N.model.train_util.train_unsupervised">
<span class="sig-name descname"><span class="pre">train_unsupervised</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_jacob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_inversion_diff_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_convex_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_add_random_query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_difference_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_area_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_deform_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_chamfer_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_eq_residual_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/train_util.html#train_unsupervised"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.train_util.train_unsupervised" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Trains a PyTorch model using the given data loader, optimizer,</dt><dd><p>and loss function.</p>
</dd>
<dt>Args:</dt><dd><p>loader (DataLoader): DataLoader object for the training data.
model (torch.nn.Module): The PyTorch model to train.
optimizer (Optimizer): The optimizer (e.g., Adam, SGD).
device (torch.device): The device to run the computation on.
loss_func (callable): Loss function (e.g., MSE, Cross-Entropy).
use_jacob (bool): Whether or not to use Jacobian loss.</p>
</dd>
<dt>Returns:</dt><dd><p>float: The average training loss across all batches.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-UM2N.model.transformer_model">
<span id="um2n-model-transformer-model-module"></span><h2>UM2N.model.transformer_model module<a class="headerlink" href="#module-UM2N.model.transformer_model" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.transformer_model.MLP_model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MLP_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_hiddens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[128,</span> <span class="pre">128]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LeakyReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LeakyReLU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/transformer_model.html#MLP_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.transformer_model.MLP_model" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Note that list_hiddens should be a list of hidden channels per MLP layers
e.g. [64 128 64]</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input_channels (_type_): _description_
list_hiddens (_type_): _description_
output_channels (_type_): _description_
hidden_act (str, optional): _description_. Defaults to “LeakyReLU”.
output_act (str, optional): _description_. Defaults to “LeakyReLU”.
dropout_prob (float, optional): _description_. Defaults to 0.0.
input_norm (float, optional): one of [“BatchNorm1d”, “LayerNorm”]</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.transformer_model.MLP_model.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/transformer_model.html#MLP_model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.transformer_model.MLP_model.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.transformer_model.TransformerBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TransformerBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">0.1,</span> <span class="pre">0.1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GELU'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/transformer_model.html#TransformerBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.transformer_model.TransformerBlock" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.transformer_model.TransformerBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/transformer_model.html#TransformerBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.transformer_model.TransformerBlock.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="UM2N.model.transformer_model.TransformerModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TransformerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/transformer_model.html#TransformerModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.transformer_model.TransformerModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.transformer_model.TransformerModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/transformer_model.html#TransformerModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.transformer_model.TransformerModel.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="UM2N.model.transformer_model.TransformerModel.get_attention_scores">
<span class="sig-name descname"><span class="pre">get_attention_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/UM2N/model/transformer_model.html#TransformerModel.get_attention_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#UM2N.model.transformer_model.TransformerModel.get_attention_scores" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-UM2N.model">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-UM2N.model" title="Link to this heading">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">UM2N.model package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-UM2N.model.M2N">UM2N.model.M2N module</a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N.M2N"><code class="docutils literal notranslate"><span class="pre">M2N</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N.M2N.forward"><code class="docutils literal notranslate"><span class="pre">M2N.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.M2N_T">UM2N.model.M2N_T module</a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N_T.M2N_T"><code class="docutils literal notranslate"><span class="pre">M2N_T</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N_T.M2N_T.forward"><code class="docutils literal notranslate"><span class="pre">M2N_T.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.M2N_atten">UM2N.model.M2N_atten module</a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N_atten.M2NAtten"><code class="docutils literal notranslate"><span class="pre">M2NAtten</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N_atten.M2NAtten.forward"><code class="docutils literal notranslate"><span class="pre">M2NAtten.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.M2N_dynamic_drop">UM2N.model.M2N_dynamic_drop module</a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N_dynamic_drop.M2N_dynamic_drop"><code class="docutils literal notranslate"><span class="pre">M2N_dynamic_drop</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N_dynamic_drop.M2N_dynamic_drop.forward"><code class="docutils literal notranslate"><span class="pre">M2N_dynamic_drop.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.M2N_dynamic_no_drop">UM2N.model.M2N_dynamic_no_drop module</a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N_dynamic_no_drop.M2N_dynamic_no_drop"><code class="docutils literal notranslate"><span class="pre">M2N_dynamic_no_drop</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.M2N_dynamic_no_drop.M2N_dynamic_no_drop.forward"><code class="docutils literal notranslate"><span class="pre">M2N_dynamic_no_drop.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.M2T">UM2N.model.M2T module</a><ul>
<li><a class="reference internal" href="#UM2N.model.M2T.M2T"><code class="docutils literal notranslate"><span class="pre">M2T</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.M2T.M2T.forward"><code class="docutils literal notranslate"><span class="pre">M2T.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.M2T.M2T.get_attention_scores"><code class="docutils literal notranslate"><span class="pre">M2T.get_attention_scores()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.M2T.M2T.transformer_monitor"><code class="docutils literal notranslate"><span class="pre">M2T.transformer_monitor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.M2T_deformer">UM2N.model.M2T_deformer module</a><ul>
<li><a class="reference internal" href="#UM2N.model.M2T_deformer.M2TDeformer"><code class="docutils literal notranslate"><span class="pre">M2TDeformer</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.M2T_deformer.M2TDeformer.find_boundary"><code class="docutils literal notranslate"><span class="pre">M2TDeformer.find_boundary()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.M2T_deformer.M2TDeformer.fix_boundary"><code class="docutils literal notranslate"><span class="pre">M2TDeformer.fix_boundary()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.M2T_deformer.M2TDeformer.forward"><code class="docutils literal notranslate"><span class="pre">M2TDeformer.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.MRN">UM2N.model.MRN module</a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN.MRN"><code class="docutils literal notranslate"><span class="pre">MRN</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN.MRN.forward"><code class="docutils literal notranslate"><span class="pre">MRN.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRN.MRN.move"><code class="docutils literal notranslate"><span class="pre">MRN.move()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#UM2N.model.MRN.RecurrentGATConv"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN.RecurrentGATConv.find_boundary"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv.find_boundary()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRN.RecurrentGATConv.fix_boundary"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv.fix_boundary()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRN.RecurrentGATConv.forward"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.MRN_GTE">UM2N.model.MRN_GTE module</a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder"><code class="docutils literal notranslate"><span class="pre">MRNGlobalTransformerEncoder</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder.forward"><code class="docutils literal notranslate"><span class="pre">MRNGlobalTransformerEncoder.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRN_GTE.MRNGlobalTransformerEncoder.move"><code class="docutils literal notranslate"><span class="pre">MRNGlobalTransformerEncoder.move()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.MRN_LTE">UM2N.model.MRN_LTE module</a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_LTE.MRNLocalTransformerEncoder"><code class="docutils literal notranslate"><span class="pre">MRNLocalTransformerEncoder</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_LTE.MRNLocalTransformerEncoder.forward"><code class="docutils literal notranslate"><span class="pre">MRNLocalTransformerEncoder.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRN_LTE.MRNLocalTransformerEncoder.move"><code class="docutils literal notranslate"><span class="pre">MRNLocalTransformerEncoder.move()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.MRN_atten">UM2N.model.MRN_atten module</a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_atten.MRNAtten"><code class="docutils literal notranslate"><span class="pre">MRNAtten</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_atten.MRNAtten.forward"><code class="docutils literal notranslate"><span class="pre">MRNAtten.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRN_atten.MRNAtten.move"><code class="docutils literal notranslate"><span class="pre">MRNAtten.move()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.MRN_fix">UM2N.model.MRN_fix module</a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_fix.MRN_fix"><code class="docutils literal notranslate"><span class="pre">MRN_fix</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_fix.MRN_fix.forward"><code class="docutils literal notranslate"><span class="pre">MRN_fix.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRN_fix.MRN_fix.move"><code class="docutils literal notranslate"><span class="pre">MRN_fix.move()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.MRN_phi">UM2N.model.MRN_phi module</a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_phi.MRN_phi"><code class="docutils literal notranslate"><span class="pre">MRN_phi</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_phi.MRN_phi.forward"><code class="docutils literal notranslate"><span class="pre">MRN_phi.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#UM2N.model.MRN_phi.RecurrentGATConv"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRN_phi.RecurrentGATConv.forward"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.MRT">UM2N.model.MRT module</a><ul>
<li><a class="reference internal" href="#UM2N.model.MRT.MRTransformer"><code class="docutils literal notranslate"><span class="pre">MRTransformer</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRT.MRTransformer.forward"><code class="docutils literal notranslate"><span class="pre">MRTransformer.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRT.MRTransformer.get_attention_scores"><code class="docutils literal notranslate"><span class="pre">MRTransformer.get_attention_scores()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRT.MRTransformer.move"><code class="docutils literal notranslate"><span class="pre">MRTransformer.move()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.MRT.MRTransformer.transformer_monitor"><code class="docutils literal notranslate"><span class="pre">MRTransformer.transformer_monitor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.MRT_PE">UM2N.model.MRT_PE module</a></li>
<li><a class="reference internal" href="#module-UM2N.model.MRT_phi">UM2N.model.MRT_phi module</a><ul>
<li><a class="reference internal" href="#UM2N.model.MRT_phi.MRT_phi"><code class="docutils literal notranslate"><span class="pre">MRT_phi</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.MRT_phi.MRT_phi.forward"><code class="docutils literal notranslate"><span class="pre">MRT_phi.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.deformer">UM2N.model.deformer module</a><ul>
<li><a class="reference internal" href="#UM2N.model.deformer.RecurrentGATConv"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.deformer.RecurrentGATConv.find_boundary"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv.find_boundary()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.deformer.RecurrentGATConv.fix_boundary"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv.fix_boundary()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.deformer.RecurrentGATConv.forward"><code class="docutils literal notranslate"><span class="pre">RecurrentGATConv.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.extractor">UM2N.model.extractor module</a><ul>
<li><a class="reference internal" href="#UM2N.model.extractor.GlobalFeatExtractor"><code class="docutils literal notranslate"><span class="pre">GlobalFeatExtractor</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.extractor.GlobalFeatExtractor.forward"><code class="docutils literal notranslate"><span class="pre">GlobalFeatExtractor.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#UM2N.model.extractor.LocalFeatExtractor"><code class="docutils literal notranslate"><span class="pre">LocalFeatExtractor</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.extractor.LocalFeatExtractor.forward"><code class="docutils literal notranslate"><span class="pre">LocalFeatExtractor.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.extractor.LocalFeatExtractor.message"><code class="docutils literal notranslate"><span class="pre">LocalFeatExtractor.message()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.gatdeformer">UM2N.model.gatdeformer module</a><ul>
<li><a class="reference internal" href="#UM2N.model.gatdeformer.DeformGAT"><code class="docutils literal notranslate"><span class="pre">DeformGAT</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.gatdeformer.DeformGAT.find_boundary"><code class="docutils literal notranslate"><span class="pre">DeformGAT.find_boundary()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.gatdeformer.DeformGAT.fix_boundary"><code class="docutils literal notranslate"><span class="pre">DeformGAT.fix_boundary()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.gatdeformer.DeformGAT.forward"><code class="docutils literal notranslate"><span class="pre">DeformGAT.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.gatdeformer.DeformGAT.message"><code class="docutils literal notranslate"><span class="pre">DeformGAT.message()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.gatdeformer.DeformGAT.reset_parameters"><code class="docutils literal notranslate"><span class="pre">DeformGAT.reset_parameters()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.train_util">UM2N.model.train_util module</a><ul>
<li><a class="reference internal" href="#UM2N.model.train_util.TangleCounter"><code class="docutils literal notranslate"><span class="pre">TangleCounter</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.train_util.TangleCounter.forward"><code class="docutils literal notranslate"><span class="pre">TangleCounter.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.TangleCounter.message"><code class="docutils literal notranslate"><span class="pre">TangleCounter.message()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#UM2N.model.train_util.count_dataset_tangle"><code class="docutils literal notranslate"><span class="pre">count_dataset_tangle()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.count_dataset_tangle_repeat_sampling"><code class="docutils literal notranslate"><span class="pre">count_dataset_tangle_repeat_sampling()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.evaluate"><code class="docutils literal notranslate"><span class="pre">evaluate()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.evaluate_repeat"><code class="docutils literal notranslate"><span class="pre">evaluate_repeat()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.evaluate_repeat_sampling"><code class="docutils literal notranslate"><span class="pre">evaluate_repeat_sampling()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.evaluate_unsupervised"><code class="docutils literal notranslate"><span class="pre">evaluate_unsupervised()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.get_area_loss"><code class="docutils literal notranslate"><span class="pre">get_area_loss()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.get_face_area"><code class="docutils literal notranslate"><span class="pre">get_face_area()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.get_inversion_diff_loss"><code class="docutils literal notranslate"><span class="pre">get_inversion_diff_loss()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.get_inversion_loss"><code class="docutils literal notranslate"><span class="pre">get_inversion_loss()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.get_inversion_node_loss"><code class="docutils literal notranslate"><span class="pre">get_inversion_node_loss()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.get_jacob_det"><code class="docutils literal notranslate"><span class="pre">get_jacob_det()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.get_sample_tangle"><code class="docutils literal notranslate"><span class="pre">get_sample_tangle()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.load_model"><code class="docutils literal notranslate"><span class="pre">load_model()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.train"><code class="docutils literal notranslate"><span class="pre">train()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.train_util.train_unsupervised"><code class="docutils literal notranslate"><span class="pre">train_unsupervised()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model.transformer_model">UM2N.model.transformer_model module</a><ul>
<li><a class="reference internal" href="#UM2N.model.transformer_model.MLP_model"><code class="docutils literal notranslate"><span class="pre">MLP_model</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.transformer_model.MLP_model.forward"><code class="docutils literal notranslate"><span class="pre">MLP_model.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#UM2N.model.transformer_model.TransformerBlock"><code class="docutils literal notranslate"><span class="pre">TransformerBlock</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.transformer_model.TransformerBlock.forward"><code class="docutils literal notranslate"><span class="pre">TransformerBlock.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#UM2N.model.transformer_model.TransformerModel"><code class="docutils literal notranslate"><span class="pre">TransformerModel</span></code></a><ul>
<li><a class="reference internal" href="#UM2N.model.transformer_model.TransformerModel.forward"><code class="docutils literal notranslate"><span class="pre">TransformerModel.forward()</span></code></a></li>
<li><a class="reference internal" href="#UM2N.model.transformer_model.TransformerModel.get_attention_scores"><code class="docutils literal notranslate"><span class="pre">TransformerModel.get_attention_scores()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-UM2N.model">Module contents</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/UM2N.model.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Animate, Movement, Goalie and UM2N 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">UM2N.model package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2021-2024, Joseph G. Wallwork et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    </div>
  </body>
</html>