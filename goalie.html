<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>goalie package &#8212; Animate and Goalie 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css?v=601dbdee" />
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Defining a simple metric field and adapting the mesh to it" href="demos/simple_metric.py.html" />
    <link rel="prev" title="animate package" href="animate.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="demos/simple_metric.py.html" title="Defining a simple metric field and adapting the mesh to it"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="animate.html" title="animate package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Animate and Goalie 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">goalie package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="goalie-package">
<h1>goalie package<a class="headerlink" href="#goalie-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-goalie.adjoint">
<span id="goalie-adjoint-module"></span><h2>goalie.adjoint module<a class="headerlink" href="#module-goalie.adjoint" title="Link to this heading">¶</a></h2>
<p>Drivers for solving adjoint problems on sequences of meshes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AdjointMeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><span class="pre">TimePartition</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_meshes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a></p>
<p>An extension of <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a> to account for solving adjoint problems on a
sequence of meshes.</p>
<p>For time-dependent quantities of interest, the solver should access and modify
<code class="xref py py-attr docutils literal notranslate"><span class="pre">J</span></code>, which holds the QoI value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>get_qoi</strong> – a function, with two arguments, a <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq" title="goalie.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a>,
which returns a function of either one or two variables, corresponding to
either an end time or time integrated quantity of interest, respectively,
as well as an index for the <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.check_qoi_convergence">
<span class="sig-name descname"><span class="pre">check_qoi_convergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.check_qoi_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.check_qoi_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence of the fixed point iteration due to the relative
difference in QoI value being smaller than the specified tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if QoI convergence is detected, else <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.get_checkpoints">
<span class="sig-name descname"><span class="pre">get_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_final_subinterval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.get_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.get_checkpoints" title="Link to this definition">¶</a></dt>
<dd><p>Solve forward on the sequence of meshes, extracting checkpoints corresponding
to the starting fields on each subinterval.</p>
<p>The QoI is also evaluated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> – additional keyword arguments which will be passed to the
solver</p></li>
<li><p><strong>run_final_subinterval</strong> – toggle whether to solve the PDE on the final
subinterval</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.get_qoi">
<span class="sig-name descname"><span class="pre">get_qoi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.get_qoi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.get_qoi" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.get_solve_blocks">
<span class="sig-name descname"><span class="pre">get_solve_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subinterval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_adj_sol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.get_solve_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.get_solve_blocks" title="Link to this definition">¶</a></dt>
<dd><p>Get all blocks of the tape corresponding to solve steps for prognostic solution
field on a given subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> – name of the prognostic solution field</p></li>
<li><p><strong>subinterval</strong> – subinterval index</p></li>
<li><p><strong>has_adj_sol</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, only blocks with <code class="docutils literal notranslate"><span class="pre">adj_sol</span></code> attributes will be
considered</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.initial_condition">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_condition</span></span><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.initial_condition" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.solve_adjoint">
<span class="sig-name descname"><span class="pre">solve_adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_solver_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_adj_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_checkpoint_qoi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.solve_adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.solve_adjoint" title="Link to this definition">¶</a></dt>
<dd><p>Solve an adjoint problem on a sequence of subintervals.</p>
<p>As well as the quantity of interest value, a dictionary
of solution fields is computed, the contents of which
give values at all exported timesteps, indexed first by
the field label and then by type. The contents of these
nested dictionaries are lists which are indexed first by
subinterval and then by export. For a given exported
timestep, the solution types are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'forward'</span></code>: the forward solution after taking the</dt><dd><p>timestep;</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>: the forward solution before taking</dt><dd><p>the timestep</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'adjoint'</span></code>: the adjoint solution after taking the</dt><dd><p>timestep;</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'adjoint_next'</span></code>: the adjoint solution before taking</dt><dd><p>the timestep (backwards).</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> – a dictionary providing parameters
to the solver. Any keyword arguments for the QoI
should be included as a subdict with label ‘qoi_kwargs’</p></li>
<li><p><strong>adj_solver_kwargs</strong> – a dictionary providing parameters
to the adjoint solver.</p></li>
<li><p><strong>get_adj_values</strong> – additionally output adjoint
actions at exported timesteps</p></li>
<li><p><strong>test_checkpoint_qoi</strong> – solve over the final
subinterval when checkpointing so that the QoI
value can be checked across runs</p></li>
</ul>
</dd>
<dt class="field-even">Return solution<span class="colon">:</span></dt>
<dd class="field-even"><p>an <a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> containing
solution fields and their lagged versions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.th">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">th</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.th"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.th" title="Link to this definition">¶</a></dt>
<dd><p>Convert from cardinal to ordinal.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.adjoint.annotate_qoi">
<span class="sig-name descname"><span class="pre">annotate_qoi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">get_qoi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></span><a class="reference internal" href="_modules/goalie/adjoint.html#annotate_qoi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.annotate_qoi" title="Link to this definition">¶</a></dt>
<dd><p>Decorator that ensures QoIs are annotated properly.</p>
<p>Should be applied to the <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_qoi" title="goalie.adjoint.AdjointMeshSeq.get_qoi"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_qoi()</span></code></a> method.</p>
</dd></dl>

</section>
<section id="module-goalie.error_estimation">
<span id="goalie-error-estimation-module"></span><h2>goalie.error_estimation module<a class="headerlink" href="#module-goalie.error_estimation" title="Link to this heading">¶</a></h2>
<p>Tools to automate goal-oriented error estimation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.error_estimation.get_dwr_indicator">
<span class="sig-name descname"><span class="pre">get_dwr_indicator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjoint_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><span class="pre">Function</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.WithGeometry" title="(in Firedrake v0.12)"><span class="pre">WithGeometry</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><span class="pre">Function</span></a></span></span><a class="reference internal" href="_modules/goalie/error_estimation.html#get_dwr_indicator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.error_estimation.get_dwr_indicator" title="Link to this definition">¶</a></dt>
<dd><p>Given a 1-form and an approximation of the error in the adjoint solution, compute a
dual weighted residual (DWR) error indicator.</p>
<p>Note that each term of a 1-form contains only one
<code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.ufl_expr.TestFunction</span></code>. The 1-form most commonly corresponds to the
variational form of a PDE. If the PDE is linear, it should be written as in the
nonlinear case (i.e., with the solution field in place of any
<code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.ufl_expr.TrialFunction</span></code>s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>F</strong> – the form</p></li>
<li><p><strong>adjoint_error</strong> – the approximation to the adjoint error, either as a single
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>, or in a dictionary</p></li>
<li><p><strong>test_space</strong> – the
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.WithGeometry" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.WithGeometry</span></code></a> that the test function lives
in, or an appropriate dictionary</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.go_mesh_seq">
<span id="goalie-go-mesh-seq-module"></span><h2>goalie.go_mesh_seq module<a class="headerlink" href="#module-goalie.go_mesh_seq" title="Link to this heading">¶</a></h2>
<p>Drivers for goal-oriented error estimation on sequences of meshes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GoalOrientedMeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq" title="goalie.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a></p>
<p>An extension of <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq" title="goalie.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a> to account for goal-oriented problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>get_qoi</strong> – a function, with two arguments, a <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq" title="goalie.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a>,
which returns a function of either one or two variables, corresponding to
either an end time or time integrated quantity of interest, respectively,
as well as an index for the <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.check_estimator_convergence">
<span class="sig-name descname"><span class="pre">check_estimator_convergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.check_estimator_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.check_estimator_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence of the fixed point iteration due to the relative
difference in error estimator value being smaller than the specified tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if estimator convergence is detected, else <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.fixed_point_iteration">
<span class="sig-name descname"><span class="pre">fixed_point_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adaptor:</span> <span class="pre">~collections.abc.Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enrichment_kwargs:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_kwargs:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicator_fn:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">=</span> <span class="pre">&lt;cyfunction</span> <span class="pre">get_dwr_indicator&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.fixed_point_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.fixed_point_iteration" title="Link to this definition">¶</a></dt>
<dd><p>Apply goal-oriented mesh adaptation using a fixed point iteration loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adaptor</strong> – function for adapting the mesh sequence. Its arguments are the
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a> instance, the dictionary of solution
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>s and the list of error indicators.
It should return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the convergence criteria checks are to be
skipped for this iteration. Otherwise, it should return <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>update_params</strong> – function for updating <code class="xref py py-attr docutils literal notranslate"><span class="pre">params</span></code>
at each iteration. Its arguments are the parameter class and the fixed point
iteration number</p></li>
<li><p><strong>enrichment_kwargs</strong> – keyword arguments to pass to the global enrichment
method</p></li>
<li><p><strong>adj_kwargs</strong> – keyword arguments to pass to the adjoint solver</p></li>
<li><p><strong>indicator_fn</strong> – function for error indication, which takes the form, adjoint
error and enriched space(s) as arguments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.get_enriched_mesh_seq">
<span class="sig-name descname"><span class="pre">get_enriched_mesh_seq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enrichment_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_enrichments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq" title="goalie.adjoint.AdjointMeshSeq"><span class="pre">AdjointMeshSeq</span></a></span></span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.get_enriched_mesh_seq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.get_enriched_mesh_seq" title="Link to this definition">¶</a></dt>
<dd><p>Construct a sequence of globally enriched spaces.</p>
<p>Currently, global enrichment may be achieved using one of:
* h-refinement (<code class="docutils literal notranslate"><span class="pre">enrichment_method</span> <span class="pre">=</span> <span class="pre">'h'</span></code>);
* p-refinement (<code class="docutils literal notranslate"><span class="pre">enrichment_method</span> <span class="pre">=</span> <span class="pre">'p'</span></code>).</p>
<p>The number of refinements may be controlled by the keyword argument
<code class="docutils literal notranslate"><span class="pre">num_enrichments</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.indicate_errors">
<span class="sig-name descname"><span class="pre">indicate_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enrichment_kwargs:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_kwargs:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicator_fn:</span> <span class="pre">~collections.abc.Callable</span> <span class="pre">=</span> <span class="pre">&lt;cyfunction</span> <span class="pre">get_dwr_indicator&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><span class="pre">AttrDict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.indicate_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.indicate_errors" title="Link to this definition">¶</a></dt>
<dd><p>Compute goal-oriented error indicators for each subinterval based on solving the
adjoint problem in a globally enriched space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enrichment_kwargs</strong> – keyword arguments to pass to the global enrichment
method</p></li>
<li><p><strong>adj_kwargs</strong> – keyword arguments to pass to the adjoint solver</p></li>
<li><p><strong>indicator_fn</strong> – function for error indication, which takes the form,
adjoint error and enriched space(s) as arguments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.indicators2estimator">
<span class="sig-name descname"><span class="pre">indicators2estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indicators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.indicators2estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.indicators2estimator" title="Link to this definition">¶</a></dt>
<dd><p>Deduce the error estimator value associated with error indicator fields defined over
a <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indicators</strong> – the list of list of error indicator
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>s</p></li>
<li><p><strong>absolute_value</strong> – toggle whether to take the modulus on each element</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-goalie.interpolation">
<span id="goalie-interpolation-module"></span><h2>goalie.interpolation module<a class="headerlink" href="#module-goalie.interpolation" title="Link to this heading">¶</a></h2>
<p>Driver functions for mesh-to-mesh data transfer.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.interpolation.project">
<span class="sig-name descname"><span class="pre">project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_space</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/interpolation.html#project"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.interpolation.project" title="Link to this definition">¶</a></dt>
<dd><p>Overload <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.projection.project" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.projection.project()</span></code></a> to account for the case of two mixed
function spaces defined on different meshes and for the adjoint projection operator
when applied to <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a>s.</p>
<p>Extra keyword arguments are passed to <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.projection.project" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.projection.project()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – the <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a> to be projected</p></li>
<li><p><strong>target_space</strong> – the <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.FunctionSpace" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.FunctionSpace</span></code></a> which we
seek to project into, or the <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a> to use as the target</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.log">
<span id="goalie-log-module"></span><h2>goalie.log module<a class="headerlink" href="#module-goalie.log" title="Link to this heading">¶</a></h2>
<p>Loggers for Goalie.</p>
<p>Code mostly copied from <a class="reference external" href="https://thetisproject.org">the Thetis project</a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.critical">
<span class="sig-name descname"><span class="pre">critical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#critical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.critical" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘CRITICAL’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.critical(“Houston, we have a %s”, “major disaster”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.debug" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘DEBUG’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.debug(“Houston, we have a %s”, “thorny problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.error">
<span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.error" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘ERROR’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.error(“Houston, we have a %s”, “major problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.info" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “interesting problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.pyrint">
<span class="sig-name descname"><span class="pre">pyrint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#goalie.log.pyrint" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “interesting problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.set_log_level">
<span class="sig-name descname"><span class="pre">set_log_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/log.html#set_log_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.set_log_level" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.warning">
<span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.warning" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘WARNING’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.warning(“Houston, we have a %s”, “bit of a problem”, exc_info=1)</p>
</dd></dl>

</section>
<section id="module-goalie.math">
<span id="goalie-math-module"></span><h2>goalie.math module<a class="headerlink" href="#module-goalie.math" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.math.bessi0">
<span class="sig-name descname"><span class="pre">bessi0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/math.html#bessi0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.math.bessi0" title="Link to this definition">¶</a></dt>
<dd><p>Modified Bessel function of the first kind.</p>
<p>Code taken from <span id="id1">[<a class="reference internal" href="#id6" title="William T Vetterling, William T Vetterling, William H Press, William H Press, Saul A Teukolsky, Brian P Flannery, and Brian P Flannery. Numerical recipes: example book C. Cambridge University Press, 1992.">VVP+92</a>]</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.math.bessk0">
<span class="sig-name descname"><span class="pre">bessk0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/math.html#bessk0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.math.bessk0" title="Link to this definition">¶</a></dt>
<dd><p>Modified Bessel function of the second kind.</p>
<p>Code taken from <span id="id2">[<a class="reference internal" href="#id6" title="William T Vetterling, William T Vetterling, William H Press, William H Press, Saul A Teukolsky, Brian P Flannery, and Brian P Flannery. Numerical recipes: example book C. Cambridge University Press, 1992.">VVP+92</a>]</span>.</p>
</dd></dl>

</section>
<section id="module-goalie.mesh_seq">
<span id="goalie-mesh-seq-module"></span><h2>goalie.mesh_seq module<a class="headerlink" href="#module-goalie.mesh_seq" title="Link to this heading">¶</a></h2>
<p>Sequences of meshes corresponding to a <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><span class="pre">TimePartition</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_meshes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A sequence of meshes for solving a PDE associated
with a particular <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> of the
temporal domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> which
partitions the temporal domain</p></li>
<li><p><strong>initial_meshes</strong> – list of meshes corresponding to
the subintervals of the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>,
or a single mesh to use for all subintervals</p></li>
<li><p><strong>get_function_spaces</strong> – a function, whose only
argument is a <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which constructs
prognostic
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.FunctionSpace" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.FunctionSpace</span></code></a>s
for each subinterval</p></li>
<li><p><strong>get_initial_condition</strong> – a function, whose only
argument is a <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which specifies
initial conditions on the first mesh</p></li>
<li><p><strong>get_form</strong> – a function, whose only argument is a
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which returns a function that
generates the PDE weak form</p></li>
<li><p><strong>get_solver</strong> – a function, whose only argument is
a <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which returns a function
that integrates initial data over a subinterval</p></li>
<li><p><strong>get_bcs</strong> – a function, whose only argument is a
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which returns a function that
determines any Dirichlet boundary conditions</p></li>
<li><p><strong>parameters</strong> – <a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a> instance</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.bcs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bcs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></em><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.bcs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.check_element_count_convergence">
<span class="sig-name descname"><span class="pre">check_element_count_convergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.check_element_count_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.check_element_count_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence of the fixed point iteration due to the relative
difference in element count being smaller than the specified tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean array with <code class="docutils literal notranslate"><span class="pre">True</span></code> in the appropriate entry if convergence is
detected on a subinterval.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.count_elements">
<span class="sig-name descname"><span class="pre">count_elements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.count_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.count_elements" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.count_vertices">
<span class="sig-name descname"><span class="pre">count_vertices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.count_vertices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.count_vertices" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.debug" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.fixed_point_iteration">
<span class="sig-name descname"><span class="pre">fixed_point_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adaptor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.fixed_point_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.fixed_point_iteration" title="Link to this definition">¶</a></dt>
<dd><p>Apply goal-oriented mesh adaptation using a fixed point iteration loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adaptor</strong> – function for adapting the mesh sequence. Its arguments are the
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a> instance and the dictionary of solution
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>s. It should return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the
convergence criteria checks are to be skipped for this iteration. Otherwise,
it should return <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>update_params</strong> – function for updating <code class="xref py py-attr docutils literal notranslate"><span class="pre">params</span></code> at each
iteration. Its arguments are the parameter class and the fixed point
iteration</p></li>
<li><p><strong>solver_kwargs</strong> – a dictionary providing parameters to the solver</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.form">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">form</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></em><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.form" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.function_spaces">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></em><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.function_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_bcs">
<span class="sig-name descname"><span class="pre">get_bcs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_bcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_bcs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_checkpoints">
<span class="sig-name descname"><span class="pre">get_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_final_subinterval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_checkpoints" title="Link to this definition">¶</a></dt>
<dd><p>Solve forward on the sequence of meshes, extracting checkpoints corresponding
to the starting fields on each subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> – additional keyword arguments which will be passed to the
solver</p></li>
<li><p><strong>run_final_subinterval</strong> – toggle whether to solve the PDE on the final
subinterval</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_form">
<span class="sig-name descname"><span class="pre">get_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_form"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_form" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_function_spaces">
<span class="sig-name descname"><span class="pre">get_function_spaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.mesh.MeshGeometry" title="(in Firedrake v0.12)"><span class="pre">MeshGeometry</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_function_spaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_function_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_initial_condition">
<span class="sig-name descname"><span class="pre">get_initial_condition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_initial_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_initial_condition" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_solve_blocks">
<span class="sig-name descname"><span class="pre">get_solve_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subinterval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_solve_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_solve_blocks" title="Link to this definition">¶</a></dt>
<dd><p>Get all blocks of the tape corresponding to solve steps for prognostic solution
field on a given subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> – name of the prognostic solution field</p></li>
<li><p><strong>subinterval</strong> – subinterval index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_solver">
<span class="sig-name descname"><span class="pre">get_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.initial_condition">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><span class="pre">AttrDict</span></a></em><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.initial_condition" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot the meshes comprising a 2D <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> – matplotlib figure</p></li>
<li><p><strong>axes</strong> – matplotlib axes</p></li>
</ul>
</dd>
<dt class="field-even">Kwargs<span class="colon">:</span></dt>
<dd class="field-even"><p>parameters to pass to <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.plot.triplot" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.plot.triplot()</span></code></a>
function</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib figure and axes for the plots</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.set_meshes">
<span class="sig-name descname"><span class="pre">set_meshes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meshes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.set_meshes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.set_meshes" title="Link to this definition">¶</a></dt>
<dd><p>Update the meshes associated with the <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, as well as the
associated attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>meshes</strong> – mesh or list of meshes to use in the sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.solve_forward">
<span class="sig-name descname"><span class="pre">solve_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><span class="pre">AttrDict</span></a></span></span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.solve_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.solve_forward" title="Link to this definition">¶</a></dt>
<dd><p>Solve a forward problem on a sequence of subintervals.</p>
<p>A dictionary of solution fields is computed, the contents of which give values
at all exported timesteps, indexed first by the field label and then by type.
The contents of these nested dictionaries are nested lists which are indexed
first by subinterval and then by export. For a given exported timestep, the
solution types are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'forward'</span></code>: the forward solution after taking the</dt><dd><p>timestep;</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>: the forward solution before taking</dt><dd><p>the timestep.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver_kwargs</strong> – a dictionary providing parameters to the solver. Any
keyword arguments for the QoI should be included as a subdict with label
‘qoi_kwargs’</p>
</dd>
<dt class="field-even">Return solution<span class="colon">:</span></dt>
<dd class="field-even"><p>an <a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> containing solution fields and their
lagged versions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.solver">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></em><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.warning">
<span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.warning" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-goalie.metric">
<span id="goalie-metric-module"></span><h2>goalie.metric module<a class="headerlink" href="#module-goalie.metric" title="Link to this heading">¶</a></h2>
<p>Driver functions for metric-based mesh adaptation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.metric.enforce_element_constraints">
<span class="sig-name descname"><span class="pre">enforce_element_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="animate.html#animate.metric.RiemannianMetric" title="animate.metric.RiemannianMetric"><span class="pre">RiemannianMetric</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><span class="pre">Function</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><span class="pre">Function</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><span class="pre">Function</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><span class="pre">Function</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/goalie/metric.html#enforce_element_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.metric.enforce_element_constraints" title="Link to this definition">¶</a></dt>
<dd><p>Post-process a list of metrics to enforce minimum and
maximum element sizes, as well as maximum anisotropy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> – the metrics</p></li>
<li><p><strong>h_min</strong> – minimum tolerated element size,
which could be a <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>
or a number.</p></li>
<li><p><strong>h_max</strong> – maximum tolerated element size,
which could be a <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>
or a number.</p></li>
<li><p><strong>a_max</strong> – maximum tolerated element anisotropy,
which could be a <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>
or a number.</p></li>
<li><p><strong>boundary_tag</strong> – optional tag to enforce sizes on.</p></li>
<li><p><strong>optimise</strong> – is this a timed run?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.metric.ramp_complexity">
<span class="sig-name descname"><span class="pre">ramp_complexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></span><a class="reference internal" href="_modules/goalie/metric.html#ramp_complexity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.metric.ramp_complexity" title="Link to this definition">¶</a></dt>
<dd><p>Ramp up the target complexity over the first few iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> – the base complexity to start from</p></li>
<li><p><strong>target</strong> – the desired complexity</p></li>
<li><p><strong>i</strong> – the current iteration</p></li>
<li><p><strong>num_iterations</strong> – how many iterations to ramp over?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.metric.space_time_normalise">
<span class="sig-name descname"><span class="pre">space_time_normalise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="animate.html#animate.metric.RiemannianMetric" title="animate.metric.RiemannianMetric"><span class="pre">RiemannianMetric</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_partition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><span class="pre">TimePartition</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_anisotropy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="animate.html#animate.metric.RiemannianMetric" title="animate.metric.RiemannianMetric"><span class="pre">RiemannianMetric</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/goalie/metric.html#space_time_normalise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.metric.space_time_normalise" title="Link to this definition">¶</a></dt>
<dd><p>Apply <span class="math notranslate nohighlight">\(L^p\)</span> normalisation in both space and time.</p>
<p>Based on Equation (1) in <span id="id3">[<a class="reference internal" href="#id10" title="N. Barral, M. G. Knepley, M. Lange, M. D. Piggott, and G. J. Gorman. Anisotropic mesh adaptation in Firedrake with PETSc DMPlex. In 25th Intl Meshing Roundtable. 2016.">BKL+16</a>]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> – list of <code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetric</span></code>s corresponding
to the metric associated with each subinterval</p></li>
<li><p><strong>time_partition</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code> for the problem at hand</p></li>
<li><p><strong>metric_parameters</strong> – dictionary containing the target <em>space-time</em> metric
complexity under <cite>dm_plex_metric_target_complexity</cite> and the normalisation order
under <cite>dm_plex_metric_p</cite>, or a list thereof</p></li>
<li><p><strong>global_factor</strong> – pre-computed global normalisation factor</p></li>
<li><p><strong>boundary</strong> – is the normalisation to be done over the boundary?</p></li>
<li><p><strong>restrict_sizes</strong> – should minimum and maximum metric magnitudes be enforced?</p></li>
<li><p><strong>restrict_anisotropy</strong> – should maximum anisotropy be enforced?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.options">
<span id="goalie-options-module"></span><h2>goalie.options module<a class="headerlink" href="#module-goalie.options" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.options.AdaptParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AdaptParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#AdaptParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.AdaptParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a></p>
<p>A class for holding parameters associated with adaptive mesh fixed point iteration
loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> – dictionary of parameters to set</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.options.GoalOrientedMetricParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GoalOrientedMetricParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#GoalOrientedMetricParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.GoalOrientedMetricParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.options.GoalOrientedParameters" title="goalie.options.GoalOrientedParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">GoalOrientedParameters</span></code></a>, <a class="reference internal" href="#goalie.options.MetricParameters" title="goalie.options.MetricParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetricParameters</span></code></a></p>
<p>A class for holding parameters associated with
metric-based, goal-oriented adaptive mesh fixed
point iteration loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> – dictionary of parameters to set</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.options.GoalOrientedParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GoalOrientedParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#GoalOrientedParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.GoalOrientedParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a></p>
<p>A class for holding parameters associated with
goal-oriented adaptive mesh fixed point iteration
loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> – dictionary of parameters to set</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.options.MetricParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MetricParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#MetricParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.MetricParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a></p>
<p>A class for holding parameters associated with
metric-based adaptive mesh fixed point iteration loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> – dictionary of parameters to set</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.options.MetricParameters.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#MetricParameters.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.MetricParameters.export" title="Link to this definition">¶</a></dt>
<dd><p>Set parameters appropriate to a given <code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetric</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metric</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetric</span></code> to apply parameters to</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-goalie.plot">
<span id="goalie-plot-module"></span><h2>goalie.plot module<a class="headerlink" href="#module-goalie.plot" title="Link to this heading">¶</a></h2>
<p>Driver functions for plotting solution data.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.plot.plot_indicator_snapshots">
<span class="sig-name descname"><span class="pre">plot_indicator_snapshots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indicators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/plot.html#plot_indicator_snapshots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.plot.plot_indicator_snapshots" title="Link to this definition">¶</a></dt>
<dd><p>Plot a sequence of snapshots associated with
<code class="docutils literal notranslate"><span class="pre">indicators</span></code> and a given <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a></p>
<p>Any keyword arguments are passed to
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.plot.tricontourf" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.plot.tricontourf()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indicators</strong> – list of list of indicators,
indexed by mesh sequence index, then timestep</p></li>
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>
object used to solve the problem</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.plot.plot_snapshots">
<span class="sig-name descname"><span class="pre">plot_snapshots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/plot.html#plot_snapshots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.plot.plot_snapshots" title="Link to this definition">¶</a></dt>
<dd><p>Plot a sequence of snapshots associated with
<code class="docutils literal notranslate"><span class="pre">solutions.field.label</span></code> and a given
<a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>.</p>
<p>Any keyword arguments are passed to
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.plot.tricontourf" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.plot.tricontourf()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solutions</strong> – <a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> of solutions
computed by solving a forward or adjoint
problem</p></li>
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>
object used to solve the problem</p></li>
<li><p><strong>field</strong> – solution field of choice</p></li>
<li><p><strong>label</strong> – choose from <code class="docutils literal notranslate"><span class="pre">'forward'</span></code>, <code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>
<code class="docutils literal notranslate"><span class="pre">'adjoint'</span></code> and <code class="docutils literal notranslate"><span class="pre">'adjoint_next'</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.time_partition">
<span id="goalie-time-partition-module"></span><h2>goalie.time_partition module<a class="headerlink" href="#module-goalie.time_partition" title="Link to this heading">¶</a></h2>
<p>Partitioning for the temporal domain.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.time_partition.TimeInstant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TimeInstant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/time_partition.html#TimeInstant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.time_partition.TimeInstant" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.time_partition.TimeInterval" title="goalie.time_partition.TimeInterval"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInterval</span></code></a></p>
<p>A <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> for steady-state problems.</p>
<p>Under the hood this means dividing <span class="math notranslate nohighlight">\([0,1)\)</span> into
a single timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_time</strong> – end time of the interval of interest</p></li>
<li><p><strong>num_subintervals</strong> – number of subintervals in the partition</p></li>
<li><p><strong>timesteps</strong> – (list of values for the) timestep used on each subinterval</p></li>
<li><p><strong>fields</strong> – (list of) field names</p></li>
<li><p><strong>num_timesteps_per_export</strong> – (list of) number of timesteps per export</p></li>
<li><p><strong>start_time</strong> – start time of the interval of interest</p></li>
<li><p><strong>subinterals</strong> – user-provided sequence of subintervals, which need not be of
uniform length</p></li>
<li><p><strong>field_types</strong> – (list of) strings indicating whether each field is
‘unsteady’ or ‘steady’, i.e., does the corresponding equation involve time
derivatives or not?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.time_partition.TimeInterval">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TimeInterval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/time_partition.html#TimeInterval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.time_partition.TimeInterval" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a></p>
<p>A trivial <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_time</strong> – end time of the interval of interest</p></li>
<li><p><strong>num_subintervals</strong> – number of subintervals in the partition</p></li>
<li><p><strong>timesteps</strong> – (list of values for the) timestep used on each subinterval</p></li>
<li><p><strong>fields</strong> – (list of) field names</p></li>
<li><p><strong>num_timesteps_per_export</strong> – (list of) number of timesteps per export</p></li>
<li><p><strong>start_time</strong> – start time of the interval of interest</p></li>
<li><p><strong>subinterals</strong> – user-provided sequence of subintervals, which need not be of
uniform length</p></li>
<li><p><strong>field_types</strong> – (list of) strings indicating whether each field is
‘unsteady’ or ‘steady’, i.e., does the corresponding equation involve time
derivatives or not?</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="goalie.time_partition.TimeInterval.timestep">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">timestep</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></em><a class="headerlink" href="#goalie.time_partition.TimeInterval.timestep" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.time_partition.TimePartition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TimePartition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_subintervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_timesteps_per_export</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subintervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/time_partition.html#TimePartition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.time_partition.TimePartition" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A partition of the time interval of interest into subintervals.</p>
<p>The subintervals are assumed to be uniform in length. However, different timestep
values may be used on each subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_time</strong> – end time of the interval of interest</p></li>
<li><p><strong>num_subintervals</strong> – number of subintervals in the partition</p></li>
<li><p><strong>timesteps</strong> – (list of values for the) timestep used on each subinterval</p></li>
<li><p><strong>fields</strong> – (list of) field names</p></li>
<li><p><strong>num_timesteps_per_export</strong> – (list of) number of timesteps per export</p></li>
<li><p><strong>start_time</strong> – start time of the interval of interest</p></li>
<li><p><strong>subinterals</strong> – user-provided sequence of subintervals, which need not be of
uniform length</p></li>
<li><p><strong>field_types</strong> – (list of) strings indicating whether each field is
‘unsteady’ or ‘steady’, i.e., does the corresponding equation involve time
derivatives or not?</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.time_partition.TimePartition.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/time_partition.html#TimePartition.debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.time_partition.TimePartition.debug" title="Link to this definition">¶</a></dt>
<dd><p>Print attribute ‘msg’ for debugging purposes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.time_partition.TimePartition.num_timesteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_timesteps</span></span><a class="headerlink" href="#goalie.time_partition.TimePartition.num_timesteps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-goalie.utility">
<span id="goalie-utility-module"></span><h2>goalie.utility module<a class="headerlink" href="#module-goalie.utility" title="Link to this heading">¶</a></h2>
<p>Utility functions and classes for mesh adaptation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.utility.AttrDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AttrDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#AttrDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.AttrDict" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Dictionary that provides both <code class="docutils literal notranslate"><span class="pre">self[key]</span></code>
and <code class="docutils literal notranslate"><span class="pre">self.key</span></code> access to members.</p>
<p><strong>Disclaimer</strong>: Copied from <a class="reference external" href="http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python">stackoverflow</a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.utility.File">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">File</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#File"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.File" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.output.File" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a></p>
<p>Overload <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.output.File" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.output.File</span></code></a> so that
it uses <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> mode by default. Whilst
this means that the mesh topology is
recomputed at every export, it removes any
need for the user to reset it manually.</p>
<p>Create an object for outputting data for visualisation.</p>
<p>This produces output in VTU format, suitable for visualisation
with Paraview or other VTK-capable visualisation packages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – The name of the output file (must end in
<code class="docutils literal notranslate"><span class="pre">.pvd</span></code>).</p></li>
<li><p><strong>project_output</strong> – Should the output be projected to
a computed output space?  Default is to use interpolation.</p></li>
<li><p><strong>comm</strong> – The MPI communicator to use.</p></li>
<li><p><strong>mode</strong> – “w” to overwrite any existing file, “a” to append to an existing file.</p></li>
<li><p><strong>target_degree</strong> – override the degree of the output space.</p></li>
<li><p><strong>target_continuity</strong> – override the continuity of the output space;
A UFL <code class="xref py py-class docutils literal notranslate"><span class="pre">ufl.sobolevspace.SobolevSpace</span></code> object: <cite>H1</cite> for a
continuous output and <cite>L2</cite> for a discontinuous output.</p></li>
<li><p><strong>adaptive</strong> – allow different meshes at different exports if <cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Visualisation is only possible for Lagrange fields (either
continuous or discontinuous).  All other fields are first
either projected or interpolated to Lagrange elements
before storing for visualisation purposes.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.Mesh">
<span class="sig-name descname"><span class="pre">Mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.mesh.MeshGeometry" title="(in Firedrake v0.12)"><span class="pre">MeshGeometry</span></a></span></span><a class="reference internal" href="_modules/goalie/utility.html#Mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.Mesh" title="Link to this definition">¶</a></dt>
<dd><p>Overload <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.mesh.Mesh" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.mesh.Mesh()</span></code></a> to
endow the output mesh with useful quantities.</p>
<dl class="simple">
<dt>The following quantities are computed by default:</dt><dd><ul class="simple">
<li><p>cell size;</p></li>
<li><p>facet area.</p></li>
</ul>
</dd>
</dl>
<p>The argument and keyword arguments are passed to
Firedrake’s <code class="docutils literal notranslate"><span class="pre">Mesh</span></code> constructor, modified so
that the argument could also be a mesh.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.assemble_mass_matrix">
<span class="sig-name descname"><span class="pre">assemble_mass_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FunctionSpace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'L2'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mat</span></span></span><a class="reference internal" href="_modules/goalie/utility.html#assemble_mass_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.assemble_mass_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Assemble the <code class="docutils literal notranslate"><span class="pre">norm_type</span></code> mass matrix
associated with some finite element <code class="docutils literal notranslate"><span class="pre">space</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.cofunction2function">
<span class="sig-name descname"><span class="pre">cofunction2function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#cofunction2function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.cofunction2function" title="Link to this definition">¶</a></dt>
<dd><p>Map a <code class="xref py py-class docutils literal notranslate"><span class="pre">Cofunction</span></code> to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.create_directory">
<span class="sig-name descname"><span class="pre">create_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm:</span> <span class="pre">~mpi4py.MPI.Intracomm</span> <span class="pre">=</span> <span class="pre">&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/goalie/utility.html#create_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.create_directory" title="Link to this definition">¶</a></dt>
<dd><p>Create a directory on disk.</p>
<p>Code copied from <a class="reference external" href="https://thetisproject.org">Thetis</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to the directory</p></li>
<li><p><strong>comm</strong> – MPI communicator</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.effectivity_index">
<span class="sig-name descname"><span class="pre">effectivity_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_indicator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><span class="pre">Function</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">Je</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></span><a class="reference internal" href="_modules/goalie/utility.html#effectivity_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.effectivity_index" title="Link to this definition">¶</a></dt>
<dd><p>Overestimation factor of some error estimator
for the QoI error.</p>
<p>Note that this is only typically used for simple
steady-state problems with analytical solutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error_indicator</strong> – a <span class="math notranslate nohighlight">\(\mathbb P0\)</span>
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> which
localises contributions to an error estimator
to individual elements</p></li>
<li><p><strong>Je</strong> – error in quantity of interest</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.errornorm">
<span class="sig-name descname"><span class="pre">errornorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#errornorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.errornorm" title="Link to this definition">¶</a></dt>
<dd><p>Overload <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.norms.errornorm" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.norms.errornorm()</span></code></a> to allow for <span class="math notranslate nohighlight">\(\ell^p\)</span> norms.</p>
<p>Note that this version is case sensitive, i.e. <code class="docutils literal notranslate"><span class="pre">'l2'</span></code> and <code class="docutils literal notranslate"><span class="pre">'L2'</span></code> will give
different results in general.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – the ‘true’ value</p></li>
<li><p><strong>uh</strong> – the approximation of the ‘truth’</p></li>
<li><p><strong>norm_type</strong> – choose from <code class="docutils literal notranslate"><span class="pre">'l1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'l2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'linf'</span></code>, <code class="docutils literal notranslate"><span class="pre">'L2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Linf'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'H1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Hdiv'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Hcurl'</span></code>, or any <code class="docutils literal notranslate"><span class="pre">'Lp'</span></code> with <span class="math notranslate nohighlight">\(p &gt;= 1\)</span>.</p></li>
<li><p><strong>boundary</strong> – should the norm be computed over the domain boundary?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.function2cofunction">
<span class="sig-name descname"><span class="pre">function2cofunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#function2cofunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.function2cofunction" title="Link to this definition">¶</a></dt>
<dd><p>Map a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Cofunction</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.norm" title="Link to this definition">¶</a></dt>
<dd><p>Overload <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.norms.norm" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.norms.norm()</span></code></a> to allow for <span class="math notranslate nohighlight">\(\ell^p\)</span> norms.</p>
<p>Note that this version is case sensitive, i.e. <code class="docutils literal notranslate"><span class="pre">'l2'</span></code> and <code class="docutils literal notranslate"><span class="pre">'L2'</span></code> will give
different results in general.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> – the <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a> to take the norm of</p></li>
<li><p><strong>norm_type</strong> – choose from <code class="docutils literal notranslate"><span class="pre">'l1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'l2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'linf'</span></code>, <code class="docutils literal notranslate"><span class="pre">'L2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Linf'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'H1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Hdiv'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Hcurl'</span></code>, or any <code class="docutils literal notranslate"><span class="pre">'Lp'</span></code> with <span class="math notranslate nohighlight">\(p &gt;= 1\)</span>.</p></li>
<li><p><strong>condition</strong> – a UFL condition for specifying a subdomain to compute the norm
over</p></li>
<li><p><strong>boundary</strong> – should the norm be computed over the domain boundary?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-goalie" title="Link to this heading">¶</a></h2>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<p class="rubric">References</p>
<div class="docutils container" id="id4">
<div role="list" class="citation-list">
<div class="citation" id="id10" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">BKL+16</a><span class="fn-bracket">]</span></span>
<p>N. Barral, M. G. Knepley, M. Lange, M. D. Piggott, and G. J. Gorman. Anisotropic mesh adaptation in Firedrake with PETSc DMPlex. In <em>25th Intl Meshing Roundtable</em>. 2016.</p>
</div>
<div class="citation" id="id9" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>CPB13<span class="fn-bracket">]</span></span>
<p>Jaime Carpio, Juan Luis Prieto, and Rodolfo Bermejo. Anisotropic “goal-oriented” mesh adaptivity for elliptic problems. <em>SIAM Journal on Scientific Computing</em>, 35(2):A861–A885, 2013. <a class="reference external" href="https://doi.org/10.1137/120874606">doi:10.1137/120874606</a>.</p>
</div>
<div class="citation" id="id5" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Clement75<span class="fn-bracket">]</span></span>
<p>Ph Clément. Approximation by finite element functions using local regularization. <em>Revue française d'automatique, informatique, recherche opérationnelle. Analyse numérique</em>, 9(R2):77–84, 1975.</p>
</div>
<div class="citation" id="id8" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>LDA10<span class="fn-bracket">]</span></span>
<p>Adrien Loseille, Alain Dervieux, and Frédéric Alauzet. Fully anisotropic goal-oriented mesh adaptation for 3D steady Euler equations. <em>Journal of computational physics</em>, 229(8):2866–2897, 2010. <a class="reference external" href="https://doi.org/10.1016/j.jcp.2009.12.021">doi:10.1016/j.jcp.2009.12.021</a>.</p>
</div>
<div class="citation" id="id7" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>PPP+06<span class="fn-bracket">]</span></span>
<p>PW Power, Christopher C Pain, MD Piggott, Fangxin Fang, Gerard J Gorman, AP Umpleby, Anthony JH Goddard, and IM Navon. Adjoint a posteriori error measures for anisotropic mesh optimisation. <em>Computers &amp; Mathematics with Applications</em>, 52(8-9):1213–1242, 2006. <a class="reference external" href="https://doi.org/10.1016/j.camwa.2006.11.003">doi:10.1016/j.camwa.2006.11.003</a>.</p>
</div>
<div class="citation" id="id6" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>VVP+92<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>)</span>
<p>William T Vetterling, William T Vetterling, William H Press, William H Press, Saul A Teukolsky, Brian P Flannery, and Brian P Flannery. <em>Numerical recipes: example book C</em>. Cambridge University Press, 1992.</p>
</div>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">goalie package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-goalie.adjoint">goalie.adjoint module</a><ul>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a><ul>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.check_qoi_convergence"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.check_qoi_convergence()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_checkpoints"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.get_checkpoints()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_qoi"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.get_qoi()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_solve_blocks"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.get_solve_blocks()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.initial_condition"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.initial_condition</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.solve_adjoint"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.solve_adjoint()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.th"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.th()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#goalie.adjoint.annotate_qoi"><code class="docutils literal notranslate"><span class="pre">annotate_qoi()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.error_estimation">goalie.error_estimation module</a><ul>
<li><a class="reference internal" href="#goalie.error_estimation.get_dwr_indicator"><code class="docutils literal notranslate"><span class="pre">get_dwr_indicator()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.go_mesh_seq">goalie.go_mesh_seq module</a><ul>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq</span></code></a><ul>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.check_estimator_convergence"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.check_estimator_convergence()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.fixed_point_iteration"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.fixed_point_iteration()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.get_enriched_mesh_seq"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.get_enriched_mesh_seq()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.indicate_errors"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.indicate_errors()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.indicators2estimator"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.indicators2estimator()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.interpolation">goalie.interpolation module</a><ul>
<li><a class="reference internal" href="#goalie.interpolation.project"><code class="docutils literal notranslate"><span class="pre">project()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.log">goalie.log module</a><ul>
<li><a class="reference internal" href="#goalie.log.critical"><code class="docutils literal notranslate"><span class="pre">critical()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.debug"><code class="docutils literal notranslate"><span class="pre">debug()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.error"><code class="docutils literal notranslate"><span class="pre">error()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.info"><code class="docutils literal notranslate"><span class="pre">info()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.pyrint"><code class="docutils literal notranslate"><span class="pre">pyrint()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.set_log_level"><code class="docutils literal notranslate"><span class="pre">set_log_level()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.warning"><code class="docutils literal notranslate"><span class="pre">warning()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.math">goalie.math module</a><ul>
<li><a class="reference internal" href="#goalie.math.bessi0"><code class="docutils literal notranslate"><span class="pre">bessi0()</span></code></a></li>
<li><a class="reference internal" href="#goalie.math.bessk0"><code class="docutils literal notranslate"><span class="pre">bessk0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.mesh_seq">goalie.mesh_seq module</a><ul>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq"><code class="docutils literal notranslate"><span class="pre">MeshSeq</span></code></a><ul>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.bcs"><code class="docutils literal notranslate"><span class="pre">MeshSeq.bcs</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.check_element_count_convergence"><code class="docutils literal notranslate"><span class="pre">MeshSeq.check_element_count_convergence()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.count_elements"><code class="docutils literal notranslate"><span class="pre">MeshSeq.count_elements()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.count_vertices"><code class="docutils literal notranslate"><span class="pre">MeshSeq.count_vertices()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.debug"><code class="docutils literal notranslate"><span class="pre">MeshSeq.debug()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.fixed_point_iteration"><code class="docutils literal notranslate"><span class="pre">MeshSeq.fixed_point_iteration()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.form"><code class="docutils literal notranslate"><span class="pre">MeshSeq.form</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.function_spaces"><code class="docutils literal notranslate"><span class="pre">MeshSeq.function_spaces</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_bcs"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_bcs()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_checkpoints"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_checkpoints()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_form"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_form()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_function_spaces"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_function_spaces()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_initial_condition"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_initial_condition()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_solve_blocks"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_solve_blocks()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_solver"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_solver()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.info"><code class="docutils literal notranslate"><span class="pre">MeshSeq.info()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.initial_condition"><code class="docutils literal notranslate"><span class="pre">MeshSeq.initial_condition</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.plot"><code class="docutils literal notranslate"><span class="pre">MeshSeq.plot()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.set_meshes"><code class="docutils literal notranslate"><span class="pre">MeshSeq.set_meshes()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.solve_forward"><code class="docutils literal notranslate"><span class="pre">MeshSeq.solve_forward()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.solver"><code class="docutils literal notranslate"><span class="pre">MeshSeq.solver</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.warning"><code class="docutils literal notranslate"><span class="pre">MeshSeq.warning()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.metric">goalie.metric module</a><ul>
<li><a class="reference internal" href="#goalie.metric.enforce_element_constraints"><code class="docutils literal notranslate"><span class="pre">enforce_element_constraints()</span></code></a></li>
<li><a class="reference internal" href="#goalie.metric.ramp_complexity"><code class="docutils literal notranslate"><span class="pre">ramp_complexity()</span></code></a></li>
<li><a class="reference internal" href="#goalie.metric.space_time_normalise"><code class="docutils literal notranslate"><span class="pre">space_time_normalise()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.options">goalie.options module</a><ul>
<li><a class="reference internal" href="#goalie.options.AdaptParameters"><code class="docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a></li>
<li><a class="reference internal" href="#goalie.options.GoalOrientedMetricParameters"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMetricParameters</span></code></a></li>
<li><a class="reference internal" href="#goalie.options.GoalOrientedParameters"><code class="docutils literal notranslate"><span class="pre">GoalOrientedParameters</span></code></a></li>
<li><a class="reference internal" href="#goalie.options.MetricParameters"><code class="docutils literal notranslate"><span class="pre">MetricParameters</span></code></a><ul>
<li><a class="reference internal" href="#goalie.options.MetricParameters.export"><code class="docutils literal notranslate"><span class="pre">MetricParameters.export()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.plot">goalie.plot module</a><ul>
<li><a class="reference internal" href="#goalie.plot.plot_indicator_snapshots"><code class="docutils literal notranslate"><span class="pre">plot_indicator_snapshots()</span></code></a></li>
<li><a class="reference internal" href="#goalie.plot.plot_snapshots"><code class="docutils literal notranslate"><span class="pre">plot_snapshots()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.time_partition">goalie.time_partition module</a><ul>
<li><a class="reference internal" href="#goalie.time_partition.TimeInstant"><code class="docutils literal notranslate"><span class="pre">TimeInstant</span></code></a></li>
<li><a class="reference internal" href="#goalie.time_partition.TimeInterval"><code class="docutils literal notranslate"><span class="pre">TimeInterval</span></code></a><ul>
<li><a class="reference internal" href="#goalie.time_partition.TimeInterval.timestep"><code class="docutils literal notranslate"><span class="pre">TimeInterval.timestep</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#goalie.time_partition.TimePartition"><code class="docutils literal notranslate"><span class="pre">TimePartition</span></code></a><ul>
<li><a class="reference internal" href="#goalie.time_partition.TimePartition.debug"><code class="docutils literal notranslate"><span class="pre">TimePartition.debug()</span></code></a></li>
<li><a class="reference internal" href="#goalie.time_partition.TimePartition.num_timesteps"><code class="docutils literal notranslate"><span class="pre">TimePartition.num_timesteps</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.utility">goalie.utility module</a><ul>
<li><a class="reference internal" href="#goalie.utility.AttrDict"><code class="docutils literal notranslate"><span class="pre">AttrDict</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.File"><code class="docutils literal notranslate"><span class="pre">File</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.Mesh"><code class="docutils literal notranslate"><span class="pre">Mesh()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.assemble_mass_matrix"><code class="docutils literal notranslate"><span class="pre">assemble_mass_matrix()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.cofunction2function"><code class="docutils literal notranslate"><span class="pre">cofunction2function()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.create_directory"><code class="docutils literal notranslate"><span class="pre">create_directory()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.effectivity_index"><code class="docutils literal notranslate"><span class="pre">effectivity_index()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.errornorm"><code class="docutils literal notranslate"><span class="pre">errornorm()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.function2cofunction"><code class="docutils literal notranslate"><span class="pre">function2cofunction()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie">Module contents</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="animate.html"
                          title="previous chapter">animate package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="demos/simple_metric.py.html"
                          title="next chapter">Defining a simple metric field and adapting the mesh to it</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/goalie.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="demos/simple_metric.py.html" title="Defining a simple metric field and adapting the mesh to it"
             >next</a> |</li>
        <li class="right" >
          <a href="animate.html" title="animate package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Animate and Goalie 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">goalie package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2021-2023, Joseph G. Wallwork et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>