<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>goalie package &#8212; Animate, Movement and Goalie 0.1 documentation</title>
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Animate, Movement and Goalie 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">goalie package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="goalie-package">
<h1>goalie package<a class="headerlink" href="#goalie-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-goalie.adjoint">
<span id="goalie-adjoint-module"></span><h2>goalie.adjoint module<a class="headerlink" href="#module-goalie.adjoint" title="Link to this heading">¶</a></h2>
<p>Drivers for solving adjoint problems on sequences of meshes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AdjointMeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_meshes</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a></p>
<p>An extension of <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a> to account for solving adjoint problems on a
sequence of meshes.</p>
<p>For time-dependent quantities of interest, the solver should access and modify
<code class="xref py py-attr docutils literal notranslate"><span class="pre">J</span></code>, which holds the QoI value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> (<a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>) – a partition of the temporal domain</p></li>
<li><p><strong>initial_meshes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshGeometry</span></code>) – a list of meshes corresponding to the subinterval of the
time partition, or a single mesh to use for all subintervals</p></li>
<li><p><strong>get_function_spaces</strong> – a function as described in
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_function_spaces" title="goalie.mesh_seq.MeshSeq.get_function_spaces"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_function_spaces()</span></code></a></p></li>
<li><p><strong>get_initial_condition</strong> – a function as described in
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_initial_condition" title="goalie.mesh_seq.MeshSeq.get_initial_condition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_initial_condition()</span></code></a></p></li>
<li><p><strong>get_form</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_form" title="goalie.mesh_seq.MeshSeq.get_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_form()</span></code></a></p></li>
<li><p><strong>get_solver</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_solver" title="goalie.mesh_seq.MeshSeq.get_solver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_solver()</span></code></a></p></li>
<li><p><strong>get_bcs</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_bcs" title="goalie.mesh_seq.MeshSeq.get_bcs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_bcs()</span></code></a></p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a>) – parameters to apply to the mesh adaptation process</p></li>
<li><p><strong>get_qoi</strong> – a function as described in <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_qoi" title="goalie.adjoint.AdjointMeshSeq.get_qoi"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_qoi()</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.check_qoi_convergence">
<span class="sig-name descname"><span class="pre">check_qoi_convergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.check_qoi_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.check_qoi_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence of the fixed point iteration due to the relative
difference in QoI value being smaller than the specified tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if QoI convergence is detected, else <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.get_checkpoints">
<span class="sig-name descname"><span class="pre">get_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_final_subinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.get_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.get_checkpoints" title="Link to this definition">¶</a></dt>
<dd><p>Solve forward on the sequence of meshes, extracting checkpoints corresponding
to the starting fields on each subinterval.</p>
<p>The QoI is also evaluated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may
take various types) – additional keyword arguments to be passed to the solver</p></li>
<li><p><strong>run_final_subinterval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the solver is run on the final
subinterval</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>checkpoints for each subinterval</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.get_qoi">
<span class="sig-name descname"><span class="pre">get_qoi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subinterval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.get_qoi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.get_qoi" title="Link to this definition">¶</a></dt>
<dd><p>Get the function for evaluating the QoI, which has either zero or one arguments,
corresponding to either an end time or time integrated quantity of interest,
respectively. If the QoI has an argument then it is for the current time.</p>
<p>Signature for the function to be returned:
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">:arg</span> <span class="pre">t:</span> <span class="pre">the</span> <span class="pre">current</span> <span class="pre">time</span> <span class="pre">(for</span> <span class="pre">time-integrated</span> <span class="pre">QoIs)</span>
<span class="pre">:type</span> <span class="pre">t:</span> <span class="pre">:class:`float`</span>
<span class="pre">:return:</span> <span class="pre">the</span> <span class="pre">QoI</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">0-form</span>
<span class="pre">:rtype:</span> <span class="pre">:class:`ufl.form.Form`</span>
<span class="pre">`</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution_map</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values and
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> values) – a dictionary whose keys are the solution field names and whose
values are the corresponding solutions</p></li>
<li><p><strong>subinterval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – the subinterval index</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the function for obtaining the QoI</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>see docstring above</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.get_solve_blocks">
<span class="sig-name descname"><span class="pre">get_solve_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subinterval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_adj_sol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.get_solve_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.get_solve_blocks" title="Link to this definition">¶</a></dt>
<dd><p>Get all blocks of the tape corresponding to solve steps for prognostic solution
field on a given subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – name of the prognostic solution field</p></li>
<li><p><strong>subinterval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – subinterval index</p></li>
<li><p><strong>has_adj_sol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, only blocks with <code class="docutils literal notranslate"><span class="pre">adj_sol</span></code> attributes will be
considered</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of solve blocks</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <code class="xref py py-class docutils literal notranslate"><span class="pre">pyadjoint.block.Block</span></code>s</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.initial_condition">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_condition</span></span><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.initial_condition" title="Link to this definition">¶</a></dt>
<dd><p>Get the initial conditions associated with the first subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary whose keys are field names and whose values are the
corresponding initial conditions applied on the first subinterval</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.solve_adjoint">
<span class="sig-name descname"><span class="pre">solve_adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_adj_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_checkpoint_qoi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.solve_adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.solve_adjoint" title="Link to this definition">¶</a></dt>
<dd><p>Solve an adjoint problem on a sequence of subintervals.</p>
<p>As well as the quantity of interest value, solution fields are computed - see
<a class="reference internal" href="#goalie.function_data.AdjointSolutionData" title="goalie.function_data.AdjointSolutionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointSolutionData</span></code></a> for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may
take various types) – parameters for the forward solver, as well as any
parameters for the QoI, which should be included as a sub-dictionary with key
‘qoi_kwargs’</p></li>
<li><p><strong>adj_solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which
may take various types) – parameters for the adjoint solver</p></li>
<li><p><strong>get_adj_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, adjoint actions are also returned at exported
timesteps</p></li>
<li><p><strong>test_checkpoint_qoi</strong> – solve over the final subinterval when checkpointing
so that the QoI value can be checked across runs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the solution data of the forward and adjoint solves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#goalie.function_data.AdjointSolutionData" title="goalie.function_data.AdjointSolutionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointSolutionData</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.adjoint.AdjointMeshSeq.th">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">th</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#AdjointMeshSeq.th"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.AdjointMeshSeq.th" title="Link to this definition">¶</a></dt>
<dd><p>Convert from cardinal to ordinal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – the cardinal number to convert</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the corresponding ordinal number</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.adjoint.annotate_qoi">
<span class="sig-name descname"><span class="pre">annotate_qoi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">get_qoi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/adjoint.html#annotate_qoi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.adjoint.annotate_qoi" title="Link to this definition">¶</a></dt>
<dd><p>Decorator that ensures QoIs are annotated properly.</p>
<p>To be applied to the <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_qoi" title="goalie.adjoint.AdjointMeshSeq.get_qoi"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_qoi()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>get_qoi</strong> – a function mapping a dictionary of solution data and an integer index
to a QoI function</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.error_estimation">
<span id="goalie-error-estimation-module"></span><h2>goalie.error_estimation module<a class="headerlink" href="#module-goalie.error_estimation" title="Link to this heading">¶</a></h2>
<p>Tools to automate goal-oriented error estimation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.error_estimation.get_dwr_indicator">
<span class="sig-name descname"><span class="pre">get_dwr_indicator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjoint_error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/error_estimation.html#get_dwr_indicator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.error_estimation.get_dwr_indicator" title="Link to this definition">¶</a></dt>
<dd><p>Given a 1-form and an approximation of the error in the adjoint solution, compute a
dual weighted residual (DWR) error indicator.</p>
<p>Note that each term of a 1-form contains only one
<code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.ufl_expr.TestFunction</span></code>. The 1-form most commonly corresponds to the
variational form of a PDE. If the PDE is linear, it should be written as in the
nonlinear case (i.e., with the solution field in place of any
<code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.ufl_expr.TrialFunction</span></code>s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>F</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ufl.form.Form</span></code>) – the form</p></li>
<li><p><strong>adjoint_error</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> values) – a dictionary whose keys are field names and whose values are the
approximations to the corresponding components of the adjoint error, or a single
such component</p></li>
<li><p><strong>test_space</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.WithGeometry" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.WithGeometry</span></code></a>) – a dictionary whose keys are field names and whose values are the
test spaces for the corresponding fields, or a single such test space (or
<code class="docutils literal notranslate"><span class="pre">None</span></code> to determine the test space(s) automatically)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the DWR indicator</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.function_data">
<span id="goalie-function-data-module"></span><h2>goalie.function_data module<a class="headerlink" href="#module-goalie.function_data" title="Link to this heading">¶</a></h2>
<p>Nested dictionaries of solution data <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>s.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.function_data.AdjointSolutionData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AdjointSolutionData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/function_data.html#AdjointSolutionData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.function_data.AdjointSolutionData" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></p>
<p>Class representing solution data for general adjoint problems.</p>
<p>For a given exported timestep, the field types are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'forward'</span></code>: the forward solution after taking the timestep;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>: the forward solution before taking the timestep (provided
the problem is not steady-state)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'adjoint'</span></code>: the adjoint solution after taking the timestep;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'adjoint_next'</span></code>: the adjoint solution before taking the timestep
backwards (provided the problem is not steady-state).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> used to discretise the problem
in time</p></li>
<li><p><strong>function_spaces</strong> – the dictionary of <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code>s used to
discretise the problem in space</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.function_data.ForwardSolutionData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ForwardSolutionData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/function_data.html#ForwardSolutionData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.function_data.ForwardSolutionData" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></p>
<p>Class representing solution data for general forward problems.</p>
<p>For a given exported timestep, the field types are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'forward'</span></code>: the forward solution after taking the timestep;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>: the forward solution before taking the timestep (provided
the problem is not steady-state).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> used to discretise the problem
in time</p></li>
<li><p><strong>function_spaces</strong> – the dictionary of <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code>s used to
discretise the problem in space</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.function_data.IndicatorData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IndicatorData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/function_data.html#IndicatorData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.function_data.IndicatorData" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></p>
<p>Class representing error indicator data.</p>
<p>Note that this class has a single dictionary with the field name as the key, rather
than a doubly-nested dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> used to discretise the problem
in time</p></li>
<li><p><strong>meshes</strong> – the list of meshes used to discretise the problem in space</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.go_mesh_seq">
<span id="goalie-go-mesh-seq-module"></span><h2>goalie.go_mesh_seq module<a class="headerlink" href="#module-goalie.go_mesh_seq" title="Link to this heading">¶</a></h2>
<p>Drivers for goal-oriented error estimation on sequences of meshes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GoalOrientedMeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq" title="goalie.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a></p>
<p>An extension of <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq" title="goalie.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a> to account for goal-oriented problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> (<a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>) – a partition of the temporal domain</p></li>
<li><p><strong>initial_meshes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshGeometry</span></code>) – a list of meshes corresponding to the subinterval of the
time partition, or a single mesh to use for all subintervals</p></li>
<li><p><strong>get_function_spaces</strong> – a function as described in
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_function_spaces" title="goalie.mesh_seq.MeshSeq.get_function_spaces"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_function_spaces()</span></code></a></p></li>
<li><p><strong>get_initial_condition</strong> – a function as described in
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_initial_condition" title="goalie.mesh_seq.MeshSeq.get_initial_condition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_initial_condition()</span></code></a></p></li>
<li><p><strong>get_form</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_form" title="goalie.mesh_seq.MeshSeq.get_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_form()</span></code></a></p></li>
<li><p><strong>get_solver</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_solver" title="goalie.mesh_seq.MeshSeq.get_solver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_solver()</span></code></a></p></li>
<li><p><strong>get_bcs</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_bcs" title="goalie.mesh_seq.MeshSeq.get_bcs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_bcs()</span></code></a></p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a>) – parameters to apply to the mesh adaptation process</p></li>
<li><p><strong>get_qoi</strong> – a function as described in <a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_qoi" title="goalie.adjoint.AdjointMeshSeq.get_qoi"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_qoi()</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.check_estimator_convergence">
<span class="sig-name descname"><span class="pre">check_estimator_convergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.check_estimator_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.check_estimator_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence of the fixed point iteration due to the relative
difference in error estimator value being smaller than the specified tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if estimator convergence is detected, else <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.error_estimate">
<span class="sig-name descname"><span class="pre">error_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">absolute_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.error_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.error_estimate" title="Link to this definition">¶</a></dt>
<dd><p>Deduce the error estimator value associated with error indicator fields defined
over the mesh sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>absolute_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the modulus is taken on each element</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the error estimator value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.fixed_point_iteration">
<span class="sig-name descname"><span class="pre">fixed_point_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adaptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_params=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enrichment_kwargs={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptor_kwargs={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_kwargs={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicator_fn=&lt;cyfunction</span> <span class="pre">get_dwr_indicator&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.fixed_point_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.fixed_point_iteration" title="Link to this definition">¶</a></dt>
<dd><p>Apply goal-oriented mesh adaptation using a fixed point iteration loop approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adaptor</strong> – function for adapting the mesh sequence. Its arguments are the mesh
sequence and the solution and indicator data objects. It should return
<code class="docutils literal notranslate"><span class="pre">True</span></code> if the convergence criteria checks are to be skipped for this
iteration. Otherwise, it should return <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>update_params</strong> – function for updating <code class="xref py py-attr docutils literal notranslate"><span class="pre">params</span></code> at each
iteration. Its arguments are the parameter class and the fixed point
iteration</p></li>
<li><p><strong>enrichment_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which
may take various types) – keyword arguments to pass to the global enrichment
method</p></li>
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may
take various types) – parameters to pass to the solver</p></li>
<li><p><strong>adaptor_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may
take various types) – parameters to pass to the adaptor</p></li>
<li><p><strong>indicator_fn</strong> – function which maps the form, adjoint error and enriched
space(s) as arguments to the error indicator
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>solution and indicator data objects</p>
</dd>
<dt class="field-odd">Rtype1<span class="colon">:</span></dt>
<dd class="field-odd"><p>:class:<a href="#id1"><span class="problematic" id="id2">`</span></a>~.AdjointSolutionData</p>
</dd>
<dt class="field-even">Rtype2<span class="colon">:</span></dt>
<dd class="field-even"><p>:class:<a href="#id3"><span class="problematic" id="id4">`</span></a>~.IndicatorData</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.get_enriched_mesh_seq">
<span class="sig-name descname"><span class="pre">get_enriched_mesh_seq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enrichment_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_enrichments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.get_enriched_mesh_seq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.get_enriched_mesh_seq" title="Link to this definition">¶</a></dt>
<dd><p>Construct a sequence of globally enriched spaces.</p>
<p>The following global enrichment methods are supported:
* h-refinement (<code class="docutils literal notranslate"><span class="pre">enrichment_method='h'</span></code>) - refine each mesh element</p>
<blockquote>
<div><p>uniformly in each direction;</p>
</div></blockquote>
<ul class="simple">
<li><p>p-refinement (<code class="docutils literal notranslate"><span class="pre">enrichment_method='p'</span></code>) - increase the function space
polynomial order by one globally.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enrichment_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the method for enriching the mesh sequence</p></li>
<li><p><strong>num_enrichments</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – the number of enrichments to apply</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the enriched mesh sequence</p>
</dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>the type is inherited from the parent mesh sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.indicate_errors">
<span class="sig-name descname"><span class="pre">indicate_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enrichment_kwargs={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_kwargs={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicator_fn=&lt;cyfunction</span> <span class="pre">get_dwr_indicator&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/go_mesh_seq.html#GoalOrientedMeshSeq.indicate_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.indicate_errors" title="Link to this definition">¶</a></dt>
<dd><p>Compute goal-oriented error indicators for each subinterval based on solving the
adjoint problem in a globally enriched space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enrichment_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which
may take various types) – keyword arguments to pass to the global enrichment
method - see <a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.get_enriched_mesh_seq" title="goalie.go_mesh_seq.GoalOrientedMeshSeq.get_enriched_mesh_seq"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_enriched_mesh_seq()</span></code></a> for the
supported enrichment methods and options</p></li>
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may
take various types) – parameters for the forward solver, as well as any
parameters for the QoI, which should be included as a sub-dictionary with key
‘qoi_kwargs’</p></li>
<li><p><strong>indicator_fn</strong> – function which maps the form, adjoint error and enriched
space(s) as arguments to the error indicator
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>solution and indicator data objects</p>
</dd>
<dt class="field-odd">Rtype1<span class="colon">:</span></dt>
<dd class="field-odd"><p>:class:<a href="#id5"><span class="problematic" id="id6">`</span></a>~.AdjointSolutionData</p>
</dd>
<dt class="field-even">Rtype2<span class="colon">:</span></dt>
<dd class="field-even"><p>:class:<a href="#id7"><span class="problematic" id="id8">`</span></a>~.IndicatorData</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.go_mesh_seq.GoalOrientedMeshSeq.indicators">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">indicators</span></span><a class="headerlink" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.indicators" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the error indicator data object</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#goalie.function_data.IndicatorData" title="goalie.function_data.IndicatorData"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndicatorData</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-goalie.interpolation">
<span id="goalie-interpolation-module"></span><h2>goalie.interpolation module<a class="headerlink" href="#module-goalie.interpolation" title="Link to this heading">¶</a></h2>
<p>Driver functions for mesh-to-mesh data transfer.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.interpolation.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_space</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/interpolation.html#interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.interpolation.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>A wrapper for <a class="reference internal" href="#goalie.interpolation.transfer" title="goalie.interpolation.transfer"><code class="xref py py-func docutils literal notranslate"><span class="pre">transfer()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">transfer_method=&quot;interpolate&quot;</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.interpolation.project">
<span class="sig-name descname"><span class="pre">project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_space</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/interpolation.html#project"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.interpolation.project" title="Link to this definition">¶</a></dt>
<dd><p>A wrapper for <a class="reference internal" href="#goalie.interpolation.transfer" title="goalie.interpolation.transfer"><code class="xref py py-func docutils literal notranslate"><span class="pre">transfer()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">transfer_method=&quot;interpolate&quot;</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.interpolation.transfer">
<span class="sig-name descname"><span class="pre">transfer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'project'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/interpolation.html#transfer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.interpolation.transfer" title="Link to this definition">¶</a></dt>
<dd><p>Overload functions <code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.__future__.interpolate()</span></code> and
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.projection.project" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.projection.project()</span></code></a> to account for the case of two mixed
function spaces defined on different meshes and for the adjoint interpolation
operator when applied to <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a>s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a>) – the function to be transferred</p></li>
<li><p><strong>target_space</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.FunctionSpace" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.FunctionSpace</span></code></a>,
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a>) – the function space which we seek to transfer onto, or the
function or cofunction to use as the target</p></li>
<li><p><strong>transfer_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – the method to use for the transfer. Options are
“interpolate” (default) and “project”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the transferred function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a></p>
</dd>
</dl>
<dl class="simple">
<dt>Extra keyword arguments are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.__future__.interpolate()</span></code> or</dt><dd><p><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.projection.project" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.projection.project()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.log">
<span id="goalie-log-module"></span><h2>goalie.log module<a class="headerlink" href="#module-goalie.log" title="Link to this heading">¶</a></h2>
<p>Loggers for Goalie.</p>
<p>Code mostly copied from <a class="reference external" href="https://thetisproject.org">the Thetis project</a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.critical">
<span class="sig-name descname"><span class="pre">critical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#critical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.critical" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘CRITICAL’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.critical(“Houston, we have a %s”, “major disaster”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.debug" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘DEBUG’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.debug(“Houston, we have a %s”, “thorny problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.error">
<span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.error" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘ERROR’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.error(“Houston, we have a %s”, “major problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.info" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “interesting problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.pyrint">
<span class="sig-name descname"><span class="pre">pyrint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#goalie.log.pyrint" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “interesting problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.set_log_level">
<span class="sig-name descname"><span class="pre">set_log_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/log.html#set_log_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.set_log_level" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.log.warning">
<span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.log.warning" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘WARNING’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.warning(“Houston, we have a %s”, “bit of a problem”, exc_info=1)</p>
</dd></dl>

</section>
<section id="module-goalie.math">
<span id="goalie-math-module"></span><h2>goalie.math module<a class="headerlink" href="#module-goalie.math" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.math.bessi0">
<span class="sig-name descname"><span class="pre">bessi0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/math.html#bessi0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.math.bessi0" title="Link to this definition">¶</a></dt>
<dd><p>Modified Bessel function of the first kind.</p>
<p>Code taken from <span id="id9">[]</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.math.bessk0">
<span class="sig-name descname"><span class="pre">bessk0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/math.html#bessk0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.math.bessk0" title="Link to this definition">¶</a></dt>
<dd><p>Modified Bessel function of the second kind.</p>
<p>Code taken from <span id="id10">[]</span>.</p>
</dd></dl>

</section>
<section id="module-goalie.mesh_seq">
<span id="goalie-mesh-seq-module"></span><h2>goalie.mesh_seq module<a class="headerlink" href="#module-goalie.mesh_seq" title="Link to this heading">¶</a></h2>
<p>Sequences of meshes corresponding to a <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_meshes</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A sequence of meshes for solving a PDE associated with a particular
<a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> of the temporal domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> (<a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>) – a partition of the temporal domain</p></li>
<li><p><strong>initial_meshes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshGeometry</span></code>) – a list of meshes corresponding to the subinterval of the
time partition, or a single mesh to use for all subintervals</p></li>
<li><p><strong>get_function_spaces</strong> – a function as described in
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_function_spaces" title="goalie.mesh_seq.MeshSeq.get_function_spaces"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_function_spaces()</span></code></a></p></li>
<li><p><strong>get_initial_condition</strong> – a function as described in
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_initial_condition" title="goalie.mesh_seq.MeshSeq.get_initial_condition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_initial_condition()</span></code></a></p></li>
<li><p><strong>get_form</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_form" title="goalie.mesh_seq.MeshSeq.get_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_form()</span></code></a></p></li>
<li><p><strong>get_solver</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_solver" title="goalie.mesh_seq.MeshSeq.get_solver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_solver()</span></code></a></p></li>
<li><p><strong>get_bcs</strong> – a function as described in <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_bcs" title="goalie.mesh_seq.MeshSeq.get_bcs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_bcs()</span></code></a></p></li>
<li><p><strong>transfer_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the method to use for transferring fields between
meshes. Options are “interpolate” (default) and “project”</p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a>) – parameters to apply to the mesh adaptation process</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.bcs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bcs</span></span><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.bcs" title="Link to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_bcs" title="goalie.mesh_seq.MeshSeq.get_bcs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_bcs()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.check_element_count_convergence">
<span class="sig-name descname"><span class="pre">check_element_count_convergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.check_element_count_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.check_element_count_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Check for convergence of the fixed point iteration due to the relative
difference in element count being smaller than the specified tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>an array, whose entries are <code class="docutils literal notranslate"><span class="pre">True</span></code> if convergence is detected on the
corresponding subinterval</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.count_elements">
<span class="sig-name descname"><span class="pre">count_elements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.count_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.count_elements" title="Link to this definition">¶</a></dt>
<dd><p>Count the number of elements in each mesh in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of element counts</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.count_vertices">
<span class="sig-name descname"><span class="pre">count_vertices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.count_vertices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.count_vertices" title="Link to this definition">¶</a></dt>
<dd><p>Count the number of vertices in each mesh in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of vertex counts</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.debug" title="Link to this definition">¶</a></dt>
<dd><p>Print a <code class="docutils literal notranslate"><span class="pre">debug</span></code> message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the message to print</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.fixed_point_iteration">
<span class="sig-name descname"><span class="pre">fixed_point_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adaptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptor_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.fixed_point_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.fixed_point_iteration" title="Link to this definition">¶</a></dt>
<dd><p>Apply mesh adaptation using a fixed point iteration loop approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adaptor</strong> – function for adapting the mesh sequence. Its arguments are the mesh
sequence and the solution data object. It should return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the
convergence criteria checks are to be skipped for this iteration. Otherwise,
it should return <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>update_params</strong> – function for updating <code class="xref py py-attr docutils literal notranslate"><span class="pre">params</span></code> at each
iteration. Its arguments are the parameter class and the fixed point
iteration</p></li>
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may
take various types) – parameters to pass to the solver</p></li>
<li><p><strong>adaptor_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may
take various types) – parameters to pass to the adaptor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>solution data object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#goalie.function_data.ForwardSolutionData" title="goalie.function_data.ForwardSolutionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardSolutionData</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.form">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">form</span></span><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.form" title="Link to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_form" title="goalie.mesh_seq.MeshSeq.get_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_form()</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.function_spaces">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_spaces</span></span><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.function_spaces" title="Link to this definition">¶</a></dt>
<dd><p>Get the function spaces associated with the mesh sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary whose keys are field names and whose values are the
corresponding function spaces</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.FunctionSpace" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.FunctionSpace</span></code></a> values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_bcs">
<span class="sig-name descname"><span class="pre">get_bcs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_bcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_bcs" title="Link to this definition">¶</a></dt>
<dd><p>Get the function mapping a subinterval index to a set of Dirichlet boundary
conditions.</p>
<p>Signature for the function to be returned:
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">:arg</span> <span class="pre">index:</span> <span class="pre">the</span> <span class="pre">subinterval</span> <span class="pre">index</span>
<span class="pre">:type</span> <span class="pre">index:</span> <span class="pre">:class:`int`</span>
<span class="pre">:return:</span> <span class="pre">boundary</span> <span class="pre">conditions</span>
<span class="pre">:rtype:</span> <span class="pre">:class:`~.DirichletBC`</span> <span class="pre">or</span> <span class="pre">:class:`list`</span> <span class="pre">thereof</span>
<span class="pre">:rtype:</span> <span class="pre">see</span> <span class="pre">docstring</span> <span class="pre">above</span>
<span class="pre">`</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the function for obtaining the boundary conditions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_checkpoints">
<span class="sig-name descname"><span class="pre">get_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_final_subinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_checkpoints" title="Link to this definition">¶</a></dt>
<dd><p>Solve forward on the sequence of meshes, extracting checkpoints corresponding
to the starting fields on each subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may
take various types) – parameters for the forward solver</p></li>
<li><p><strong>run_final_subinterval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the solver is run on the final
subinterval</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>checkpoints for each subinterval</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_form">
<span class="sig-name descname"><span class="pre">get_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_form"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_form" title="Link to this definition">¶</a></dt>
<dd><p>Get the function mapping a subinterval index and a solution dictionary to a
dictionary containing parts of the PDE weak form corresponding to each solution
component.</p>
<p>Signature for the function to be returned:
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">:arg</span> <span class="pre">index:</span> <span class="pre">the</span> <span class="pre">subinterval</span> <span class="pre">index</span>
<span class="pre">:type</span> <span class="pre">index:</span> <span class="pre">:class:`int`</span>
<span class="pre">:arg</span> <span class="pre">solutions:</span> <span class="pre">map</span> <span class="pre">from</span> <span class="pre">fields</span> <span class="pre">to</span> <span class="pre">tuples</span> <span class="pre">of</span> <span class="pre">current</span> <span class="pre">and</span> <span class="pre">previous</span> <span class="pre">solutions</span>
<span class="pre">:type</span> <span class="pre">solutions:</span> <span class="pre">:class:`dict`</span> <span class="pre">with</span> <span class="pre">:class:`str`</span> <span class="pre">keys</span> <span class="pre">and</span> <span class="pre">:class:`tuple`</span> <span class="pre">values</span>
<span class="pre">:return:</span> <span class="pre">map</span> <span class="pre">from</span> <span class="pre">fields</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">corresponding</span> <span class="pre">forms</span>
<span class="pre">:rtype:</span> <span class="pre">:class:`dict`</span> <span class="pre">with</span> <span class="pre">:class:`str`</span> <span class="pre">keys</span> <span class="pre">and</span> <span class="pre">:class:`ufl.form.Form`</span> <span class="pre">values</span>
<span class="pre">`</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the function for obtaining the form</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>see docstring above</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_function_spaces">
<span class="sig-name descname"><span class="pre">get_function_spaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_function_spaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_function_spaces" title="Link to this definition">¶</a></dt>
<dd><p>Construct the function spaces corresponding to each field, for a given mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.mesh.MeshGeometry" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.mesh.MeshGeometry</span></code></a>) – the mesh to base the function spaces on</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dictionary whose keys are field names and whose values are the
corresponding function spaces</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.FunctionSpace" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.FunctionSpace</span></code></a> values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_initial_condition">
<span class="sig-name descname"><span class="pre">get_initial_condition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_initial_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_initial_condition" title="Link to this definition">¶</a></dt>
<dd><p>Get the initial conditions applied on the first mesh in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the dictionary, whose keys are field names and whose values are the
corresponding initial conditions applied</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_solve_blocks">
<span class="sig-name descname"><span class="pre">get_solve_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subinterval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_solve_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_solve_blocks" title="Link to this definition">¶</a></dt>
<dd><p>Get all blocks of the tape corresponding to solve steps for prognostic solution
field on a given subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – name of the prognostic solution field</p></li>
<li><p><strong>subinterval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – subinterval index</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of solve blocks</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <code class="xref py py-class docutils literal notranslate"><span class="pre">pyadjoint.block.Block</span></code>s</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.get_solver">
<span class="sig-name descname"><span class="pre">get_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.get_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.get_solver" title="Link to this definition">¶</a></dt>
<dd><p>Get the function mapping a subinterval index and an initial condition dictionary
to a dictionary of solutions for the corresponding solver step.</p>
<p>Signature for the function to be returned:
<a href="#id11"><span class="problematic" id="id12">``</span></a>`
:arg index: the subinterval index
:type index: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>
:arg ic: map from fields to the corresponding initial condition components
:type ic: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and</p>
<blockquote>
<div><p><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> values</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>map from fields to the corresponding solutions</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> values</p>
</dd>
</dl>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the function for obtaining the solver</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>see docstring above</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.info" title="Link to this definition">¶</a></dt>
<dd><p>Print an <code class="docutils literal notranslate"><span class="pre">info</span></code> level message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the message to print</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.initial_condition">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_condition</span></span><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.initial_condition" title="Link to this definition">¶</a></dt>
<dd><p>Get the initial conditions associated with the first subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary whose keys are field names and whose values are the
corresponding initial conditions applied on the first subinterval</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.plot" title="Link to this definition">¶</a></dt>
<dd><p>Plot the meshes comprising a 2D <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code>) – matplotlib figure to use</p></li>
<li><p><strong>axes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes._axes.Axes</span></code>) – matplotlib axes to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib figure and axes for the plots</p>
</dd>
<dt class="field-odd">Rtype1<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.figure.Figure</span></code></p>
</dd>
<dt class="field-even">Rtype2<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes._axes.Axes</span></code></p>
</dd>
</dl>
<p>All keyword arguments are passed to <a class="reference external" href="https://www.firedrakeproject.org/firedrake.pyplot.html#firedrake.pyplot.triplot" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.pyplot.triplot()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.set_meshes">
<span class="sig-name descname"><span class="pre">set_meshes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meshes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.set_meshes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.set_meshes" title="Link to this definition">¶</a></dt>
<dd><p>Set all meshes in the sequence and deduce various properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>meshes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.MeshGeometry</span></code>s or
<code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.MeshGeometry</span></code>) – list of meshes to use in the sequence, or a single mesh to use for
all subintervals</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.solutions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solutions</span></span><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.solutions" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the solution data object</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionData</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.solve_forward">
<span class="sig-name descname"><span class="pre">solve_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.solve_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.solve_forward" title="Link to this definition">¶</a></dt>
<dd><p>Solve a forward problem on a sequence of subintervals.</p>
<p>A dictionary of solution fields is computed - see <a class="reference internal" href="#goalie.function_data.ForwardSolutionData" title="goalie.function_data.ForwardSolutionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardSolutionData</span></code></a>
for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> whose keys are <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>s and whose values
may take various types) – parameters for the forward solver</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the solution data of the forward solves</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#goalie.function_data.ForwardSolutionData" title="goalie.function_data.ForwardSolutionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardSolutionData</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.solver">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solver</span></span><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.solver" title="Link to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_solver" title="goalie.mesh_seq.MeshSeq.get_solver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_solver()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="goalie.mesh_seq.MeshSeq.warning">
<span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/mesh_seq.html#MeshSeq.warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.mesh_seq.MeshSeq.warning" title="Link to this definition">¶</a></dt>
<dd><p>Print a <code class="docutils literal notranslate"><span class="pre">warning</span></code> message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the message to print</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-goalie.metric">
<span id="goalie-metric-module"></span><h2>goalie.metric module<a class="headerlink" href="#module-goalie.metric" title="Link to this heading">¶</a></h2>
<p>Driver functions for metric-based mesh adaptation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.metric.enforce_variable_constraints">
<span class="sig-name descname"><span class="pre">enforce_variable_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e+30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/metric.html#enforce_variable_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.metric.enforce_variable_constraints" title="Link to this definition">¶</a></dt>
<dd><p>Post-process a list of metrics to enforce minimum and maximum element sizes, as well
as maximum anisotropy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference internal" href="animate.html#animate.metric.RiemannianMetric" title="animate.metric.RiemannianMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetric</span></code></a>s) – the metrics</p></li>
<li><p><strong>h_min</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – minimum tolerated element size</p></li>
<li><p><strong>h_max</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – maximum tolerated element size</p></li>
<li><p><strong>a_max</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – maximum tolerated element anisotropy</p></li>
<li><p><strong>boundary_tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – optional tag to enforce sizes on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.metric.ramp_complexity">
<span class="sig-name descname"><span class="pre">ramp_complexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/metric.html#ramp_complexity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.metric.ramp_complexity" title="Link to this definition">¶</a></dt>
<dd><p>Ramp up the target complexity over the first few iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – the base complexity to start from</p></li>
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – the desired complexity</p></li>
<li><p><strong>iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – the current iteration</p></li>
<li><p><strong>num_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – how many iterations to ramp over?</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the ramped target complexity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.metric.space_time_normalise">
<span class="sig-name descname"><span class="pre">space_time_normalise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict_anisotropy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/metric.html#space_time_normalise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.metric.space_time_normalise" title="Link to this definition">¶</a></dt>
<dd><p>Apply <span class="math notranslate nohighlight">\(L^p\)</span> normalisation in both space and time.</p>
<p>Based on Equation (1) in <span id="id17">[]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference internal" href="animate.html#animate.metric.RiemannianMetric" title="animate.metric.RiemannianMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetric</span></code></a>s) – the metrics associated with each subinterval</p></li>
<li><p><strong>time_partition</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code>) – temporal discretisation for the problem at hand</p></li>
<li><p><strong>metric_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>s or a single <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>
to use for all subintervals) – dictionary containing the target <em>space-time</em> metric
complexity under <cite>dm_plex_metric_target_complexity</cite> and the normalisation order
under <cite>dm_plex_metric_p</cite>, or a list thereof</p></li>
<li><p><strong>global_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – pre-computed global normalisation factor</p></li>
<li><p><strong>boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the normalisation to be performed over the boundary</p></li>
<li><p><strong>restrict_sizes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, minimum and maximum metric magnitudes are
enforced</p></li>
<li><p><strong>restrict_anisotropy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, maximum anisotropy is enforced</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the space-time normalised metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference internal" href="animate.html#animate.metric.RiemannianMetric" title="animate.metric.RiemannianMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetric</span></code></a>s</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.options">
<span id="goalie-options-module"></span><h2>goalie.options module<a class="headerlink" href="#module-goalie.options" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.options.AdaptParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AdaptParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#AdaptParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.AdaptParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a></p>
<p>A class for holding parameters associated with adaptive mesh fixed point iteration
loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may take
various types) – parameters to set</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.options.GoalOrientedMetricParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GoalOrientedMetricParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#GoalOrientedMetricParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.GoalOrientedMetricParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.options.GoalOrientedParameters" title="goalie.options.GoalOrientedParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">GoalOrientedParameters</span></code></a>, <a class="reference internal" href="#goalie.options.MetricParameters" title="goalie.options.MetricParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetricParameters</span></code></a></p>
<p>A class for holding parameters associated with
metric-based, goal-oriented adaptive mesh fixed
point iteration loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may take
various types) – parameters to set</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.options.GoalOrientedParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GoalOrientedParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#GoalOrientedParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.GoalOrientedParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a></p>
<p>A class for holding parameters associated with
goal-oriented adaptive mesh fixed point iteration
loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may take
various types) – parameters to set</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.options.MetricParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MetricParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#MetricParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.MetricParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a></p>
<p>A class for holding parameters associated with
metric-based adaptive mesh fixed point iteration loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> keys and values which may take
various types) – parameters to set</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.options.MetricParameters.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/options.html#MetricParameters.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.options.MetricParameters.export" title="Link to this definition">¶</a></dt>
<dd><p>Set parameters appropriate to a given <code class="xref py py-class docutils literal notranslate"><span class="pre">RiemannianMetric</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metric</strong> (<a class="reference internal" href="animate.html#animate.metric.RiemannianMetric" title="animate.metric.RiemannianMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">animate.metric.RiemannianMetric</span></code></a>) – the metric to apply parameters to</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-goalie.plot">
<span id="goalie-plot-module"></span><h2>goalie.plot module<a class="headerlink" href="#module-goalie.plot" title="Link to this heading">¶</a></h2>
<p>Driver functions for plotting solution data.</p>
<dl class="py function">
<dt class="sig sig-object py" id="goalie.plot.plot_indicator_snapshots">
<span class="sig-name descname"><span class="pre">plot_indicator_snapshots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indicators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/plot.html#plot_indicator_snapshots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.plot.plot_indicator_snapshots" title="Link to this definition">¶</a></dt>
<dd><p>Plot a sequence of snapshots associated with
<code class="docutils literal notranslate"><span class="pre">indicators</span></code> and a given <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a></p>
<p>Any keyword arguments are passed to
<code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.plot.tricontourf()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indicators</strong> – list of list of indicators,
indexed by mesh sequence index, then timestep</p></li>
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>
object used to solve the problem</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.plot.plot_snapshots">
<span class="sig-name descname"><span class="pre">plot_snapshots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/plot.html#plot_snapshots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.plot.plot_snapshots" title="Link to this definition">¶</a></dt>
<dd><p>Plot a sequence of snapshots associated with
<code class="docutils literal notranslate"><span class="pre">solutions.field.label</span></code> and a given
<a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>.</p>
<p>Any keyword arguments are passed to
<code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.plot.tricontourf()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solutions</strong> – <a class="reference internal" href="#goalie.utility.AttrDict" title="goalie.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> of solutions
computed by solving a forward or adjoint
problem</p></li>
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>
object used to solve the problem</p></li>
<li><p><strong>field</strong> – solution field of choice</p></li>
<li><p><strong>label</strong> – choose from <code class="docutils literal notranslate"><span class="pre">'forward'</span></code>, <code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>
<code class="docutils literal notranslate"><span class="pre">'adjoint'</span></code> and <code class="docutils literal notranslate"><span class="pre">'adjoint_next'</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie.point_seq">
<span id="goalie-point-seq-module"></span><h2>goalie.point_seq module<a class="headerlink" href="#module-goalie.point_seq" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.point_seq.PointSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PointSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/point_seq.html#PointSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.point_seq.PointSeq" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a></p>
<p>A simplified subset of <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a> for ODE problems.</p>
<p>In this version, a single mesh comprised of a single vertex is shared across all
subintervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> – the <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> which partitions the temporal
domain</p></li>
<li><p><strong>get_function_spaces</strong> – a function, whose only argument is a
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which constructs prognostic
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.FunctionSpace" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.FunctionSpace</span></code></a>s for each subinterval</p></li>
<li><p><strong>get_initial_condition</strong> – a function, whose only argument is a
<a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which specifies initial conditions on the first mesh</p></li>
<li><p><strong>get_form</strong> – a function, whose only argument is a <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which
returns a function that generates the ODE weak form</p></li>
<li><p><strong>get_solver</strong> – a function, whose only argument is a <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>,
which returns a function that integrates initial data over a subinterval</p></li>
<li><p><strong>get_bcs</strong> – a function, whose only argument is a <a class="reference internal" href="#goalie.mesh_seq.MeshSeq" title="goalie.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which
returns a function that determines any Dirichlet boundary conditions</p></li>
<li><p><strong>parameters</strong> – <a class="reference internal" href="#goalie.options.AdaptParameters" title="goalie.options.AdaptParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a> instance</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.point_seq.PointSeq.set_meshes">
<span class="sig-name descname"><span class="pre">set_meshes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/point_seq.html#PointSeq.set_meshes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.point_seq.PointSeq.set_meshes" title="Link to this definition">¶</a></dt>
<dd><p>Update the mesh associated with the <a class="reference internal" href="#goalie.point_seq.PointSeq" title="goalie.point_seq.PointSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">PointSeq</span></code></a>, as well as the
associated attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh</strong> – the vertex-only mesh</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-goalie.time_partition">
<span id="goalie-time-partition-module"></span><h2>goalie.time_partition module<a class="headerlink" href="#module-goalie.time_partition" title="Link to this heading">¶</a></h2>
<p>Partitioning for the temporal domain.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.time_partition.TimeInstant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TimeInstant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/time_partition.html#TimeInstant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.time_partition.TimeInstant" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.time_partition.TimeInterval" title="goalie.time_partition.TimeInterval"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeInterval</span></code></a></p>
<p>A <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> for steady-state problems.</p>
<p>Under the hood this means dividing <span class="math notranslate nohighlight">\([0,1)\)</span> into a single timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – end time of the interval of interest</p></li>
<li><p><strong>num_subintervals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of subintervals in the partition</p></li>
<li><p><strong>timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – a list timesteps to be used on each subinterval, or a single
timestep to use for all subintervals</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the list of field names to consider</p></li>
<li><p><strong>num_timesteps_per_export</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of :class`int`s or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – a list of numbers of timesteps per export for
each subinterval, or a single number to use for all subintervals</p></li>
<li><p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – start time of the interval of interest</p></li>
<li><p><strong>subinterals</strong> – sequence of subintervals (which need not be of uniform
length), or <code class="docutils literal notranslate"><span class="pre">None</span></code> to use uniform subintervals (the default)</p></li>
<li><p><strong>field_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – a list of strings indicating whether each field is
‘unsteady’ or ‘steady’, i.e., does the corresponding equation involve time
derivatives or not?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.time_partition.TimeInterval">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TimeInterval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/time_partition.html#TimeInterval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.time_partition.TimeInterval" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a></p>
<p>A trivial <a class="reference internal" href="#goalie.time_partition.TimePartition" title="goalie.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a> with a single subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – end time of the interval of interest</p></li>
<li><p><strong>num_subintervals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of subintervals in the partition</p></li>
<li><p><strong>timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – a list timesteps to be used on each subinterval, or a single
timestep to use for all subintervals</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the list of field names to consider</p></li>
<li><p><strong>num_timesteps_per_export</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of :class`int`s or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – a list of numbers of timesteps per export for
each subinterval, or a single number to use for all subintervals</p></li>
<li><p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – start time of the interval of interest</p></li>
<li><p><strong>subinterals</strong> – sequence of subintervals (which need not be of uniform
length), or <code class="docutils literal notranslate"><span class="pre">None</span></code> to use uniform subintervals (the default)</p></li>
<li><p><strong>field_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – a list of strings indicating whether each field is
‘unsteady’ or ‘steady’, i.e., does the corresponding equation involve time
derivatives or not?</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="goalie.time_partition.TimeInterval.timestep">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">timestep</span></span><a class="headerlink" href="#goalie.time_partition.TimeInterval.timestep" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the timestep used on the single interval</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.time_partition.TimePartition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TimePartition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_subintervals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_timesteps_per_export</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subintervals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/time_partition.html#TimePartition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.time_partition.TimePartition" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A partition of the time interval of interest into subintervals.</p>
<p>The subintervals are assumed to be uniform in length. However, different timestep
values may be used on each subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – end time of the interval of interest</p></li>
<li><p><strong>num_subintervals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of subintervals in the partition</p></li>
<li><p><strong>timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – a list timesteps to be used on each subinterval, or a single
timestep to use for all subintervals</p></li>
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the list of field names to consider</p></li>
<li><p><strong>num_timesteps_per_export</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of :class`int`s or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – a list of numbers of timesteps per export for
each subinterval, or a single number to use for all subintervals</p></li>
<li><p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – start time of the interval of interest</p></li>
<li><p><strong>subinterals</strong> – sequence of subintervals (which need not be of uniform
length), or <code class="docutils literal notranslate"><span class="pre">None</span></code> to use uniform subintervals (the default)</p></li>
<li><p><strong>field_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>s or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – a list of strings indicating whether each field is
‘unsteady’ or ‘steady’, i.e., does the corresponding equation involve time
derivatives or not?</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="goalie.time_partition.TimePartition.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/time_partition.html#TimePartition.debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.time_partition.TimePartition.debug" title="Link to this definition">¶</a></dt>
<dd><p>Print attribute ‘msg’ for debugging purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>attr</strong> – the attribute to display debugging information for</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="goalie.time_partition.TimePartition.num_timesteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_timesteps</span></span><a class="headerlink" href="#goalie.time_partition.TimePartition.num_timesteps" title="Link to this definition">¶</a></dt>
<dd><p>:returns the total number of timesteps
:rtype: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd></dl>

</dd></dl>

</section>
<section id="module-goalie.utility">
<span id="goalie-utility-module"></span><h2>goalie.utility module<a class="headerlink" href="#module-goalie.utility" title="Link to this heading">¶</a></h2>
<p>Utility functions and classes for mesh adaptation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="goalie.utility.AttrDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AttrDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#AttrDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.AttrDict" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Dictionary that provides both <code class="docutils literal notranslate"><span class="pre">self[key]</span></code> and <code class="docutils literal notranslate"><span class="pre">self.key</span></code> access to members.</p>
<p><strong>Disclaimer</strong>: Copied from <a class="reference external" href="http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python">stackoverflow</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.Mesh">
<span class="sig-name descname"><span class="pre">Mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#Mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.Mesh" title="Link to this definition">¶</a></dt>
<dd><p>Overload <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.mesh.Mesh" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.mesh.Mesh()</span></code></a> to endow the output mesh with useful quantities.</p>
<dl class="simple">
<dt>The following quantities are computed by default:</dt><dd><ul class="simple">
<li><p>cell size;</p></li>
<li><p>facet area.</p></li>
</ul>
</dd>
</dl>
<p>The argument and keyword arguments are passed to Firedrake’s
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.mesh.Mesh" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.mesh.Mesh()</span></code></a> constructor, modified so that the argument could also be
a mesh.</p>
<p>Arguments and keyword arguments are the same as for <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.mesh.Mesh" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.mesh.Mesh()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the constructed mesh</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.mesh.MeshGeometry" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.mesh.MeshGeometry</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="goalie.utility.VTKFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">VTKFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#VTKFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.VTKFile" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://www.firedrakeproject.org/firedrake.output.html#firedrake.output.vtk_output.VTKFile" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">VTKFile</span></code></a></p>
<p>Overload <code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.output.VTKFile</span></code> so that it uses <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> mode by
default.</p>
<p>Whilst this means that the mesh topology is recomputed at every export, it removes
any need for the user to reset it manually.</p>
<p>Create an object for outputting data for visualisation.</p>
<p>This produces output in VTU format, suitable for visualisation
with Paraview or other VTK-capable visualisation packages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – The name of the output file (must end in
<code class="docutils literal notranslate"><span class="pre">.pvd</span></code>).</p></li>
<li><p><strong>project_output</strong> – Should the output be projected to
a computed output space?  Default is to use interpolation.</p></li>
<li><p><strong>comm</strong> – The MPI communicator to use.</p></li>
<li><p><strong>mode</strong> – “w” to overwrite any existing file, “a” to append to an existing file.</p></li>
<li><p><strong>target_degree</strong> – override the degree of the output space.</p></li>
<li><p><strong>target_continuity</strong> – override the continuity of the output space;
A UFL <code class="xref py py-class docutils literal notranslate"><span class="pre">ufl.sobolevspace.SobolevSpace</span></code> object: <cite>H1</cite> for a
continuous output and <cite>L2</cite> for a discontinuous output.</p></li>
<li><p><strong>adaptive</strong> – allow different meshes at different exports if <cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Visualisation is only possible for Lagrange fields (either
continuous or discontinuous).  All other fields are first
either projected or interpolated to Lagrange elements
before storing for visualisation purposes.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.assemble_mass_matrix">
<span class="sig-name descname"><span class="pre">assemble_mass_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#assemble_mass_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.assemble_mass_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Assemble a mass matrix associated with some finite element space and norm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.functionspaceimpl.FunctionSpace" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.functionspaceimpl.FunctionSpace</span></code></a>) – function space to build the mass matrix with</p></li>
<li><p><strong>norm_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the type norm to build the mass matrix with</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the corresponding mass matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>petsc4py.PETSc.Mat</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.cofunction2function">
<span class="sig-name descname"><span class="pre">cofunction2function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cofunc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#cofunction2function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.cofunction2function" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cofunc</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a>) – a cofunction</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a function with the same underyling data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.create_directory">
<span class="sig-name descname"><span class="pre">create_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#create_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.create_directory" title="Link to this definition">¶</a></dt>
<dd><p>Create a directory on disk.</p>
<p><strong>Disclaimer</strong>: Code copied from <a class="reference external" href="https://thetisproject.org">Thetis</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – path to the directory</p></li>
<li><p><strong>comm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">mpi4py.MPI.Intracomm</span></code>) – MPI communicator</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the path in absolute form</p>
</dd>
<dt class="field-odd">Rtype path<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.effectivity_index">
<span class="sig-name descname"><span class="pre">effectivity_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_indicator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Je</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#effectivity_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.effectivity_index" title="Link to this definition">¶</a></dt>
<dd><p>Compute the overestimation factor of some error estimator for the QoI error.</p>
<p>Note that this is only typically used for simple steady-state problems with
analytical solutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error_indicator</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>) – a <span class="math notranslate nohighlight">\(\mathbb P0\)</span> error indicator which localises
contributions to an error estimator to individual elements</p></li>
<li><p><strong>Je</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – the error in the quantity of interest</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the effectivity index</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.errornorm">
<span class="sig-name descname"><span class="pre">errornorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#errornorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.errornorm" title="Link to this definition">¶</a></dt>
<dd><p>Overload <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.norms.errornorm" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.norms.errornorm()</span></code></a> to allow for <span class="math notranslate nohighlight">\(\ell^p\)</span> norms.</p>
<p>Currently supported <code class="docutils literal notranslate"><span class="pre">norm_type</span></code> options:
* <code class="docutils literal notranslate"><span class="pre">'l1'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'l2'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'linf'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'L2'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'Linf'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'H1'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'Hdiv'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'Hcurl'</span></code>
* or any <code class="docutils literal notranslate"><span class="pre">'Lp'</span></code> with <span class="math notranslate nohighlight">\(p &gt;= 1\)</span>.</p>
<p>Note that this version is case sensitive, i.e. <code class="docutils literal notranslate"><span class="pre">'l2'</span></code> and <code class="docutils literal notranslate"><span class="pre">'L2'</span></code> will give
different results in general.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a>) – the ‘true’ value</p></li>
<li><p><strong>uh</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a>) – the approximation of the ‘truth’</p></li>
<li><p><strong>norm_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the type of norm to use</p></li>
<li><p><strong>boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the norm is computed over the domain boundary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the error norm value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
<p>Any other keyword arguments are passed to <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.norms.errornorm" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.norms.errornorm()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.function2cofunction">
<span class="sig-name descname"><span class="pre">function2cofunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#function2cofunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.function2cofunction" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a>) – a function</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a cofunction with the same underlying data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="goalie.utility.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/goalie/utility.html#norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#goalie.utility.norm" title="Link to this definition">¶</a></dt>
<dd><p>Overload <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.norms.norm" title="(in Firedrake v0.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">firedrake.norms.norm()</span></code></a> to allow for <span class="math notranslate nohighlight">\(\ell^p\)</span> norms.</p>
<p>Currently supported <code class="docutils literal notranslate"><span class="pre">norm_type</span></code> options:
* <code class="docutils literal notranslate"><span class="pre">'l1'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'l2'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'linf'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'L2'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'Linf'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'H1'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'Hdiv'</span></code>
* <code class="docutils literal notranslate"><span class="pre">'Hcurl'</span></code>
* or any <code class="docutils literal notranslate"><span class="pre">'Lp'</span></code> with <span class="math notranslate nohighlight">\(p &gt;= 1\)</span>.</p>
<p>Note that this version is case sensitive, i.e. <code class="docutils literal notranslate"><span class="pre">'l2'</span></code> and <code class="docutils literal notranslate"><span class="pre">'L2'</span></code> will give
different results in general.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.function.Function</span></code></a> or
<a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.cofunction.Cofunction" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.cofunction.Cofunction</span></code></a>) – the function to take the norm of</p></li>
<li><p><strong>norm_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – the type of norm to use</p></li>
<li><p><strong>condition</strong> – a UFL condition for specifying a subdomain to compute the norm
over</p></li>
<li><p><strong>boundary</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the norm is computed over the domain boundary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the norm value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-goalie">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-goalie" title="Link to this heading">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">goalie package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-goalie.adjoint">goalie.adjoint module</a><ul>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a><ul>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.check_qoi_convergence"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.check_qoi_convergence()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_checkpoints"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.get_checkpoints()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_qoi"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.get_qoi()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.get_solve_blocks"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.get_solve_blocks()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.initial_condition"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.initial_condition</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.solve_adjoint"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.solve_adjoint()</span></code></a></li>
<li><a class="reference internal" href="#goalie.adjoint.AdjointMeshSeq.th"><code class="docutils literal notranslate"><span class="pre">AdjointMeshSeq.th()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#goalie.adjoint.annotate_qoi"><code class="docutils literal notranslate"><span class="pre">annotate_qoi()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.error_estimation">goalie.error_estimation module</a><ul>
<li><a class="reference internal" href="#goalie.error_estimation.get_dwr_indicator"><code class="docutils literal notranslate"><span class="pre">get_dwr_indicator()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.function_data">goalie.function_data module</a><ul>
<li><a class="reference internal" href="#goalie.function_data.AdjointSolutionData"><code class="docutils literal notranslate"><span class="pre">AdjointSolutionData</span></code></a></li>
<li><a class="reference internal" href="#goalie.function_data.ForwardSolutionData"><code class="docutils literal notranslate"><span class="pre">ForwardSolutionData</span></code></a></li>
<li><a class="reference internal" href="#goalie.function_data.IndicatorData"><code class="docutils literal notranslate"><span class="pre">IndicatorData</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.go_mesh_seq">goalie.go_mesh_seq module</a><ul>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq</span></code></a><ul>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.check_estimator_convergence"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.check_estimator_convergence()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.error_estimate"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.error_estimate()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.fixed_point_iteration"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.fixed_point_iteration()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.get_enriched_mesh_seq"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.get_enriched_mesh_seq()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.indicate_errors"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.indicate_errors()</span></code></a></li>
<li><a class="reference internal" href="#goalie.go_mesh_seq.GoalOrientedMeshSeq.indicators"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMeshSeq.indicators</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.interpolation">goalie.interpolation module</a><ul>
<li><a class="reference internal" href="#goalie.interpolation.interpolate"><code class="docutils literal notranslate"><span class="pre">interpolate()</span></code></a></li>
<li><a class="reference internal" href="#goalie.interpolation.project"><code class="docutils literal notranslate"><span class="pre">project()</span></code></a></li>
<li><a class="reference internal" href="#goalie.interpolation.transfer"><code class="docutils literal notranslate"><span class="pre">transfer()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.log">goalie.log module</a><ul>
<li><a class="reference internal" href="#goalie.log.critical"><code class="docutils literal notranslate"><span class="pre">critical()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.debug"><code class="docutils literal notranslate"><span class="pre">debug()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.error"><code class="docutils literal notranslate"><span class="pre">error()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.info"><code class="docutils literal notranslate"><span class="pre">info()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.pyrint"><code class="docutils literal notranslate"><span class="pre">pyrint()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.set_log_level"><code class="docutils literal notranslate"><span class="pre">set_log_level()</span></code></a></li>
<li><a class="reference internal" href="#goalie.log.warning"><code class="docutils literal notranslate"><span class="pre">warning()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.math">goalie.math module</a><ul>
<li><a class="reference internal" href="#goalie.math.bessi0"><code class="docutils literal notranslate"><span class="pre">bessi0()</span></code></a></li>
<li><a class="reference internal" href="#goalie.math.bessk0"><code class="docutils literal notranslate"><span class="pre">bessk0()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.mesh_seq">goalie.mesh_seq module</a><ul>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq"><code class="docutils literal notranslate"><span class="pre">MeshSeq</span></code></a><ul>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.bcs"><code class="docutils literal notranslate"><span class="pre">MeshSeq.bcs</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.check_element_count_convergence"><code class="docutils literal notranslate"><span class="pre">MeshSeq.check_element_count_convergence()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.count_elements"><code class="docutils literal notranslate"><span class="pre">MeshSeq.count_elements()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.count_vertices"><code class="docutils literal notranslate"><span class="pre">MeshSeq.count_vertices()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.debug"><code class="docutils literal notranslate"><span class="pre">MeshSeq.debug()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.fixed_point_iteration"><code class="docutils literal notranslate"><span class="pre">MeshSeq.fixed_point_iteration()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.form"><code class="docutils literal notranslate"><span class="pre">MeshSeq.form</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.function_spaces"><code class="docutils literal notranslate"><span class="pre">MeshSeq.function_spaces</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_bcs"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_bcs()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_checkpoints"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_checkpoints()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_form"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_form()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_function_spaces"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_function_spaces()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_initial_condition"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_initial_condition()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_solve_blocks"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_solve_blocks()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.get_solver"><code class="docutils literal notranslate"><span class="pre">MeshSeq.get_solver()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.info"><code class="docutils literal notranslate"><span class="pre">MeshSeq.info()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.initial_condition"><code class="docutils literal notranslate"><span class="pre">MeshSeq.initial_condition</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.plot"><code class="docutils literal notranslate"><span class="pre">MeshSeq.plot()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.set_meshes"><code class="docutils literal notranslate"><span class="pre">MeshSeq.set_meshes()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.solutions"><code class="docutils literal notranslate"><span class="pre">MeshSeq.solutions</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.solve_forward"><code class="docutils literal notranslate"><span class="pre">MeshSeq.solve_forward()</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.solver"><code class="docutils literal notranslate"><span class="pre">MeshSeq.solver</span></code></a></li>
<li><a class="reference internal" href="#goalie.mesh_seq.MeshSeq.warning"><code class="docutils literal notranslate"><span class="pre">MeshSeq.warning()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.metric">goalie.metric module</a><ul>
<li><a class="reference internal" href="#goalie.metric.enforce_variable_constraints"><code class="docutils literal notranslate"><span class="pre">enforce_variable_constraints()</span></code></a></li>
<li><a class="reference internal" href="#goalie.metric.ramp_complexity"><code class="docutils literal notranslate"><span class="pre">ramp_complexity()</span></code></a></li>
<li><a class="reference internal" href="#goalie.metric.space_time_normalise"><code class="docutils literal notranslate"><span class="pre">space_time_normalise()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.options">goalie.options module</a><ul>
<li><a class="reference internal" href="#goalie.options.AdaptParameters"><code class="docutils literal notranslate"><span class="pre">AdaptParameters</span></code></a></li>
<li><a class="reference internal" href="#goalie.options.GoalOrientedMetricParameters"><code class="docutils literal notranslate"><span class="pre">GoalOrientedMetricParameters</span></code></a></li>
<li><a class="reference internal" href="#goalie.options.GoalOrientedParameters"><code class="docutils literal notranslate"><span class="pre">GoalOrientedParameters</span></code></a></li>
<li><a class="reference internal" href="#goalie.options.MetricParameters"><code class="docutils literal notranslate"><span class="pre">MetricParameters</span></code></a><ul>
<li><a class="reference internal" href="#goalie.options.MetricParameters.export"><code class="docutils literal notranslate"><span class="pre">MetricParameters.export()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.plot">goalie.plot module</a><ul>
<li><a class="reference internal" href="#goalie.plot.plot_indicator_snapshots"><code class="docutils literal notranslate"><span class="pre">plot_indicator_snapshots()</span></code></a></li>
<li><a class="reference internal" href="#goalie.plot.plot_snapshots"><code class="docutils literal notranslate"><span class="pre">plot_snapshots()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.point_seq">goalie.point_seq module</a><ul>
<li><a class="reference internal" href="#goalie.point_seq.PointSeq"><code class="docutils literal notranslate"><span class="pre">PointSeq</span></code></a><ul>
<li><a class="reference internal" href="#goalie.point_seq.PointSeq.set_meshes"><code class="docutils literal notranslate"><span class="pre">PointSeq.set_meshes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.time_partition">goalie.time_partition module</a><ul>
<li><a class="reference internal" href="#goalie.time_partition.TimeInstant"><code class="docutils literal notranslate"><span class="pre">TimeInstant</span></code></a></li>
<li><a class="reference internal" href="#goalie.time_partition.TimeInterval"><code class="docutils literal notranslate"><span class="pre">TimeInterval</span></code></a><ul>
<li><a class="reference internal" href="#goalie.time_partition.TimeInterval.timestep"><code class="docutils literal notranslate"><span class="pre">TimeInterval.timestep</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#goalie.time_partition.TimePartition"><code class="docutils literal notranslate"><span class="pre">TimePartition</span></code></a><ul>
<li><a class="reference internal" href="#goalie.time_partition.TimePartition.debug"><code class="docutils literal notranslate"><span class="pre">TimePartition.debug()</span></code></a></li>
<li><a class="reference internal" href="#goalie.time_partition.TimePartition.num_timesteps"><code class="docutils literal notranslate"><span class="pre">TimePartition.num_timesteps</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie.utility">goalie.utility module</a><ul>
<li><a class="reference internal" href="#goalie.utility.AttrDict"><code class="docutils literal notranslate"><span class="pre">AttrDict</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.Mesh"><code class="docutils literal notranslate"><span class="pre">Mesh()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.VTKFile"><code class="docutils literal notranslate"><span class="pre">VTKFile</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.assemble_mass_matrix"><code class="docutils literal notranslate"><span class="pre">assemble_mass_matrix()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.cofunction2function"><code class="docutils literal notranslate"><span class="pre">cofunction2function()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.create_directory"><code class="docutils literal notranslate"><span class="pre">create_directory()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.effectivity_index"><code class="docutils literal notranslate"><span class="pre">effectivity_index()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.errornorm"><code class="docutils literal notranslate"><span class="pre">errornorm()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.function2cofunction"><code class="docutils literal notranslate"><span class="pre">function2cofunction()</span></code></a></li>
<li><a class="reference internal" href="#goalie.utility.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-goalie">Module contents</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/goalie.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Animate, Movement and Goalie 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">goalie package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2021-2024, Joseph G. Wallwork et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>