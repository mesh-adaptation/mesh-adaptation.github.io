
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>pyroteus package &#8212; Pyroteus 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyroteus 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pyroteus package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="pyroteus-package">
<h1>pyroteus package<a class="headerlink" href="#pyroteus-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-pyroteus.adjoint">
<span id="pyroteus-adjoint-module"></span><h2>pyroteus.adjoint module<a class="headerlink" href="#module-pyroteus.adjoint" title="Permalink to this headline">¶</a></h2>
<p>Drivers for solving adjoint problems on sequences of meshes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyroteus.adjoint.AdjointMeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyroteus.adjoint.</span></span><span class="sig-name descname"><span class="pre">AdjointMeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_meshes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_function_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_initial_condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_qoi</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/adjoint.html#AdjointMeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.adjoint.AdjointMeshSeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyroteus.mesh_seq.MeshSeq" title="pyroteus.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyroteus.mesh_seq.MeshSeq</span></code></a></p>
<p>An extension of <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code> to account for
solving adjoint problems on a sequence of meshes.</p>
<p>For time-dependent quantities of interest, the
solver should access and modify <code class="xref py py-attr docutils literal notranslate"><span class="pre">J</span></code>, which
holds the QoI value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>get_qoi</strong> – a function, with two arguments,
a <a class="reference internal" href="#pyroteus.adjoint.AdjointMeshSeq" title="pyroteus.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a>, which returns
a function of either one or two variables,
corresponding to either an end time or time
integrated quantity of interest, respectively,
as well as an index for the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.adjoint.AdjointMeshSeq.get_checkpoints">
<span class="sig-name descname"><span class="pre">get_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_final_subinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/adjoint.html#AdjointMeshSeq.get_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.adjoint.AdjointMeshSeq.get_checkpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve forward on the sequence of meshes,
extracting checkpoints corresponding to
the starting fields on each subinterval.</p>
<p>The QoI is also evaluated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> – additional keyword
arguments which will be passed to
the solver</p></li>
<li><p><strong>run_final_subinterval</strong> – toggle
whether to solve the PDE on the
final subinterval</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.adjoint.AdjointMeshSeq.get_qoi">
<span class="sig-name descname"><span class="pre">get_qoi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/adjoint.html#AdjointMeshSeq.get_qoi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.adjoint.AdjointMeshSeq.get_qoi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyroteus.adjoint.AdjointMeshSeq.initial_condition">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_condition</span></span><a class="headerlink" href="#pyroteus.adjoint.AdjointMeshSeq.initial_condition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.adjoint.AdjointMeshSeq.solve_adjoint">
<span class="sig-name descname"><span class="pre">solve_adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_adj_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_checkpoint_qoi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/adjoint.html#AdjointMeshSeq.solve_adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.adjoint.AdjointMeshSeq.solve_adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve an adjoint problem on a sequence of subintervals.</p>
<p>As well as the quantity of interest value, a dictionary
of solution fields is computed, the contents of which
give values at all exported timesteps, indexed first by
the field label and then by type. The contents of these
nested dictionaries are lists which are indexed first by
subinterval and then by export. For a given exported
timestep, the solution types are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'forward'</span></code>: the forward solution after taking the</dt><dd><p>timestep;</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>: the forward solution before taking</dt><dd><p>the timestep;</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'adjoint'</span></code>: the adjoint solution after taking the</dt><dd><p>timestep;</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'adjoint_next'</span></code>: the adjoint solution before taking</dt><dd><p>the timestep (backwards).</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> – a dictionary providing parameters
to the solver. Any keyword arguments for the QoI
should be included as a subdict with label ‘qoi_kwargs’</p></li>
<li><p><strong>adj_solver_kwargs</strong> – a dictionary providing parameters
to the adjoint solver.</p></li>
<li><p><strong>get_adj_values</strong> – additionally output adjoint
actions at exported timesteps</p></li>
<li><p><strong>test_checkpoint_qoi</strong> – solve over the final
subinterval when checkpointing so that the QoI
value can be checked across runs</p></li>
</ul>
</dd>
<dt class="field-even">Return solution</dt>
<dd class="field-even"><p>an <code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code> containing
solution fields and their lagged versions.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.adjoint.solve_adjoint">
<span class="sig-prename descclassname"><span class="pre">pyroteus.adjoint.</span></span><span class="sig-name descname"><span class="pre">solve_adjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/adjoint.html#solve_adjoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.adjoint.solve_adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve an adjoint problem on a sequence of subintervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code> which
partitions the temporal domain</p></li>
<li><p><strong>initial_meshes</strong> – list of meshes corresponding to
the subintervals of the <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code>,
or a single mesh to use for all subintervals</p></li>
<li><p><strong>get_function_spaces</strong> – a function, whose only
argument is a <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code>, which constructs
prognostic <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> s for each
subinterval</p></li>
<li><p><strong>get_initial_condition</strong> – a function, whose only
argument is a <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code>, which specifies
initial conditions on the first mesh</p></li>
<li><p><strong>get_solver</strong> – a function, whose only argument is
a <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code>, which returns a function
that integrates initial data over a subinterval</p></li>
<li><p><strong>get_qoi</strong> – a function, with two arguments,
a <a class="reference internal" href="#pyroteus.adjoint.AdjointMeshSeq" title="pyroteus.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code></a>, which returns
a function of either one or two variables,
corresponding to either an end time or time
integrated quantity of interest, respectively,
as well as an index for the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></p></li>
<li><p><strong>warnings</strong> – print warnings?</p></li>
<li><p><strong>solver_kwargs</strong> – a dictionary providing parameters
to the solver. Any keyword arguments for the QoI
should be included as a subdict with label ‘qoi_kwargs’</p></li>
<li><p><strong>get_adj_values</strong> – additionally output adjoint
actions at exported timesteps</p></li>
<li><p><strong>test_checkpoint_qoi</strong> – solve over the final
subinterval when checkpointing so that the QoI
value can be checked across runs</p></li>
</ul>
</dd>
<dt class="field-even">Return solution</dt>
<dd class="field-even"><p>an <code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code> containing
solution fields and their lagged versions.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.error_estimation">
<span id="pyroteus-error-estimation-module"></span><h2>pyroteus.error_estimation module<a class="headerlink" href="#module-pyroteus.error_estimation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.error_estimation.get_dwr_indicator">
<span class="sig-prename descclassname"><span class="pre">pyroteus.error_estimation.</span></span><span class="sig-name descname"><span class="pre">get_dwr_indicator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjoint_error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/error_estimation.html#get_dwr_indicator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.error_estimation.get_dwr_indicator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a dual weighted residual (DWR)
error indicator, given a form and an
approximation of the error in the adjoint
solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>F</strong> – the form</p></li>
<li><p><strong>adjoint_error</strong> – the approximation to
the adjoint error</p></li>
<li><p><strong>test_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code>
that the test function lives in</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.form">
<span id="pyroteus-form-module"></span><h2>pyroteus.form module<a class="headerlink" href="#module-pyroteus.form" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.form.transfer_form">
<span class="sig-prename descclassname"><span class="pre">pyroteus.form.</span></span><span class="sig-name descname"><span class="pre">transfer_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer=&lt;cyfunction</span> <span class="pre">prolong&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_map={}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/form.html#transfer_form"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.form.transfer_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a form defined on some mesh, generate a new form with all
the same components, but transferred onto a different mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>F</strong> – the form to be transferred</p></li>
<li><p><strong>newmesh</strong> – the mesh to transfer the form to</p></li>
<li><p><strong>transfer</strong> – the transfer operator to use</p></li>
<li><p><strong>replace_map</strong> – user-provided replace map</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.go_mesh_seq">
<span id="pyroteus-go-mesh-seq-module"></span><h2>pyroteus.go_mesh_seq module<a class="headerlink" href="#module-pyroteus.go_mesh_seq" title="Permalink to this headline">¶</a></h2>
<p>Drivers for goal-oriented error estimation on sequences of meshes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyroteus.go_mesh_seq.GoalOrientedMeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyroteus.go_mesh_seq.</span></span><span class="sig-name descname"><span class="pre">GoalOrientedMeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_meshes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_function_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_initial_condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_qoi</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/go_mesh_seq.html#GoalOrientedMeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.go_mesh_seq.GoalOrientedMeshSeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyroteus.adjoint.AdjointMeshSeq" title="pyroteus.adjoint.AdjointMeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyroteus.adjoint.AdjointMeshSeq</span></code></a></p>
<p>An extension of <code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code> to account for
goal-oriented problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>get_qoi</strong> – a function, with two arguments,
a <code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code>, which returns
a function of either one or two variables,
corresponding to either an end time or time
integrated quantity of interest, respectively,
as well as an index for the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.go_mesh_seq.GoalOrientedMeshSeq.fixed_point_iteration">
<span class="sig-name descname"><span class="pre">fixed_point_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/go_mesh_seq.html#GoalOrientedMeshSeq.fixed_point_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.go_mesh_seq.GoalOrientedMeshSeq.fixed_point_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply goal-oriented mesh adaptation using
a fixed point iteration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.go_mesh_seq.GoalOrientedMeshSeq.global_enrichment">
<span class="sig-name descname"><span class="pre">global_enrichment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enrichment_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_enrichments_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_enrichments_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/go_mesh_seq.html#GoalOrientedMeshSeq.global_enrichment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.go_mesh_seq.GoalOrientedMeshSeq.global_enrichment" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the forward and adjoint problems
associated with <code class="xref py py-attr docutils literal notranslate"><span class="pre">solver</span></code> in a
sequence of globally enriched spaces.</p>
<p>Currently, global enrichment may be
achieved using one of:
* h-refinement (<code class="docutils literal notranslate"><span class="pre">enrichment_method</span> <span class="pre">=</span> <span class="pre">'h'</span></code>);
* p-refinement (<code class="docutils literal notranslate"><span class="pre">enrichment_method</span> <span class="pre">=</span> <span class="pre">'p'</span></code>);
* hp-refinement (<code class="docutils literal notranslate"><span class="pre">enrichment_method</span> <span class="pre">=</span> <span class="pre">'hp'</span></code>).</p>
<p>The number of refinements in each direction
may be controlled by the keyword arguments
<code class="docutils literal notranslate"><span class="pre">num_enrichments_h</span></code> and <code class="docutils literal notranslate"><span class="pre">num_enrichments_p</span></code>.</p>
<p>Any additional keyword arguments are passed
to the <code class="xref py py-attr docutils literal notranslate"><span class="pre">solve_adjoint</span></code> method of the
enriched <code class="xref py py-class docutils literal notranslate"><span class="pre">AdjointMeshSeq</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyroteus.interpolation">
<span id="pyroteus-interpolation-module"></span><h2>pyroteus.interpolation module<a class="headerlink" href="#module-pyroteus.interpolation" title="Permalink to this headline">¶</a></h2>
<p>Driver functions for mesh-to-mesh data transfer.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.interpolation.clement_interpolant">
<span class="sig-prename descclassname"><span class="pre">pyroteus.interpolation.</span></span><span class="sig-name descname"><span class="pre">clement_interpolant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/interpolation.html#clement_interpolant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.interpolation.clement_interpolant" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Clement interpolant of a <span class="math notranslate nohighlight">\(\mathbb P0\)</span>
source field, i.e. take the volume average over
neighbouring cells at each vertex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – the <span class="math notranslate nohighlight">\(\mathbb P0\)</span> source field</p></li>
<li><p><strong>target_space</strong> – the <span class="math notranslate nohighlight">\(\mathbb P1\)</span> space to
interpolate into</p></li>
</ul>
</dd>
<dt class="field-even">Boundary_tag</dt>
<dd class="field-even"><p>optional boundary tag to compute the
Clement interpolant over.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.interpolation.project">
<span class="sig-prename descclassname"><span class="pre">pyroteus.interpolation.</span></span><span class="sig-name descname"><span class="pre">project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/interpolation.html#project"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.interpolation.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Overload Firedrake’s <code class="docutils literal notranslate"><span class="pre">project</span></code> function to account
for the case of two mixed function spaces defined on
different meshes and for the adjoint projection
operator.</p>
<p>Extra keyword arguments are passed to Firedrake’s
<code class="docutils literal notranslate"><span class="pre">project</span></code> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to be projected</p></li>
<li><p><strong>target_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> which
we seek to project into</p></li>
<li><p><strong>adjoint</strong> – apply the transposed projection
operator?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.log">
<span id="pyroteus-log-module"></span><h2>pyroteus.log module<a class="headerlink" href="#module-pyroteus.log" title="Permalink to this headline">¶</a></h2>
<p>Loggers for Pyroteus.</p>
<p>Code mostly copied from [the Thetis project](<a class="reference external" href="https://thetisproject.org">https://thetisproject.org</a>).</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.log.critical">
<span class="sig-prename descclassname"><span class="pre">pyroteus.log.</span></span><span class="sig-name descname"><span class="pre">critical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#critical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.log.critical" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘CRITICAL’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.critical(“Houston, we have a %s”, “major disaster”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.log.debug">
<span class="sig-prename descclassname"><span class="pre">pyroteus.log.</span></span><span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.log.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘DEBUG’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.debug(“Houston, we have a %s”, “thorny problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.log.error">
<span class="sig-prename descclassname"><span class="pre">pyroteus.log.</span></span><span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.log.error" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘ERROR’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.error(“Houston, we have a %s”, “major problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.log.info">
<span class="sig-prename descclassname"><span class="pre">pyroteus.log.</span></span><span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.log.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “interesting problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.log.pyrint">
<span class="sig-prename descclassname"><span class="pre">pyroteus.log.</span></span><span class="sig-name descname"><span class="pre">pyrint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyroteus.log.pyrint" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “interesting problem”, exc_info=1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.log.set_log_level">
<span class="sig-prename descclassname"><span class="pre">pyroteus.log.</span></span><span class="sig-name descname"><span class="pre">set_log_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/log.html#set_log_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.log.set_log_level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.log.warning">
<span class="sig-prename descclassname"><span class="pre">pyroteus.log.</span></span><span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.log.warning" title="Permalink to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘WARNING’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.warning(“Houston, we have a %s”, “bit of a problem”, exc_info=1)</p>
</dd></dl>

</section>
<section id="module-pyroteus.math">
<span id="pyroteus-math-module"></span><h2>pyroteus.math module<a class="headerlink" href="#module-pyroteus.math" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.math.bessi0">
<span class="sig-prename descclassname"><span class="pre">pyroteus.math.</span></span><span class="sig-name descname"><span class="pre">bessi0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/math.html#bessi0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.math.bessi0" title="Permalink to this definition">¶</a></dt>
<dd><p>Modified Bessel function of the first kind.</p>
<p>Code taken from</p>
<p>[Flannery et al. 1992] B.P. Flannery,
W.H. Press, S.A. Teukolsky, W. Vetterling,
“Numerical recipes in C”, Press Syndicate
of the University of Cambridge, New York
(1992).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.math.bessk0">
<span class="sig-prename descclassname"><span class="pre">pyroteus.math.</span></span><span class="sig-name descname"><span class="pre">bessk0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/math.html#bessk0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.math.bessk0" title="Permalink to this definition">¶</a></dt>
<dd><p>Modified Bessel function of the second kind.</p>
<p>Code taken from</p>
<p>[Flannery et al. 1992] B.P. Flannery,
W.H. Press, S.A. Teukolsky, W. Vetterling,
“Numerical recipes in C”, Press Syndicate
of the University of Cambridge, New York
(1992).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.math.construct_orthonormal_basis">
<span class="sig-prename descclassname"><span class="pre">pyroteus.math.</span></span><span class="sig-name descname"><span class="pre">construct_orthonormal_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/math.html#construct_orthonormal_basis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.math.construct_orthonormal_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting from a single vector in UFL, construct
a set of vectors which are orthonormal w.r.t. it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> – the vector</p></li>
<li><p><strong>dim</strong> – its dimension</p></li>
<li><p><strong>seed</strong> – seed for random number generator</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.math.gram_schmidt">
<span class="sig-prename descclassname"><span class="pre">pyroteus.math.</span></span><span class="sig-name descname"><span class="pre">gram_schmidt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/math.html#gram_schmidt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.math.gram_schmidt" title="Permalink to this definition">¶</a></dt>
<dd><p>Given some vectors, construct an orthogonal basis
using Gram-Schmidt orthogonalisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Args v</dt>
<dd class="field-odd"><p>the vectors to orthogonalise</p>
</dd>
<dt class="field-even">Kwargs normalise</dt>
<dd class="field-even"><p>do we want an orthonormal basis?</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.mesh_seq">
<span id="pyroteus-mesh-seq-module"></span><h2>pyroteus.mesh_seq module<a class="headerlink" href="#module-pyroteus.mesh_seq" title="Permalink to this headline">¶</a></h2>
<p>Sequences of meshes corresponding to a <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyroteus.mesh_seq.</span></span><span class="sig-name descname"><span class="pre">MeshSeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_meshes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_function_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_initial_condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A sequence of meshes for solving a PDE associated
with a particular <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code> of the
temporal domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_partition</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code> which
partitions the temporal domain</p></li>
<li><p><strong>initial_meshes</strong> – list of meshes corresponding to
the subintervals of the <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code>,
or a single mesh to use for all subintervals</p></li>
<li><p><strong>get_function_spaces</strong> – a function, whose only
argument is a <a class="reference internal" href="#pyroteus.mesh_seq.MeshSeq" title="pyroteus.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which constructs
prognostic <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> s for each
subinterval</p></li>
<li><p><strong>get_initial_condition</strong> – a function, whose only
argument is a <a class="reference internal" href="#pyroteus.mesh_seq.MeshSeq" title="pyroteus.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which specifies
initial conditions on the first mesh</p></li>
<li><p><strong>get_solver</strong> – a function, whose only argument is
a <a class="reference internal" href="#pyroteus.mesh_seq.MeshSeq" title="pyroteus.mesh_seq.MeshSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code></a>, which returns a function
that integrates initial data over a subinterval</p></li>
<li><p><strong>warnings</strong> – print warnings?</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.debug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.function_spaces">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_spaces</span></span><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.function_spaces" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.get_checkpoints">
<span class="sig-name descname"><span class="pre">get_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.get_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.get_checkpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve forward on the sequence of meshes,
extracting checkpoints corresponding to
the starting fields on each subinterval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>solver_kwargs</strong> – additional keyword
arguments which will be passed to
the solver</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.get_function_spaces">
<span class="sig-name descname"><span class="pre">get_function_spaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.get_function_spaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.get_function_spaces" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.get_initial_condition">
<span class="sig-name descname"><span class="pre">get_initial_condition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.get_initial_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.get_initial_condition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.get_lagged_dependency_index">
<span class="sig-name descname"><span class="pre">get_lagged_dependency_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subinterval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solve_blocks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.get_lagged_dependency_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.get_lagged_dependency_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dependency index corresponding
to the lagged forward solution for a
solve block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> – field of interest</p></li>
<li><p><strong>subinterval</strong> – subinterval index</p></li>
<li><p><strong>solve_blocks</strong> – list of taped
<code class="xref py py-class docutils literal notranslate"><span class="pre">GenericSolveBlocks</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.get_solve_blocks">
<span class="sig-name descname"><span class="pre">get_solve_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subinterval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_adj_sol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.get_solve_blocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.get_solve_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all blocks of the tape corresponding to
solve steps for prognostic solution <code class="docutils literal notranslate"><span class="pre">field</span></code>
on a given <code class="docutils literal notranslate"><span class="pre">subinterval</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.get_solver">
<span class="sig-name descname"><span class="pre">get_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.get_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.get_solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.initial_condition">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_condition</span></span><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.initial_condition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.solve_forward">
<span class="sig-name descname"><span class="pre">solve_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_tape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.solve_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.solve_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a forward problem on a sequence of subintervals.</p>
<p>A dictionary of solution fields is computed, the contents
of which give values at all exported timesteps, indexed
first by the field label and then by type. The contents
of these nested dictionaries are lists which are indexed
first by subinterval and then by export. For a given
exported timestep, the solution types are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'forward'</span></code>: the forward solution after taking the</dt><dd><p>timestep;</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>: the forward solution before taking</dt><dd><p>the timestep.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_kwargs</strong> – a dictionary providing parameters
to the solver. Any keyword arguments for the QoI
should be included as a subdict with label ‘qoi_kwargs’</p></li>
<li><p><strong>clear_tape</strong> – should the tape be cleared at the end
of an iteration?</p></li>
</ul>
</dd>
<dt class="field-even">Return solution</dt>
<dd class="field-even"><p>an <code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code> containing
solution fields and their lagged versions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.solver">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solver</span></span><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.solver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.mesh_seq.MeshSeq.warning">
<span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/mesh_seq.html#MeshSeq.warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.mesh_seq.MeshSeq.warning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pyroteus.metric">
<span id="pyroteus-metric-module"></span><h2>pyroteus.metric module<a class="headerlink" href="#module-pyroteus.metric" title="Permalink to this headline">¶</a></h2>
<p>Driver functions for metric-based mesh adaptation.</p>
<p class="rubric">References</p>
<p id="id1"><dl class="citation">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id5">CPB13</a></span></dt>
<dd><p>Jaime Carpio, Juan Luis Prieto, and Rodolfo Bermejo. Anisotropic “goal-oriented” mesh adaptivity for elliptic problems. <em>SIAM Journal on Scientific Computing</em>, 35(2):A861–A885, 2013.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id7">LDA10</a></span></dt>
<dd><p>Adrien Loseille, Alain Dervieux, and Frédéric Alauzet. Fully anisotropic goal-oriented mesh adaptation for 3d steady euler equations. <em>Journal of computational physics</em>, 229(8):2866–2897, 2010.</p>
</dd>
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id6">PPP+06</a></span></dt>
<dd><p>PW Power, Christopher C Pain, MD Piggott, Fangxin Fang, Gerard J Gorman, AP Umpleby, Anthony JH Goddard, and IM Navon. Adjoint a posteriori error measures for anisotropic mesh optimisation. <em>Computers &amp; Mathematics with Applications</em>, 52(8-9):1213–1242, 2006.</p>
</dd>
</dl>
</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.anisotropic_metric">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">anisotropic_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_indicator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hessian</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#anisotropic_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.anisotropic_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an element-wise anisotropic metric from some
error indicator, given a Hessian field.</p>
<dl class="simple">
<dt>Two formulations are currently available:</dt><dd><ul class="simple">
<li><p>the element-wise formulation presented
in <span id="id5">[<a class="reference internal" href="#id3" title="Jaime Carpio, Juan Luis Prieto, and Rodolfo Bermejo. Anisotropic “goal-oriented” mesh adaptivity for elliptic problems. SIAM Journal on Scientific Computing, 35(2):A861–A885, 2013.">CPB13</a>]</span>; and</p></li>
<li><p>the vertex-wise formulation presented in
<span id="id6">[<a class="reference internal" href="#id2" title="PW Power, Christopher C Pain, MD Piggott, Fangxin Fang, Gerard J Gorman, AP Umpleby, Anthony JH Goddard, and IM Navon. Adjoint a posteriori error measures for anisotropic mesh optimisation. Computers &amp; Mathematics with Applications, 52(8-9):1213–1242, 2006.">PPP+06</a>]</span>.</p></li>
</ul>
</dd>
</dl>
<p>In both cases, a <span class="math notranslate nohighlight">\(\mathbb P1\)</span> metric is
returned by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error_indicator</strong> – (list of) error indicator(s)</p></li>
<li><p><strong>hessian</strong> – (list of) Hessian(s)</p></li>
<li><p><strong>target_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorFunctionSpace</span></code> in
which the metric will exist</p></li>
<li><p><strong>interpolant</strong> – choose from ‘Clement’, ‘L2’,
‘interpolate’, ‘project’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.assemble_eigendecomposition">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">assemble_eigendecomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evalues</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#assemble_eigendecomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.assemble_eigendecomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Assemble a matrix from its eigenvectors and
eigenvalues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evectors</strong> – eigenvector <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>evalues</strong> – eigenvalue <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the assembled matrix <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.check_spd">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">check_spd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#check_spd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.check_spd" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify that a tensor field is symmetric positive-definite.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> – the tensor field</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.combine_metrics">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">combine_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#combine_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.combine_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a list of metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>average</strong> – combination by averaging or intersection?</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.compute_eigendecomposition">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">compute_eigendecomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#compute_eigendecomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.compute_eigendecomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the eigenvectors and eigenvalues of
a matrix-valued function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> from a
<code class="xref py py-class docutils literal notranslate"><span class="pre">TensorFunctionSpace</span></code></p></li>
<li><p><strong>reorder</strong> – should the eigendecomposition
be reordered in order of <em>descending</em>
eigenvalue magnitude?</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>eigenvector <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>,
eigenvalue <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.density_and_quotients">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">density_and_quotients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#density_and_quotients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.density_and_quotients" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the density and anisotropy quotients from a
metric.</p>
<p>By symmetry, Riemannian metrics admit an orthogonal
eigendecomposition,</p>
<div class="math notranslate nohighlight">
\[\underline{\mathbf M}(\mathbf x)
= \underline{\mathbf V}(\mathbf x)\:
\underline{\boldsymbol\Lambda}(\mathbf x)\:
\underline{\mathbf V}(\mathbf x)^T,\]</div>
<p>at each point <span class="math notranslate nohighlight">\(\mathbf x\in\Omega\)</span>, where
<span class="math notranslate nohighlight">\(\underline{\mathbf V}\)</span> and
<span class="math notranslate nohighlight">\(\underline{\boldsymbol\Sigma}\)</span> are matrices
holding the eigenvectors and eigenvalues, respectively.
By positive-definiteness, entries of
<span class="math notranslate nohighlight">\(\underline{\boldsymbol\Lambda}\)</span> are all positive.</p>
<p>An alternative decomposition,</p>
<div class="math notranslate nohighlight">
\[\underline{\mathbf M}(\mathbf x)
= d(\mathbf x)^\frac2n
\underline{\mathbf V}(\mathbf x)\:
\underline{\mathbf R}(\mathbf x)^{-\frac2n}
\underline{\mathbf V}(\mathbf x)^T\]</div>
<p>can also be deduced, in terms of the <cite>metric density</cite>
and <cite>anisotropy quotients</cite>,</p>
<div class="math notranslate nohighlight">
\[d = \prod_{i=1}^n h_i,\qquad
r_i = \frac{h_i^n}d,\qquad \forall i=1:n,\]</div>
<p>where <span class="math notranslate nohighlight">\(h_i := \frac1{\sqrt{\lambda_i}}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> – the metric to extract density and
quotients from</p></li>
<li><p><strong>reorder</strong> – should the eigendecomposition be
reordered?</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>metric density, anisotropy quotients and
eigenvector matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.determine_metric_complexity">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">determine_metric_complexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H_interior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#determine_metric_complexity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.determine_metric_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve an algebraic problem to obtain coefficients
for the interior and boundary metrics to obtain a
given metric complexity.</p>
<p>See <span id="id7">[<a class="reference internal" href="#id4" title="Adrien Loseille, Alain Dervieux, and Frédéric Alauzet. Fully anisotropic goal-oriented mesh adaptation for 3d steady euler equations. Journal of computational physics, 229(8):2866–2897, 2010.">LDA10</a>]</span> for details. Note that we use a
slightly different formulation here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H_interior</strong> – Hessian component from domain interior</p></li>
<li><p><strong>H_boundary</strong> – Hessian component from domain boundary</p></li>
<li><p><strong>target</strong> – target metric complexity</p></li>
<li><p><strong>p</strong> – normalisation order</p></li>
<li><p><strong>H_interior_scaling</strong> – optional scaling for interior component</p></li>
<li><p><strong>H_boundary_scaling</strong> – optional scaling for boundary component</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.enforce_element_constraints">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">enforce_element_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#enforce_element_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.enforce_element_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Post-process a list of metrics to enforce minimum and
maximum element sizes, as well as maximum anisotropy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> – the metrics</p></li>
<li><p><strong>h_min</strong> – minimum tolerated element size,
which could be a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or a number.</p></li>
<li><p><strong>h_max</strong> – maximum tolerated element size,
which could be a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or a number.</p></li>
<li><p><strong>a_max</strong> – maximum tolerated element anisotropy,
which could be a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or a number.</p></li>
<li><p><strong>boundary_tag</strong> – optional tag to enforce sizes on.</p></li>
<li><p><strong>optimise</strong> – is this a timed run?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.hessian_metric">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">hessian_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hessian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#hessian_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.hessian_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the eigenvalues of a Hessian matrix so
that it is positive-definite.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hessian</strong> – the Hessian matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.isotropic_metric">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">isotropic_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_indicator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Clement'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#isotropic_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.isotropic_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an isotropic metric from some error indicator.</p>
<p>The result is a <span class="math notranslate nohighlight">\(\mathbb P1\)</span> diagonal tensor
field whose entries are projections of the error
indicator in modulus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error_indicator</strong> – the error indicator</p></li>
<li><p><strong>target_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorFunctionSpace</span></code> in
which the metric will exist</p></li>
<li><p><strong>interpolant</strong> – choose from ‘Clement’, ‘L2’,
‘interpolate’, ‘project’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.metric_average">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">metric_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#metric_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.metric_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a list of metrics by averaging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> – the metrics to be combined</p></li>
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code>
the averaged metric should live in</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.metric_complexity">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">metric_complexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#metric_complexity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.metric_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the complexity of a metric.</p>
<p>This is the continuous analogue of the
(discrete) mesh vertex count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>boundary</strong> – compute metric on domain
interior or boundary?</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.metric_exponential">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">metric_exponential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#metric_exponential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.metric_exponential" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix exponential of a metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> – a <span class="math notranslate nohighlight">\(\mathbb P1\)</span> metric <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>its matrix exponential</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.metric_intersection">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">metric_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#metric_intersection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.metric_intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a list of metrics by intersection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> – the metrics to be combined</p></li>
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code>
the intersected metric should live in</p></li>
<li><p><strong>boundary_tag</strong> – optional boundary segment physical
ID for boundary intersection. Otherwise, the
intersection is over the whole domain</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.metric_logarithm">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">metric_logarithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#metric_logarithm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.metric_logarithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix logarithm of a metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> – a <span class="math notranslate nohighlight">\(\mathbb P1\)</span> metric <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>its matrix logarithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.metric_relaxation">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">metric_relaxation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#metric_relaxation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.metric_relaxation" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine a list of metrics with a weighted average.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> – the metrics to be combined</p></li>
<li><p><strong>weights</strong> – a list of weights</p></li>
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code>
the relaxed metric should live in</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.ramp_complexity">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">ramp_complexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#ramp_complexity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.ramp_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>Ramp up the target complexity over the first few iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> – the base complexity to start from</p></li>
<li><p><strong>target</strong> – the desired complexity</p></li>
<li><p><strong>i</strong> – the current iteration</p></li>
<li><p><strong>num_iterations</strong> – how many iterations to ramp over?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.space_normalise">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">space_normalise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#space_normalise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.space_normalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <span class="math notranslate nohighlight">\(L^p\)</span> normalisation in space alone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s corresponding to the
metric to be normalised.</p></li>
<li><p><strong>target</strong> – target metric complexity <em>in space alone</em>.</p></li>
<li><p><strong>p</strong> – normalisation order.</p></li>
<li><p><strong>global_factor</strong> – optional pre-computed global
normalisation factor.</p></li>
<li><p><strong>boundary</strong> – is the normalisation over the domain
boundary?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.metric.space_time_normalise">
<span class="sig-prename descclassname"><span class="pre">pyroteus.metric.</span></span><span class="sig-name descname"><span class="pre">space_time_normalise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/metric.html#space_time_normalise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.metric.space_time_normalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <span class="math notranslate nohighlight">\(L^p\)</span> normalisation in both space and time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> – list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s
corresponding to the metric associated with
each subinterval</p></li>
<li><p><strong>end_time</strong> – end time of simulation</p></li>
<li><p><strong>timesteps</strong> – list of timesteps specified in each
subinterval</p></li>
<li><p><strong>target</strong> – target <em>space-time</em> metric complexity</p></li>
<li><p><strong>p</strong> – normalisation order</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.plot">
<span id="pyroteus-plot-module"></span><h2>pyroteus.plot module<a class="headerlink" href="#module-pyroteus.plot" title="Permalink to this headline">¶</a></h2>
<p>Driver functions for plotting solution data.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.plot.plot_snapshots">
<span class="sig-prename descclassname"><span class="pre">pyroteus.plot.</span></span><span class="sig-name descname"><span class="pre">plot_snapshots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/plot.html#plot_snapshots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.plot.plot_snapshots" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a sequence of snapshots associated with
<code class="docutils literal notranslate"><span class="pre">solutions.field.label</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code>
<code class="docutils literal notranslate"><span class="pre">time_partition</span></code>.</p>
<p>Any keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">tricontourf</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solutions</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code> of solutions
computed by solving a forward or adjoint
problem</p></li>
<li><p><strong>time_partition</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code>
object used to solve the problem</p></li>
<li><p><strong>field</strong> – solution field of choice</p></li>
<li><p><strong>label</strong> – choose from <code class="docutils literal notranslate"><span class="pre">'forward'</span></code>, <code class="docutils literal notranslate"><span class="pre">'forward_old'</span></code>
<code class="docutils literal notranslate"><span class="pre">'adjoint'</span></code> and <code class="docutils literal notranslate"><span class="pre">'adjoint_next'</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.quality">
<span id="pyroteus-quality-module"></span><h2>pyroteus.quality module<a class="headerlink" href="#module-pyroteus.quality" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_areas2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_areas2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_areas2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_areas2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the area of each cell in a 2D triangular mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function areas with
area data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_aspect_ratios2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_aspect_ratios2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_aspect_ratios2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_aspect_ratios2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the aspect ratio of each cell in a 2D triangular mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function aspect_ratios with
aspect ratio data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_aspect_ratios3d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_aspect_ratios3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_aspect_ratios3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_aspect_ratios3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the aspect ratio of each cell in a 3D tetrahedral mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function aspect_ratios with
aspect ratio data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_eskews2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_eskews2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_eskews2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_eskews2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the equiangle skew of each cell in a 2D triangular mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function eskews with equiangle skew
data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_eskews3d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_eskews3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_eskews3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_eskews3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the equiangle skew of each cell in a 3D tetrahedral mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function eskews with equiangle skew
data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_facet_areas">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_facet_areas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_facet_areas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_facet_areas" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute area of each facet of <cite>mesh</cite>.</p>
<p>The facet areas are stored as a HDiv
trace field.</p>
<p>Note that the plus sign is arbitrary
and could equally well be chosen as minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mesh</strong> – the input mesh to do computations on</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function facet_areas with
facet area data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_facet_areas2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_facet_areas2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_facet_areas2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_facet_areas2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the area of each facet in a 2D triangular mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function facet_areas with
facet area data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_facet_areas3d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_facet_areas3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_facet_areas3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_facet_areas3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the area of each facet in a 3D tetrahedral mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function facet_areas with
facet area data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_min_angles2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_min_angles2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_min_angles2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_min_angles2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the minimum angle of each cell in a 2D triangular mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function min_angles with
minimum angle data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_min_angles3d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_min_angles3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_min_angles3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_min_angles3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the minimum angle of each cell in a 3D tetrahedral mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function min_angles with
minimum angle data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_pyop2_kernel">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_pyop2_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_pyop2_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_pyop2_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to easily pass Eigen kernels
to Firedrake via PyOP2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – function name</p></li>
<li><p><strong>dim</strong> – spatial dimension</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_quality_metrics2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_quality_metrics2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_quality_metrics2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_quality_metrics2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a Riemannian metric, M, this function
outputs the value of the Quality metric Q_M based on the
transformation encoded in M.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>M</strong> – the (2 x 2) matrix field representing the metric space transformation</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function metrics with metric data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_quality_metrics3d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_quality_metrics3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_quality_metrics3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_quality_metrics3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a Riemannian metric, M, this function
outputs the value of the Quality metric Q_M based on the
transformation encoded in M.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>M</strong> – the (3 x 3) matrix field representing the metric space transformation</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function metrics with metric data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_scaled_jacobians2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_scaled_jacobians2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_scaled_jacobians2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_scaled_jacobians2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the scaled Jacobian of each cell in a 2D triangular mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function scaled_jacobians with scaled
jacobian data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_scaled_jacobians3d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_scaled_jacobians3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_scaled_jacobians3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_scaled_jacobians3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the scaled Jacobian of each cell in a 3D tetrahedral</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function scaled_jacobians with scaled
jacobian data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_skewnesses2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_skewnesses2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_skewnesses2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_skewnesses2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the skewness of each cell in a 2D triangular mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function skews with skewness
data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_skewnesses3d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_skewnesses3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_skewnesses3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_skewnesses3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the skewness of each cell in a 2D triangular mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function skews with skewness
data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.quality.get_volumes3d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.quality.</span></span><span class="sig-name descname"><span class="pre">get_volumes3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">python</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/quality.html#get_volumes3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.quality.get_volumes3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the volume of each cell in a 3D tetrahedral mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the input mesh to do computations on</p></li>
<li><p><strong>python</strong> – compute the measure using Python?</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>firedrake.function.Function volumes with
volume data</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.recovery">
<span id="pyroteus-recovery-module"></span><h2>pyroteus.recovery module<a class="headerlink" href="#module-pyroteus.recovery" title="Permalink to this headline">¶</a></h2>
<p>Driver functions for derivative recovery.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.recovery.recover_boundary_hessian">
<span class="sig-prename descclassname"><span class="pre">pyroteus.recovery.</span></span><span class="sig-name descname"><span class="pre">recover_boundary_hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Clement'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/recovery.html#recover_boundary_hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.recovery.recover_boundary_hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>Recover the Hessian of a scalar field
on the domain boundary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – dictionary of boundary tags and corresponding
fields, which we seek to recover, as well as an
‘interior’ entry for the domain interior</p></li>
<li><p><strong>mesh</strong> – the mesh</p></li>
<li><p><strong>method</strong> – choose from ‘L2’ and ‘Clement’</p></li>
<li><p><strong>target_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorFunctionSpace</span></code> in
which the metric will exist</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.recovery.recover_hessian">
<span class="sig-prename descclassname"><span class="pre">pyroteus.recovery.</span></span><span class="sig-name descname"><span class="pre">recover_hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/recovery.html#recover_hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.recovery.recover_hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>Recover the Hessian of a scalar field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – the scalar field whose Hessian we seek to recover</p></li>
<li><p><strong>method</strong> – recovery method</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyroteus.thetis_compat">
<span id="pyroteus-thetis-compat-module"></span><h2>pyroteus.thetis_compat module<a class="headerlink" href="#module-pyroteus.thetis_compat" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyroteus.thetis_compat.FlowSolver2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyroteus.thetis_compat.</span></span><span class="sig-name descname"><span class="pre">FlowSolver2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/thetis_compat.html#FlowSolver2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.thetis_compat.FlowSolver2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thetis.solver2d.FlowSolver2d</span></code></p>
<p>Augmented version of Thetis’ <code class="docutils literal notranslate"><span class="pre">FlowSolver2d</span></code>
class which accounts for restarting the
simulation on a new mesh and modifying
options prefixes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code> object of the 2D mesh</p></li>
<li><p><strong>bathymetry_2d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – Bathymetry of the domain. Bathymetry stands for
the mean water depth (positive downwards).</p></li>
<li><p><strong>options</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions2d</span></code> instance) – Model options (optional). Model options can also be
changed directly via the <code class="xref py py-attr docutils literal notranslate"><span class="pre">options</span></code> class property.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.thetis_compat.FlowSolver2d.correct_counters">
<span class="sig-name descname"><span class="pre">correct_counters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/thetis_compat.html#FlowSolver2d.correct_counters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.thetis_compat.FlowSolver2d.correct_counters" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust Thetis’ 2D solver internal counters
so that they agree with the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeshSeq</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.thetis_compat.FlowSolver2d.iterate">
<span class="sig-name descname"><span class="pre">iterate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/thetis_compat.html#FlowSolver2d.iterate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.thetis_compat.FlowSolver2d.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Overload Thetis’ 2D solve call so that it
additionally updates the options prefixes
associated with its solvers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.thetis_compat.FlowSolver2d.update_tags">
<span class="sig-name descname"><span class="pre">update_tags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/thetis_compat.html#FlowSolver2d.update_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.thetis_compat.FlowSolver2d.update_tags" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the options prefixes which Thetis
gives to the solvers associated with its
timesteppers so that they match the field
names used by Pyroteus.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.thetis_compat.timed_region">
<span class="sig-prename descclassname"><span class="pre">pyroteus.thetis_compat.</span></span><span class="sig-name descname"><span class="pre">timed_region</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyroteus.thetis_compat.timed_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Event(type cls, name, klass=None)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.thetis_compat.timed_stage">
<span class="sig-prename descclassname"><span class="pre">pyroteus.thetis_compat.</span></span><span class="sig-name descname"><span class="pre">timed_stage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyroteus.thetis_compat.timed_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Log.Stage(type cls, name)</p>
</dd></dl>

</section>
<section id="module-pyroteus.time_partition">
<span id="pyroteus-time-partition-module"></span><h2>pyroteus.time_partition module<a class="headerlink" href="#module-pyroteus.time_partition" title="Permalink to this headline">¶</a></h2>
<p>Partitioning for the temporal domain.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyroteus.time_partition.TimeInterval">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyroteus.time_partition.</span></span><span class="sig-name descname"><span class="pre">TimeInterval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/time_partition.html#TimeInterval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.time_partition.TimeInterval" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyroteus.time_partition.TimePartition" title="pyroteus.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyroteus.time_partition.TimePartition</span></code></a></p>
<p>A trivial <a class="reference internal" href="#pyroteus.time_partition.TimePartition" title="pyroteus.time_partition.TimePartition"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimePartition</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_time</strong> – end time of the interval
of interest</p></li>
<li><p><strong>num_subintervals</strong> – number of
subintervals in the partition</p></li>
<li><p><strong>timesteps</strong> – (list of values for the)
timestep used on each subinterval</p></li>
<li><p><strong>fields</strong> – (list of) field names ordered
by call sequence</p></li>
<li><p><strong>timesteps_per_export</strong> – (list of)
timesteps per export (default 1)</p></li>
<li><p><strong>start_time</strong> – start time of the
interval of interest (default 0.0)</p></li>
<li><p><strong>subinterals</strong> – user-provided sequence
of subintervals, which need not be of
uniform length (defaults to None)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pyroteus.time_partition.TimeInterval.timestep">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">timestep</span></span><a class="headerlink" href="#pyroteus.time_partition.TimeInterval.timestep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyroteus.time_partition.TimePartition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyroteus.time_partition.</span></span><span class="sig-name descname"><span class="pre">TimePartition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_subintervals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/time_partition.html#TimePartition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.time_partition.TimePartition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Object describing the partition of the time
interval of interest into subintervals.</p>
<p>For now, the subintervals are assumed to be
uniform in length. However, different values
may be used of the timestep on each.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end_time</strong> – end time of the interval
of interest</p></li>
<li><p><strong>num_subintervals</strong> – number of
subintervals in the partition</p></li>
<li><p><strong>timesteps</strong> – (list of values for the)
timestep used on each subinterval</p></li>
<li><p><strong>fields</strong> – (list of) field names ordered
by call sequence</p></li>
<li><p><strong>timesteps_per_export</strong> – (list of)
timesteps per export (default 1)</p></li>
<li><p><strong>start_time</strong> – start time of the
interval of interest (default 0.0)</p></li>
<li><p><strong>subinterals</strong> – user-provided sequence
of subintervals, which need not be of
uniform length (defaults to None)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyroteus.time_partition.TimePartition.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/time_partition.html#TimePartition.debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.time_partition.TimePartition.debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Print attribute ‘msg’ for debugging purposes.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyroteus.utility">
<span id="pyroteus-utility-module"></span><h2>pyroteus.utility module<a class="headerlink" href="#module-pyroteus.utility" title="Permalink to this headline">¶</a></h2>
<p>Utility functions and classes for mesh adaptation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyroteus.utility.AttrDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">AttrDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#AttrDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.AttrDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Dictionary that provides both <code class="docutils literal notranslate"><span class="pre">self['key']</span></code>
and <code class="docutils literal notranslate"><span class="pre">self.key</span></code> access to members.</p>
<p><strong>Disclaimer</strong>: Copied from <a class="reference external" href="http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python">stackoverflow</a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyroteus.utility.File">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">File</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#File"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.File" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://firedrakeproject.org/firedrake.html#firedrake.output.File" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.output.File</span></code></a></p>
<p>Overload Firedrake’s <code class="docutils literal notranslate"><span class="pre">File</span></code> class so that
it uses <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> mode by default. Whilst
this means that the mesh topology is
recomputed at every export, it removes any
need for the user to reset it manually.</p>
<p>Create an object for outputting data for visualisation.</p>
<p>This produces output in VTU format, suitable for visualisation
with Paraview or other VTK-capable visualisation packages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – The name of the output file (must end in
<code class="docutils literal notranslate"><span class="pre">.pvd</span></code>).</p></li>
<li><p><strong>project_output</strong> – Should the output be projected to
a computed output space?  Default is to use interpolation.</p></li>
<li><p><strong>comm</strong> – The MPI communicator to use.</p></li>
<li><p><strong>mode</strong> – “w” to overwrite any existing file, “a” to append to an existing file.</p></li>
<li><p><strong>target_degree</strong> – override the degree of the output space.</p></li>
<li><p><strong>target_continuity</strong> – override the continuity of the output space;
A UFL <code class="xref py py-class docutils literal notranslate"><span class="pre">SobolevSpace</span></code> object: <cite>H1</cite> for a
continuous output and <cite>L2</cite> for a discontinuous output.</p></li>
<li><p><strong>adaptive</strong> – allow different meshes at different exports if <cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Visualisation is only possible for Lagrange fields (either
continuous or discontinuous).  All other fields are first
either projected or interpolated to Lagrange elements
before storing for visualisation purposes.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.Mesh">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">Mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#Mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.Mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Overload Firedrake’s <code class="docutils literal notranslate"><span class="pre">Mesh</span></code> constructor to
endow the output mesh with useful quantities.</p>
<dl class="simple">
<dt>The following quantities are computed by default:</dt><dd><ul class="simple">
<li><p>cell size;</p></li>
<li><p>facet area.</p></li>
</ul>
</dd>
</dl>
<p>The argument and keyword arguments are passed to
Firedrake’s <code class="docutils literal notranslate"><span class="pre">Mesh</span></code> constructor, modified so
that the argument could also be a mesh.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.assemble_mass_matrix">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">assemble_mass_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#assemble_mass_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.assemble_mass_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Assemble the <code class="docutils literal notranslate"><span class="pre">norm_type</span></code> mass matrix
associated with some finite element <code class="docutils literal notranslate"><span class="pre">space</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.classify_element">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">classify_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#classify_element"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.classify_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Classify a <code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElement</span></code> in terms
of a label and a list of entity DOFs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElement</span></code></p></li>
<li><p><strong>dim</strong> – the topological dimension</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.create_directory">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">create_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#create_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.create_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory on disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to the directory</p></li>
<li><p><strong>comm</strong> – MPI communicator</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.create_section">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">create_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#create_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.create_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PETSc section associated with
a mesh and some <code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElement</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the mesh</p></li>
<li><p><strong>element</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteElement</span></code>
for which a section is sought, or a
list of entity DOFs to be passed
straight through</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.effectivity_index">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">effectivity_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_indicator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Je</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#effectivity_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.effectivity_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Overestimation factor of some error estimator
for the QoI error.</p>
<p>Note that this is only typically used for simple
steady-state problems with analytical solutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error_indicator</strong> – a <span class="math notranslate nohighlight">\(\mathbb P0\)</span>
<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> which localises
contributions to an error estimator to
individual elements</p></li>
<li><p><strong>Je</strong> – error in quantity of interest</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.errornorm">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">errornorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#errornorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.errornorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Overload Firedrake’s <code class="docutils literal notranslate"><span class="pre">errornorm</span></code> function
to allow for <span class="math notranslate nohighlight">\(\ell^p\)</span> norms.</p>
<p>Note that this version is case sensitive,
i.e. <code class="docutils literal notranslate"><span class="pre">'l2'</span></code> and <code class="docutils literal notranslate"><span class="pre">'L2'</span></code> will give
different results in general.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – the ‘true’ value</p></li>
<li><p><strong>uh</strong> – the approximation of the ‘truth’</p></li>
<li><p><strong>norm_type</strong> – choose from ‘l1’, ‘l2’, ‘linf’,
‘L2’, ‘Linf’, ‘H1’, ‘Hdiv’, ‘Hcurl’, or any
‘Lp’ with <span class="math notranslate nohighlight">\(p &gt;= 1\)</span>.</p></li>
<li><p><strong>boundary</strong> – should the norm be computed over
the domain boundary?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.norm">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Overload Firedrake’s <code class="docutils literal notranslate"><span class="pre">norm</span></code> function to
allow for <span class="math notranslate nohighlight">\(\ell^p\)</span> norms.</p>
<p>Note that this version is case sensitive,
i.e. <code class="docutils literal notranslate"><span class="pre">'l2'</span></code> and <code class="docutils literal notranslate"><span class="pre">'L2'</span></code> will give
different results in general.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to take the norm of</p></li>
<li><p><strong>norm_type</strong> – choose from ‘l1’, ‘l2’, ‘linf’,
‘L2’, ‘Linf’, ‘H1’, ‘Hdiv’, ‘Hcurl’, or any
‘Lp’ with <span class="math notranslate nohighlight">\(p &gt;= 1\)</span>.</p></li>
<li><p><strong>mesh</strong> – the mesh that <cite>v</cite> is defined upon</p></li>
<li><p><strong>condition</strong> – a UFL condition for specifying
a subdomain to compute the norm over</p></li>
<li><p><strong>boundary</strong> – should the norm be computed over
the domain boundary?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.rotate">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#rotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate a UFL <code class="xref py py-class docutils literal notranslate"><span class="pre">as_vector</span></code> <code class="docutils literal notranslate"><span class="pre">v</span></code>
by <code class="docutils literal notranslate"><span class="pre">angle</span></code> about an <code class="docutils literal notranslate"><span class="pre">origin</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyroteus.utility.rotation_matrix_2d">
<span class="sig-prename descclassname"><span class="pre">pyroteus.utility.</span></span><span class="sig-name descname"><span class="pre">rotation_matrix_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyroteus/utility.html#rotation_matrix_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyroteus.utility.rotation_matrix_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotation matrix associated with some
<code class="docutils literal notranslate"><span class="pre">angle</span></code>, as a UFL matrix.</p>
</dd></dl>

</section>
<section id="module-pyroteus">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyroteus" title="Permalink to this headline">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">pyroteus package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyroteus.adjoint">pyroteus.adjoint module</a></li>
<li><a class="reference internal" href="#module-pyroteus.error_estimation">pyroteus.error_estimation module</a></li>
<li><a class="reference internal" href="#module-pyroteus.form">pyroteus.form module</a></li>
<li><a class="reference internal" href="#module-pyroteus.go_mesh_seq">pyroteus.go_mesh_seq module</a></li>
<li><a class="reference internal" href="#module-pyroteus.interpolation">pyroteus.interpolation module</a></li>
<li><a class="reference internal" href="#module-pyroteus.log">pyroteus.log module</a></li>
<li><a class="reference internal" href="#module-pyroteus.math">pyroteus.math module</a></li>
<li><a class="reference internal" href="#module-pyroteus.mesh_seq">pyroteus.mesh_seq module</a></li>
<li><a class="reference internal" href="#module-pyroteus.metric">pyroteus.metric module</a></li>
<li><a class="reference internal" href="#module-pyroteus.plot">pyroteus.plot module</a></li>
<li><a class="reference internal" href="#module-pyroteus.quality">pyroteus.quality module</a></li>
<li><a class="reference internal" href="#module-pyroteus.recovery">pyroteus.recovery module</a></li>
<li><a class="reference internal" href="#module-pyroteus.thetis_compat">pyroteus.thetis_compat module</a></li>
<li><a class="reference internal" href="#module-pyroteus.time_partition">pyroteus.time_partition module</a></li>
<li><a class="reference internal" href="#module-pyroteus.utility">pyroteus.utility module</a></li>
<li><a class="reference internal" href="#module-pyroteus">Module contents</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pyroteus.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Pyroteus 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pyroteus package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021-2022, Joseph G. Wallwork et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>