
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1. Metric-based mesh adaptation &#8212; Pyroteus 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Pyroteus 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1. </span>Metric-based mesh adaptation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="metric-based-mesh-adaptation">
<h1><span class="section-number">1. </span>Metric-based mesh adaptation<a class="headerlink" href="#metric-based-mesh-adaptation" title="Permalink to this headline">¶</a></h1>
<section id="metric-spaces">
<h2><span class="section-number">1.1. </span>Metric spaces<a class="headerlink" href="#metric-spaces" title="Permalink to this headline">¶</a></h2>
<p>The metric-based mesh adaptation framework has its
roots in Riemannian geometry - in particular,
Riemannian metric spaces.</p>
<p>A <cite>metric space</cite>
<span class="math notranslate nohighlight">\((\mathcal V,\underline{\mathbf M})\)</span> consists
of a vector space <span class="math notranslate nohighlight">\(\mathcal V\)</span> and a <cite>metric</cite>
<span class="math notranslate nohighlight">\(\underline{\mathbf M}\)</span> defined upon it. Under
the assumption that <span class="math notranslate nohighlight">\(\mathcal V=\mathbb R^n\)</span>
for some <span class="math notranslate nohighlight">\(n\in\mathbb N\)</span>, <span class="math notranslate nohighlight">\(\mathcal M\)</span> can
be represented as an <span class="math notranslate nohighlight">\(n\times n\)</span> symmetric
positive-definite (SPD) matrix. From the metric, we
may deduce a distance function and various geometric
quantities related to the metric space.</p>
<p>Note that the definition above assumes that the metric
takes a fixed value. A <cite>Riemannian metric space</cite>,
on the other hand, is defined point-wise on a domain
<span class="math notranslate nohighlight">\(Omega\)</span>, such that its value is an <span class="math notranslate nohighlight">\(n\times n\)</span>
SPD matrix at each <span class="math notranslate nohighlight">\(\mathbf x\in\Omega\)</span>. We
use the notation
<span class="math notranslate nohighlight">\(\mathcal M=\{\underline{\mathbf M}(\mathbf x)\}_{\mathbf x\in\Omega}\)</span>
for the Riemannian metric. Throughout this documentation,
the term <cite>metric</cite> should be understood as referring
specifically to a Riemannian metric.</p>
</section>
<section id="geometric-interpretation">
<h2><span class="section-number">1.2. </span>Geometric interpretation<a class="headerlink" href="#geometric-interpretation" title="Permalink to this headline">¶</a></h2>
<p><cite>[To do: ellipses and ellipsoids]</cite></p>
<p><cite>[To do: decompositions - refer to density_and_quotients]</cite></p>
</section>
<section id="continuous-mesh-analogy">
<h2><span class="section-number">1.3. </span>Continuous mesh analogy<a class="headerlink" href="#continuous-mesh-analogy" title="Permalink to this headline">¶</a></h2>
<p><cite>[To do]</cite></p>
<p>Metric complexity may be computed in Pyroteus using
the function <code class="docutils literal notranslate"><span class="pre">metric_complexity</span></code>.</p>
</section>
<section id="mesh-adaptation">
<h2><span class="section-number">1.4. </span>Mesh adaptation<a class="headerlink" href="#mesh-adaptation" title="Permalink to this headline">¶</a></h2>
<p>The idea of metric-based mesh adaptation is to use
a Riemannian metric space <cite>within</cite> the mesher.</p>
<p><cite>[To do: unit mesh, quasi-unit mesh]</cite></p>
</section>
<section id="operations-on-metrics">
<h2><span class="section-number">1.5. </span>Operations on metrics<a class="headerlink" href="#operations-on-metrics" title="Permalink to this headline">¶</a></h2>
<p>In order to use metrics to drive mesh adaptation
algorithms for solving real problems, they must
first be made relevant. Metrics should be
normalised in order to account for domain geometry,
dimensional scales and other properties of the
problem, such as the extent to which it is
multi-scale.</p>
<p>In Pyroteus, normalisation is performed in the
<span class="math notranslate nohighlight">\(L^p\)</span> sense.</p>
<p><cite>[To do: space normalisation]</cite></p>
<p>In Pyroteus, normalisation in space is achieved
through the function <code class="docutils literal notranslate"><span class="pre">space_normalise</span></code>.</p>
<p><cite>[To do: space-time normalisation]</cite></p>
<p>In Pyroteus, space-time normalisation is achieved
through the function <code class="docutils literal notranslate"><span class="pre">space_time_normalise</span></code>.</p>
<p>In many cases, it is convenient to be able to combine
different metrics. For example, if we seek to adapt
the mesh such that the value of two different error
estimators are reduced. The simplest metric combination
method from an algebraic perspective is the metric
average:</p>
<div class="math notranslate nohighlight">
\[\tfrac12(\mathcal M_1 + \mathcal M_2),\]</div>
<p>for two metrics <span class="math notranslate nohighlight">\(\mathcal M_1\)</span> and
<span class="math notranslate nohighlight">\(\mathcal M_2\)</span>. Whilst mathematically simple,
the geometric interpretation of taking the metric
average is not immediately obvious. Metric intersection,
on the other hand, is geometrically straight-forward,
but non-trivial to write mathematically. The elliptic
interpretation of two metrics is the largest ellipse
which fits within the ellipses associtated with the
two input metrics. As such, metric intersection yields
a new metric whose complexity is greater than (or equal
to) its parents’. This is not true for the metric
average in general.</p>
<p><cite>[To do: citation for formula]</cite></p>
<p>Metric combination may be achieved in Pyroteus using the
functions <cite>metric_average</cite>, <cite>metric_intersection</cite>,
<cite>metric_relaxation</cite> (generalised average) and simply
<cite>combine_metrics</cite>.</p>
</section>
<section id="metric-drivers">
<h2><span class="section-number">1.6. </span>Metric drivers<a class="headerlink" href="#metric-drivers" title="Permalink to this headline">¶</a></h2>
<p>Pyroteus provides a number of different driver functions
for metric generation. These include <code class="docutils literal notranslate"><span class="pre">isotropic_metric</span></code>,
which takes an error indicator field and constructs a
metric which specifies how a mesh should be adapted purely
in terms of element size (not orientation or shape).</p>
<p><cite>[To do: isotropic metric, Hessian metric]</cite></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Metric-based mesh adaptation</a><ul>
<li><a class="reference internal" href="#metric-spaces">1.1. Metric spaces</a></li>
<li><a class="reference internal" href="#geometric-interpretation">1.2. Geometric interpretation</a></li>
<li><a class="reference internal" href="#continuous-mesh-analogy">1.3. Continuous mesh analogy</a></li>
<li><a class="reference internal" href="#mesh-adaptation">1.4. Mesh adaptation</a></li>
<li><a class="reference internal" href="#operations-on-metrics">1.5. Operations on metrics</a></li>
<li><a class="reference internal" href="#metric-drivers">1.6. Metric drivers</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/maths/1-metric-based.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Pyroteus 0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1. </span>Metric-based mesh adaptation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Joseph G. Wallwork et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>